15:25:43 An error has been caught in function 'make_site_object', process 'Process-1' (16542), thread 'Thread-30' (140628704884480):
Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 699, in urlopen
    httplib_response = self._make_request(
                       │    └ <function HTTPConnectionPool._make_request at 0x7fe714ef9820>
                       └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fe70674e1f0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 382, in _make_request
    self._validate_conn(conn)
    │    │              └ <urllib3.connection.HTTPSConnection object at 0x7fe7140add60>
    │    └ <function HTTPSConnectionPool._validate_conn at 0x7fe714ef9d30>
    └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fe70674e1f0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1010, in _validate_conn
    conn.connect()
    │    └ <function HTTPSConnection.connect at 0x7fe714ee8430>
    └ <urllib3.connection.HTTPSConnection object at 0x7fe7140add60>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connection.py", line 411, in connect
    self.sock = ssl_wrap_socket(
    │    │      └ <function ssl_wrap_socket at 0x7fe714edd160>
    │    └ None
    └ <urllib3.connection.HTTPSConnection object at 0x7fe7140add60>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 428, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               └ <function _ssl_wrap_socket_impl at 0x7fe714edd310>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 472, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           │           │           │                     └ 'www.nlv.ru'
           │           │           └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
           │           └ <function SSLContext.wrap_socket at 0x7fe7157d7700>
           └ <ssl.SSLContext object at 0x7fe70683e6c0>
  File "/usr/lib/python3.8/ssl.py", line 500, in wrap_socket
    return self.sslsocket_class._create(
           │    │               └ <classmethod object at 0x7fe7157d5eb0>
           │    └ <class 'ssl.SSLSocket'>
           └ <ssl.SSLContext object at 0x7fe70683e6c0>
  File "/usr/lib/python3.8/ssl.py", line 1040, in _create
    self.do_handshake()
    │    └ <function SSLSocket.do_handshake at 0x7fe7157db5e0>
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
  File "/usr/lib/python3.8/ssl.py", line 1309, in do_handshake
    self._sslobj.do_handshake()
    │    └ None
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>

ssl.SSLError: [SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 439, in send
    resp = conn.urlopen(
           │    └ <function HTTPConnectionPool.urlopen at 0x7fe714ef9a60>
           └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fe70674e1f0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 755, in urlopen
    retries = retries.increment(
              │       └ <function Retry.increment at 0x7fe714e305e0>
              └ Retry(total=0, connect=None, read=False, redirect=None, status=None)
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/retry.py", line 574, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
          │             │      │    │        │             └ 'unknown'
          │             │      │    │        └ <class 'urllib3.exceptions.ResponseError'>
          │             │      │    └ SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)'))
          │             │      └ '/laser-correction/lasik-operatsiya'
          │             └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fe70674e1f0>
          └ <class 'urllib3.exceptions.MaxRetryError'>

urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fe706783fd0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fe706783fd0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-30, started 140628704884480)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fe706783fd0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fe715e6baf0>
    └ <Thread(Thread-30, started 140628704884480)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fe715e6b820>
    └ <Thread(Thread-30, started 140628704884480)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-30, started 140628704884480)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекц...
    │    │        └ <Thread(Thread-30, started 140628704884480)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fe7145ad460>>
    └ <Thread(Thread-30, started 140628704884480)>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 348, in make_site_object
    self.site_objects_list.append(Site(site_dataset))
    │    │                 │      │    └ SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекци...
    │    │                 │      └ <function Site at 0x7fe7140cfa60>
    │    │                 └ <method 'append' of 'list' objects>
    │    └ [<__main__.Site object at 0x7fe706783850>]
    └ <__main__.Yandex object at 0x7fe7145ad460>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 171, in __init__
    self.get_html()
    │    └ <function Site.get_html at 0x7fe7140cfdc0>
    └ <__main__.Site object at 0x7fe70679c520>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 235, in get_html
    r = requests.get(self.url, headers=HEADERS, verify=False, timeout=15).content
        │        │   │    │            └ {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/...
        │        │   │    └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
        │        │   └ <__main__.Site object at 0x7fe70679c520>
        │        └ <function get at 0x7fe714470040>
        └ <module 'requests' from '/home/wenfort/env/lib/python3.8/site-packages/requests/__init__.py'>

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 76, in get
    return request('get', url, params=params, **kwargs)
           │              │           │         └ {'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147...
           │              │           └ None
           │              └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           └ <function request at 0x7fe71445de50>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
           │       │              │           │      └ {'params': None, 'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) ...
           │       │              │           └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           │       │              └ 'get'
           │       └ <function Session.request at 0x7fe714472790>
           └ <requests.sessions.Session object at 0x7fe706746e80>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
           │    │    │       └ {'timeout': 15, 'allow_redirects': True, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
           │    │    └ <PreparedRequest [GET]>
           │    └ <function Session.send at 0x7fe714472c10>
           └ <requests.sessions.Session object at 0x7fe706746e80>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
        │       │    │          └ {'timeout': 15, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
        │       │    └ <PreparedRequest [GET]>
        │       └ <function HTTPAdapter.send at 0x7fe7144720d0>
        └ <requests.adapters.HTTPAdapter object at 0x7fe706746eb0>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 514, in send
    raise SSLError(e, request=request)
          │                   └ <PreparedRequest [GET]>
          └ <class 'requests.exceptions.SSLError'>

requests.exceptions.SSLError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))
15:27:33 An error has been caught in function 'make_site_object', process 'Process-1' (16650), thread 'Thread-30' (140076466042624):
Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 699, in urlopen
    httplib_response = self._make_request(
                       │    └ <function HTTPConnectionPool._make_request at 0x7f6680989820>
                       └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f667274dcd0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 382, in _make_request
    self._validate_conn(conn)
    │    │              └ <urllib3.connection.HTTPSConnection object at 0x7f667274daf0>
    │    └ <function HTTPSConnectionPool._validate_conn at 0x7f6680989d30>
    └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f667274dcd0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1010, in _validate_conn
    conn.connect()
    │    └ <function HTTPSConnection.connect at 0x7f6680978430>
    └ <urllib3.connection.HTTPSConnection object at 0x7f667274daf0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connection.py", line 411, in connect
    self.sock = ssl_wrap_socket(
    │    │      └ <function ssl_wrap_socket at 0x7f668096f160>
    │    └ None
    └ <urllib3.connection.HTTPSConnection object at 0x7f667274daf0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 428, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               └ <function _ssl_wrap_socket_impl at 0x7f668096f310>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 472, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           │           │           │                     └ 'www.nlv.ru'
           │           │           └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
           │           └ <function SSLContext.wrap_socket at 0x7f66812a9700>
           └ <ssl.SSLContext object at 0x7f667235c9c0>
  File "/usr/lib/python3.8/ssl.py", line 500, in wrap_socket
    return self.sslsocket_class._create(
           │    │               └ <classmethod object at 0x7f66812a7eb0>
           │    └ <class 'ssl.SSLSocket'>
           └ <ssl.SSLContext object at 0x7f667235c9c0>
  File "/usr/lib/python3.8/ssl.py", line 1040, in _create
    self.do_handshake()
    │    └ <function SSLSocket.do_handshake at 0x7f66812ad5e0>
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
  File "/usr/lib/python3.8/ssl.py", line 1309, in do_handshake
    self._sslobj.do_handshake()
    │    └ None
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>

ssl.SSLError: [SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 439, in send
    resp = conn.urlopen(
           │    └ <function HTTPConnectionPool.urlopen at 0x7f6680989a60>
           └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f667274dcd0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 755, in urlopen
    retries = retries.increment(
              │       └ <function Retry.increment at 0x7f6680a3f5e0>
              └ Retry(total=0, connect=None, read=False, redirect=None, status=None)
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/retry.py", line 574, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
          │             │      │    │        │             └ 'unknown'
          │             │      │    │        └ <class 'urllib3.exceptions.ResponseError'>
          │             │      │    └ SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)'))
          │             │      └ '/laser-correction/lasik-operatsiya'
          │             └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f667274dcd0>
          └ <class 'urllib3.exceptions.MaxRetryError'>

urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f66722a3a60>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f66722a3a60>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-30, started 140076466042624)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f66722a3a60>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f668193daf0>
    └ <Thread(Thread-30, started 140076466042624)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f668193d820>
    └ <Thread(Thread-30, started 140076466042624)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-30, started 140076466042624)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекц...
    │    │        └ <Thread(Thread-30, started 140076466042624)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f668007e4c0>>
    └ <Thread(Thread-30, started 140076466042624)>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 348, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекци...
    └ <function Site at 0x7f667802aa60>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 171, in __init__
    self.get_html()
    │    └ <function Site.get_html at 0x7f667802adc0>
    └ <__main__.Site object at 0x7f6672258d30>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 235, in get_html
    r = requests.get(self.url, headers=HEADERS, verify=False, timeout=15).content
        │        │   │    │            └ {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/...
        │        │   │    └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
        │        │   └ <__main__.Site object at 0x7f6672258d30>
        │        └ <function get at 0x7f667af2e040>
        └ <module 'requests' from '/home/wenfort/env/lib/python3.8/site-packages/requests/__init__.py'>

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 76, in get
    return request('get', url, params=params, **kwargs)
           │              │           │         └ {'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147...
           │              │           └ None
           │              └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           └ <function request at 0x7f667af16e50>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
           │       │              │           │      └ {'params': None, 'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) ...
           │       │              │           └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           │       │              └ 'get'
           │       └ <function Session.request at 0x7f667af2f790>
           └ <requests.sessions.Session object at 0x7f6672258cd0>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
           │    │    │       └ {'timeout': 15, 'allow_redirects': True, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
           │    │    └ <PreparedRequest [GET]>
           │    └ <function Session.send at 0x7f667af2fc10>
           └ <requests.sessions.Session object at 0x7f6672258cd0>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
        │       │    │          └ {'timeout': 15, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
        │       │    └ <PreparedRequest [GET]>
        │       └ <function HTTPAdapter.send at 0x7f667af2f0d0>
        └ <requests.adapters.HTTPAdapter object at 0x7f6672258eb0>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 514, in send
    raise SSLError(e, request=request)
          │                   └ <PreparedRequest [GET]>
          └ <class 'requests.exceptions.SSLError'>

requests.exceptions.SSLError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))
11:43:05 An error has been caught in function 'make_site_object', process 'Process-1' (4104), thread 'Thread-30' (140533343188736):
Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 699, in urlopen
    httplib_response = self._make_request(
                       │    └ <function HTTPConnectionPool._make_request at 0x7fd0e0e485e0>
                       └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fd0d26326a0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 382, in _make_request
    self._validate_conn(conn)
    │    │              └ <urllib3.connection.HTTPSConnection object at 0x7fd0d26b89d0>
    │    └ <function HTTPSConnectionPool._validate_conn at 0x7fd0e0e48af0>
    └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fd0d26326a0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1010, in _validate_conn
    conn.connect()
    │    └ <function HTTPSConnection.connect at 0x7fd0e0e371f0>
    └ <urllib3.connection.HTTPSConnection object at 0x7fd0d26b89d0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connection.py", line 411, in connect
    self.sock = ssl_wrap_socket(
    │    │      └ <function ssl_wrap_socket at 0x7fd0e0e23ee0>
    │    └ None
    └ <urllib3.connection.HTTPSConnection object at 0x7fd0d26b89d0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 428, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               └ <function _ssl_wrap_socket_impl at 0x7fd0e0e2d0d0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 472, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           │           │           │                     └ 'www.nlv.ru'
           │           │           └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
           │           └ <function SSLContext.wrap_socket at 0x7fd0e1665700>
           └ <ssl.SSLContext object at 0x7fd0d260d6c0>
  File "/usr/lib/python3.8/ssl.py", line 500, in wrap_socket
    return self.sslsocket_class._create(
           │    │               └ <classmethod object at 0x7fd0e1663eb0>
           │    └ <class 'ssl.SSLSocket'>
           └ <ssl.SSLContext object at 0x7fd0d260d6c0>
  File "/usr/lib/python3.8/ssl.py", line 1040, in _create
    self.do_handshake()
    │    └ <function SSLSocket.do_handshake at 0x7fd0e16695e0>
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
  File "/usr/lib/python3.8/ssl.py", line 1309, in do_handshake
    self._sslobj.do_handshake()
    │    └ None
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>

ssl.SSLError: [SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 439, in send
    resp = conn.urlopen(
           │    └ <function HTTPConnectionPool.urlopen at 0x7fd0e0e48820>
           └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fd0d26326a0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 755, in urlopen
    retries = retries.increment(
              │       └ <function Retry.increment at 0x7fd0e0dfd3a0>
              └ Retry(total=0, connect=None, read=False, redirect=None, status=None)
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/retry.py", line 574, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
          │             │      │    │        │             └ 'unknown'
          │             │      │    │        └ <class 'urllib3.exceptions.ResponseError'>
          │             │      │    └ SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)'))
          │             │      └ '/laser-correction/lasik-operatsiya'
          │             └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fd0d26326a0>
          └ <class 'urllib3.exceptions.MaxRetryError'>

urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd0d263b4c0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd0d263b4c0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-30, started 140533343188736)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd0d263b4c0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd0e1cf9af0>
    └ <Thread(Thread-30, started 140533343188736)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fd0e1cf9820>
    └ <Thread(Thread-30, started 140533343188736)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-30, started 140533343188736)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекц...
    │    │        └ <Thread(Thread-30, started 140533343188736)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fd0e0cf66a0>>
    └ <Thread(Thread-30, started 140533343188736)>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 344, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекци...
    └ <function Site at 0x7fd0d3f57820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 172, in __init__
    self.get_html()
    │    └ <function Site.get_html at 0x7fd0d3f57b80>
    └ <__main__.Site object at 0x7fd0d2657940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 236, in get_html
    r = requests.get(self.url, headers=HEADERS, verify=False, timeout=15).content
        │        │   │    │            └ {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/...
        │        │   │    └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
        │        │   └ <__main__.Site object at 0x7fd0d2657940>
        │        └ <function get at 0x7fd0e02fcdc0>
        └ <module 'requests' from '/home/wenfort/env/lib/python3.8/site-packages/requests/__init__.py'>

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 76, in get
    return request('get', url, params=params, **kwargs)
           │              │           │         └ {'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147...
           │              │           └ None
           │              └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           └ <function request at 0x7fd0e02e8c10>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
           │       │              │           │      └ {'params': None, 'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) ...
           │       │              │           └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           │       │              └ 'get'
           │       └ <function Session.request at 0x7fd0e02fc550>
           └ <requests.sessions.Session object at 0x7fd0d2632370>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
           │    │    │       └ {'timeout': 15, 'allow_redirects': True, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
           │    │    └ <PreparedRequest [GET]>
           │    └ <function Session.send at 0x7fd0e02fc9d0>
           └ <requests.sessions.Session object at 0x7fd0d2632370>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
        │       │    │          └ {'timeout': 15, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
        │       │    └ <PreparedRequest [GET]>
        │       └ <function HTTPAdapter.send at 0x7fd0e02f4e50>
        └ <requests.adapters.HTTPAdapter object at 0x7fd0d26323a0>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 514, in send
    raise SSLError(e, request=request)
          │                   └ <PreparedRequest [GET]>
          └ <class 'requests.exceptions.SSLError'>

requests.exceptions.SSLError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))
11:43:14 An error has been caught in function 'make_site_object', process 'Process-1' (4164), thread 'Thread-30' (140620005877504):
Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 699, in urlopen
    httplib_response = self._make_request(
                       │    └ <function HTTPConnectionPool._make_request at 0x7fe4f97aa5e0>
                       └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fe4e70fe5e0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 382, in _make_request
    self._validate_conn(conn)
    │    │              └ <urllib3.connection.HTTPSConnection object at 0x7fe4e75eba90>
    │    └ <function HTTPSConnectionPool._validate_conn at 0x7fe4f97aaaf0>
    └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fe4e70fe5e0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1010, in _validate_conn
    conn.connect()
    │    └ <function HTTPSConnection.connect at 0x7fe4f97d31f0>
    └ <urllib3.connection.HTTPSConnection object at 0x7fe4e75eba90>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connection.py", line 411, in connect
    self.sock = ssl_wrap_socket(
    │    │      └ <function ssl_wrap_socket at 0x7fe4f97b6ee0>
    │    └ None
    └ <urllib3.connection.HTTPSConnection object at 0x7fe4e75eba90>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 428, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               └ <function _ssl_wrap_socket_impl at 0x7fe4f97cb0d0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 472, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           │           │           │                     └ 'www.nlv.ru'
           │           │           └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
           │           └ <function SSLContext.wrap_socket at 0x7fe4fa144700>
           └ <ssl.SSLContext object at 0x7fe4e709dc40>
  File "/usr/lib/python3.8/ssl.py", line 500, in wrap_socket
    return self.sslsocket_class._create(
           │    │               └ <classmethod object at 0x7fe4fa142eb0>
           │    └ <class 'ssl.SSLSocket'>
           └ <ssl.SSLContext object at 0x7fe4e709dc40>
  File "/usr/lib/python3.8/ssl.py", line 1040, in _create
    self.do_handshake()
    │    └ <function SSLSocket.do_handshake at 0x7fe4fa1485e0>
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
  File "/usr/lib/python3.8/ssl.py", line 1309, in do_handshake
    self._sslobj.do_handshake()
    │    └ None
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>

ssl.SSLError: [SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 439, in send
    resp = conn.urlopen(
           │    └ <function HTTPConnectionPool.urlopen at 0x7fe4f97aa820>
           └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fe4e70fe5e0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 755, in urlopen
    retries = retries.increment(
              │       └ <function Retry.increment at 0x7fe4f97973a0>
              └ Retry(total=0, connect=None, read=False, redirect=None, status=None)
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/retry.py", line 574, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
          │             │      │    │        │             └ 'unknown'
          │             │      │    │        └ <class 'urllib3.exceptions.ResponseError'>
          │             │      │    └ SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)'))
          │             │      └ '/laser-correction/lasik-operatsiya'
          │             └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fe4e70fe5e0>
          └ <class 'urllib3.exceptions.MaxRetryError'>

urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fe4e70e2700>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fe4e70e2700>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-30, started 140620005877504)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fe4e70e2700>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fe4fa7d8af0>
    └ <Thread(Thread-30, started 140620005877504)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fe4fa7d8820>
    └ <Thread(Thread-30, started 140620005877504)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-30, started 140620005877504)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекц...
    │    │        └ <Thread(Thread-30, started 140620005877504)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fe4f98176a0>>
    └ <Thread(Thread-30, started 140620005877504)>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 344, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекци...
    └ <function Site at 0x7fe4f0a37820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 172, in __init__
    self.get_html()
    │    └ <function Site.get_html at 0x7fe4f0a37b80>
    └ <__main__.Site object at 0x7fe4e70fe520>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 236, in get_html
    r = requests.get(self.url, headers=HEADERS, verify=False, timeout=15).content
        │        │   │    │            └ {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/...
        │        │   │    └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
        │        │   └ <__main__.Site object at 0x7fe4e70fe520>
        │        └ <function get at 0x7fe4f85dadc0>
        └ <module 'requests' from '/home/wenfort/env/lib/python3.8/site-packages/requests/__init__.py'>

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 76, in get
    return request('get', url, params=params, **kwargs)
           │              │           │         └ {'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147...
           │              │           └ None
           │              └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           └ <function request at 0x7fe4f85c7c10>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
           │       │              │           │      └ {'params': None, 'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) ...
           │       │              │           └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           │       │              └ 'get'
           │       └ <function Session.request at 0x7fe4f85da550>
           └ <requests.sessions.Session object at 0x7fe4e70fe4c0>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
           │    │    │       └ {'timeout': 15, 'allow_redirects': True, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
           │    │    └ <PreparedRequest [GET]>
           │    └ <function Session.send at 0x7fe4f85da9d0>
           └ <requests.sessions.Session object at 0x7fe4e70fe4c0>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
        │       │    │          └ {'timeout': 15, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
        │       │    └ <PreparedRequest [GET]>
        │       └ <function HTTPAdapter.send at 0x7fe4f85d1e50>
        └ <requests.adapters.HTTPAdapter object at 0x7fe4e70fe4f0>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 514, in send
    raise SSLError(e, request=request)
          │                   └ <PreparedRequest [GET]>
          └ <class 'requests.exceptions.SSLError'>

requests.exceptions.SSLError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))
11:44:39 An error has been caught in function 'make_site_object', process 'Process-1' (4303), thread 'Thread-30' (139803559438080):
Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 699, in urlopen
    httplib_response = self._make_request(
                       │    └ <function HTTPConnectionPool._make_request at 0x7f26e0461550>
                       └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f26cb5a15e0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 382, in _make_request
    self._validate_conn(conn)
    │    │              └ <urllib3.connection.HTTPSConnection object at 0x7f26cb5a1970>
    │    └ <function HTTPSConnectionPool._validate_conn at 0x7f26e0461a60>
    └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f26cb5a15e0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1010, in _validate_conn
    conn.connect()
    │    └ <function HTTPSConnection.connect at 0x7f26e04d0160>
    └ <urllib3.connection.HTTPSConnection object at 0x7f26cb5a1970>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connection.py", line 411, in connect
    self.sock = ssl_wrap_socket(
    │    │      └ <function ssl_wrap_socket at 0x7f26e04c9e50>
    │    └ None
    └ <urllib3.connection.HTTPSConnection object at 0x7f26cb5a1970>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 428, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               └ <function _ssl_wrap_socket_impl at 0x7f26e04c8040>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 472, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           │           │           │                     └ 'www.nlv.ru'
           │           │           └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
           │           └ <function SSLContext.wrap_socket at 0x7f26e2632700>
           └ <ssl.SSLContext object at 0x7f26cb5b0740>
  File "/usr/lib/python3.8/ssl.py", line 500, in wrap_socket
    return self.sslsocket_class._create(
           │    │               └ <classmethod object at 0x7f26e2630eb0>
           │    └ <class 'ssl.SSLSocket'>
           └ <ssl.SSLContext object at 0x7f26cb5b0740>
  File "/usr/lib/python3.8/ssl.py", line 1040, in _create
    self.do_handshake()
    │    └ <function SSLSocket.do_handshake at 0x7f26e26365e0>
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
  File "/usr/lib/python3.8/ssl.py", line 1309, in do_handshake
    self._sslobj.do_handshake()
    │    └ None
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>

ssl.SSLError: [SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 439, in send
    resp = conn.urlopen(
           │    └ <function HTTPConnectionPool.urlopen at 0x7f26e0461790>
           └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f26cb5a15e0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 755, in urlopen
    retries = retries.increment(
              │       └ <function Retry.increment at 0x7f26e0518310>
              └ Retry(total=0, connect=None, read=False, redirect=None, status=None)
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/retry.py", line 574, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
          │             │      │    │        │             └ 'unknown'
          │             │      │    │        └ <class 'urllib3.exceptions.ResponseError'>
          │             │      │    └ SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)'))
          │             │      └ '/laser-correction/lasik-operatsiya'
          │             └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f26cb5a15e0>
          └ <class 'urllib3.exceptions.MaxRetryError'>

urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f26cb5e0cd0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f26cb5e0cd0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-30, started 139803559438080)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f26cb5e0cd0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f26e2cc6af0>
    └ <Thread(Thread-30, started 139803559438080)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f26e2cc6820>
    └ <Thread(Thread-30, started 139803559438080)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-30, started 139803559438080)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекц...
    │    │        └ <Thread(Thread-30, started 139803559438080)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f26e1e4e1f0>>
    └ <Thread(Thread-30, started 139803559438080)>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 344, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекци...
    └ <function Site at 0x7f26d0f7a790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 172, in __init__
    self.get_html()
    │    └ <function Site.get_html at 0x7f26d0f7aaf0>
    └ <__main__.Site object at 0x7f26cb5e6f40>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 236, in get_html
    r = requests.get(self.url, headers=HEADERS, verify=False, timeout=15).content
        │        │   │    │            └ {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/...
        │        │   │    └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
        │        │   └ <__main__.Site object at 0x7f26cb5e6f40>
        │        └ <function get at 0x7f26e02d8d30>
        └ <module 'requests' from '/home/wenfort/env/lib/python3.8/site-packages/requests/__init__.py'>

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 76, in get
    return request('get', url, params=params, **kwargs)
           │              │           │         └ {'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147...
           │              │           └ None
           │              └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           └ <function request at 0x7f26e02c4b80>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
           │       │              │           │      └ {'params': None, 'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) ...
           │       │              │           └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           │       │              └ 'get'
           │       └ <function Session.request at 0x7f26e02d84c0>
           └ <requests.sessions.Session object at 0x7f26cb5f3340>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
           │    │    │       └ {'timeout': 15, 'allow_redirects': True, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
           │    │    └ <PreparedRequest [GET]>
           │    └ <function Session.send at 0x7f26e02d8940>
           └ <requests.sessions.Session object at 0x7f26cb5f3340>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
        │       │    │          └ {'timeout': 15, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
        │       │    └ <PreparedRequest [GET]>
        │       └ <function HTTPAdapter.send at 0x7f26e02cfdc0>
        └ <requests.adapters.HTTPAdapter object at 0x7f26cb5f3490>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 514, in send
    raise SSLError(e, request=request)
          │                   └ <PreparedRequest [GET]>
          └ <class 'requests.exceptions.SSLError'>

requests.exceptions.SSLError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))
11:48:57 An error has been caught in function 'make_site_object', process 'Process-1' (4468), thread 'Thread-30' (140375721219840):
Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 699, in urlopen
    httplib_response = self._make_request(
                       │    └ <function HTTPConnectionPool._make_request at 0x7fac157505e0>
                       └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fac02efb6a0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 382, in _make_request
    self._validate_conn(conn)
    │    │              └ <urllib3.connection.HTTPSConnection object at 0x7fac033e2580>
    │    └ <function HTTPSConnectionPool._validate_conn at 0x7fac15750af0>
    └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fac02efb6a0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1010, in _validate_conn
    conn.connect()
    │    └ <function HTTPSConnection.connect at 0x7fac1577a1f0>
    └ <urllib3.connection.HTTPSConnection object at 0x7fac033e2580>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connection.py", line 411, in connect
    self.sock = ssl_wrap_socket(
    │    │      └ <function ssl_wrap_socket at 0x7fac15768ee0>
    │    └ None
    └ <urllib3.connection.HTTPSConnection object at 0x7fac033e2580>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 428, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               └ <function _ssl_wrap_socket_impl at 0x7fac157700d0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 472, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           │           │           │                     └ 'www.nlv.ru'
           │           │           └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
           │           └ <function SSLContext.wrap_socket at 0x7fac15fab700>
           └ <ssl.SSLContext object at 0x7fac0302b640>
  File "/usr/lib/python3.8/ssl.py", line 500, in wrap_socket
    return self.sslsocket_class._create(
           │    │               └ <classmethod object at 0x7fac15fa9eb0>
           │    └ <class 'ssl.SSLSocket'>
           └ <ssl.SSLContext object at 0x7fac0302b640>
  File "/usr/lib/python3.8/ssl.py", line 1040, in _create
    self.do_handshake()
    │    └ <function SSLSocket.do_handshake at 0x7fac15faf5e0>
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
  File "/usr/lib/python3.8/ssl.py", line 1309, in do_handshake
    self._sslobj.do_handshake()
    │    └ None
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>

ssl.SSLError: [SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 439, in send
    resp = conn.urlopen(
           │    └ <function HTTPConnectionPool.urlopen at 0x7fac15750820>
           └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fac02efb6a0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 755, in urlopen
    retries = retries.increment(
              │       └ <function Retry.increment at 0x7fac157413a0>
              └ Retry(total=0, connect=None, read=False, redirect=None, status=None)
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/retry.py", line 574, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
          │             │      │    │        │             └ 'unknown'
          │             │      │    │        └ <class 'urllib3.exceptions.ResponseError'>
          │             │      │    └ SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)'))
          │             │      └ '/laser-correction/lasik-operatsiya'
          │             └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fac02efb6a0>
          └ <class 'urllib3.exceptions.MaxRetryError'>

urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fac02f454c0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fac02f454c0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-30, started 140375721219840)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fac02f454c0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fac1663faf0>
    └ <Thread(Thread-30, started 140375721219840)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fac1663f820>
    └ <Thread(Thread-30, started 140375721219840)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-30, started 140375721219840)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекц...
    │    │        └ <Thread(Thread-30, started 140375721219840)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fac1563d640>>
    └ <Thread(Thread-30, started 140375721219840)>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 344, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекци...
    └ <function Site at 0x7fac140a4820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 172, in __init__
    self.get_html()
    │    └ <function Site.get_html at 0x7fac140a4b80>
    └ <__main__.Site object at 0x7fac02fa4b80>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 236, in get_html
    r = requests.get(self.url, headers=HEADERS, verify=False, timeout=15).content
        │        │   │    │            └ {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/...
        │        │   │    └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
        │        │   └ <__main__.Site object at 0x7fac02fa4b80>
        │        └ <function get at 0x7fac14440dc0>
        └ <module 'requests' from '/home/wenfort/env/lib/python3.8/site-packages/requests/__init__.py'>

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 76, in get
    return request('get', url, params=params, **kwargs)
           │              │           │         └ {'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147...
           │              │           └ None
           │              └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           └ <function request at 0x7fac1442ec10>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
           │       │              │           │      └ {'params': None, 'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) ...
           │       │              │           └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           │       │              └ 'get'
           │       └ <function Session.request at 0x7fac14440550>
           └ <requests.sessions.Session object at 0x7fac02f45fd0>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
           │    │    │       └ {'timeout': 15, 'allow_redirects': True, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
           │    │    └ <PreparedRequest [GET]>
           │    └ <function Session.send at 0x7fac144409d0>
           └ <requests.sessions.Session object at 0x7fac02f45fd0>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
        │       │    │          └ {'timeout': 15, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
        │       │    └ <PreparedRequest [GET]>
        │       └ <function HTTPAdapter.send at 0x7fac14438e50>
        └ <requests.adapters.HTTPAdapter object at 0x7fac02efb3a0>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 514, in send
    raise SSLError(e, request=request)
          │                   └ <PreparedRequest [GET]>
          └ <class 'requests.exceptions.SSLError'>

requests.exceptions.SSLError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))
11:49:32 An error has been caught in function 'make_site_object', process 'Process-1' (4551), thread 'Thread-30' (139765777147648):
Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 699, in urlopen
    httplib_response = self._make_request(
                       │    └ <function HTTPConnectionPool._make_request at 0x7f1e159ad5e0>
                       └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f1dff305a90>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 382, in _make_request
    self._validate_conn(conn)
    │    │              └ <urllib3.connection.HTTPSConnection object at 0x7f1dff4027c0>
    │    └ <function HTTPSConnectionPool._validate_conn at 0x7f1e159adaf0>
    └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f1dff305a90>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1010, in _validate_conn
    conn.connect()
    │    └ <function HTTPSConnection.connect at 0x7f1e15a1b1f0>
    └ <urllib3.connection.HTTPSConnection object at 0x7f1dff4027c0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connection.py", line 411, in connect
    self.sock = ssl_wrap_socket(
    │    │      └ <function ssl_wrap_socket at 0x7f1e15a11ee0>
    │    └ None
    └ <urllib3.connection.HTTPSConnection object at 0x7f1dff4027c0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 428, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               └ <function _ssl_wrap_socket_impl at 0x7f1e15a0f0d0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 472, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           │           │           │                     └ 'www.nlv.ru'
           │           │           └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
           │           └ <function SSLContext.wrap_socket at 0x7f1e16348700>
           └ <ssl.SSLContext object at 0x7f1dff2aaa40>
  File "/usr/lib/python3.8/ssl.py", line 500, in wrap_socket
    return self.sslsocket_class._create(
           │    │               └ <classmethod object at 0x7f1e16347eb0>
           │    └ <class 'ssl.SSLSocket'>
           └ <ssl.SSLContext object at 0x7f1dff2aaa40>
  File "/usr/lib/python3.8/ssl.py", line 1040, in _create
    self.do_handshake()
    │    └ <function SSLSocket.do_handshake at 0x7f1e1634d5e0>
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
  File "/usr/lib/python3.8/ssl.py", line 1309, in do_handshake
    self._sslobj.do_handshake()
    │    └ None
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>

ssl.SSLError: [SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 439, in send
    resp = conn.urlopen(
           │    └ <function HTTPConnectionPool.urlopen at 0x7f1e159ad820>
           └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f1dff305a90>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 755, in urlopen
    retries = retries.increment(
              │       └ <function Retry.increment at 0x7f1e1599b3a0>
              └ Retry(total=0, connect=None, read=False, redirect=None, status=None)
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/retry.py", line 574, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
          │             │      │    │        │             └ 'unknown'
          │             │      │    │        └ <class 'urllib3.exceptions.ResponseError'>
          │             │      │    └ SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)'))
          │             │      └ '/laser-correction/lasik-operatsiya'
          │             └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f1dff305a90>
          └ <class 'urllib3.exceptions.MaxRetryError'>

urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f1dff2e4370>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f1dff2e4370>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-30, started 139765777147648)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f1dff2e4370>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f1e169ddaf0>
    └ <Thread(Thread-30, started 139765777147648)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f1e169dd820>
    └ <Thread(Thread-30, started 139765777147648)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-30, started 139765777147648)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекц...
    │    │        └ <Thread(Thread-30, started 139765777147648)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f1e159db640>>
    └ <Thread(Thread-30, started 139765777147648)>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 344, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекци...
    └ <function Site at 0x7f1e04c50820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 172, in __init__
    self.get_html()
    │    └ <function Site.get_html at 0x7f1e04c50b80>
    └ <__main__.Site object at 0x7f1dff3058b0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 236, in get_html
    r = requests.get(self.url, headers=HEADERS, verify=False, timeout=15).content
        │        │   │    │            └ {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/...
        │        │   │    └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
        │        │   └ <__main__.Site object at 0x7f1dff3058b0>
        │        └ <function get at 0x7f1e07faddc0>
        └ <module 'requests' from '/home/wenfort/env/lib/python3.8/site-packages/requests/__init__.py'>

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 76, in get
    return request('get', url, params=params, **kwargs)
           │              │           │         └ {'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147...
           │              │           └ None
           │              └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           └ <function request at 0x7f1e07f99c10>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
           │       │              │           │      └ {'params': None, 'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) ...
           │       │              │           └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           │       │              └ 'get'
           │       └ <function Session.request at 0x7f1e07fad550>
           └ <requests.sessions.Session object at 0x7f1dff3059d0>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
           │    │    │       └ {'timeout': 15, 'allow_redirects': True, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
           │    │    └ <PreparedRequest [GET]>
           │    └ <function Session.send at 0x7f1e07fad9d0>
           └ <requests.sessions.Session object at 0x7f1dff3059d0>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
        │       │    │          └ {'timeout': 15, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
        │       │    └ <PreparedRequest [GET]>
        │       └ <function HTTPAdapter.send at 0x7f1e07fa6e50>
        └ <requests.adapters.HTTPAdapter object at 0x7f1dff305940>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 514, in send
    raise SSLError(e, request=request)
          │                   └ <PreparedRequest [GET]>
          └ <class 'requests.exceptions.SSLError'>

requests.exceptions.SSLError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))
11:51:09 An error has been caught in function 'make_site_object', process 'Process-1' (4711), thread 'Thread-30' (139961198159616):
Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 699, in urlopen
    httplib_response = self._make_request(
                       │    └ <function HTTPConnectionPool._make_request at 0x7f4b95af75e0>
                       └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f4b7f2ff6d0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 382, in _make_request
    self._validate_conn(conn)
    │    │              └ <urllib3.connection.HTTPSConnection object at 0x7f4b7f3ffd90>
    │    └ <function HTTPSConnectionPool._validate_conn at 0x7f4b95af7af0>
    └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f4b7f2ff6d0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1010, in _validate_conn
    conn.connect()
    │    └ <function HTTPSConnection.connect at 0x7f4b95b231f0>
    └ <urllib3.connection.HTTPSConnection object at 0x7f4b7f3ffd90>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connection.py", line 411, in connect
    self.sock = ssl_wrap_socket(
    │    │      └ <function ssl_wrap_socket at 0x7f4b95b19ee0>
    │    └ None
    └ <urllib3.connection.HTTPSConnection object at 0x7f4b7f3ffd90>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 428, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               └ <function _ssl_wrap_socket_impl at 0x7f4b95b1b0d0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 472, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           │           │           │                     └ 'www.nlv.ru'
           │           │           └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
           │           └ <function SSLContext.wrap_socket at 0x7f4b96353700>
           └ <ssl.SSLContext object at 0x7f4b7f2a6c40>
  File "/usr/lib/python3.8/ssl.py", line 500, in wrap_socket
    return self.sslsocket_class._create(
           │    │               └ <classmethod object at 0x7f4b96352eb0>
           │    └ <class 'ssl.SSLSocket'>
           └ <ssl.SSLContext object at 0x7f4b7f2a6c40>
  File "/usr/lib/python3.8/ssl.py", line 1040, in _create
    self.do_handshake()
    │    └ <function SSLSocket.do_handshake at 0x7f4b963585e0>
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
  File "/usr/lib/python3.8/ssl.py", line 1309, in do_handshake
    self._sslobj.do_handshake()
    │    └ None
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>

ssl.SSLError: [SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 439, in send
    resp = conn.urlopen(
           │    └ <function HTTPConnectionPool.urlopen at 0x7f4b95af7820>
           └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f4b7f2ff6d0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 755, in urlopen
    retries = retries.increment(
              │       └ <function Retry.increment at 0x7f4b95ae83a0>
              └ Retry(total=0, connect=None, read=False, redirect=None, status=None)
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/retry.py", line 574, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
          │             │      │    │        │             └ 'unknown'
          │             │      │    │        └ <class 'urllib3.exceptions.ResponseError'>
          │             │      │    └ SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)'))
          │             │      └ '/laser-correction/lasik-operatsiya'
          │             └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f4b7f2ff6d0>
          └ <class 'urllib3.exceptions.MaxRetryError'>

urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f4b7f2e21f0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f4b7f2e21f0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-30, started 139961198159616)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f4b7f2e21f0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f4b969e8af0>
    └ <Thread(Thread-30, started 139961198159616)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f4b969e8820>
    └ <Thread(Thread-30, started 139961198159616)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-30, started 139961198159616)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекц...
    │    │        └ <Thread(Thread-30, started 139961198159616)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f4b959e6640>>
    └ <Thread(Thread-30, started 139961198159616)>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 344, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекци...
    └ <function Site at 0x7f4b84c4c820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 172, in __init__
    self.get_html()
    │    └ <function Site.get_html at 0x7f4b84c4cb80>
    └ <__main__.Site object at 0x7f4b7f2ff4c0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 236, in get_html
    r = requests.get(self.url, headers=HEADERS, verify=False, timeout=15).content
        │        │   │    │            └ {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/...
        │        │   │    └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
        │        │   └ <__main__.Site object at 0x7f4b7f2ff4c0>
        │        └ <function get at 0x7f4b87faedc0>
        └ <module 'requests' from '/home/wenfort/env/lib/python3.8/site-packages/requests/__init__.py'>

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 76, in get
    return request('get', url, params=params, **kwargs)
           │              │           │         └ {'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147...
           │              │           └ None
           │              └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           └ <function request at 0x7f4b87f9bc10>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
           │       │              │           │      └ {'params': None, 'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) ...
           │       │              │           └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           │       │              └ 'get'
           │       └ <function Session.request at 0x7f4b87fae550>
           └ <requests.sessions.Session object at 0x7f4b7f2ff5e0>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
           │    │    │       └ {'timeout': 15, 'allow_redirects': True, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
           │    │    └ <PreparedRequest [GET]>
           │    └ <function Session.send at 0x7f4b87fae9d0>
           └ <requests.sessions.Session object at 0x7f4b7f2ff5e0>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
        │       │    │          └ {'timeout': 15, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
        │       │    └ <PreparedRequest [GET]>
        │       └ <function HTTPAdapter.send at 0x7f4b87fa5e50>
        └ <requests.adapters.HTTPAdapter object at 0x7f4b7f2ff550>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 514, in send
    raise SSLError(e, request=request)
          │                   └ <PreparedRequest [GET]>
          └ <class 'requests.exceptions.SSLError'>

requests.exceptions.SSLError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))
11:53:44 An error has been caught in function 'make_site_object', process 'Process-1' (4861), thread 'Thread-30' (140080240891648):
Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 699, in urlopen
    httplib_response = self._make_request(
                       │    └ <function HTTPConnectionPool._make_request at 0x7f674962a700>
                       └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f6749b0c5e0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 382, in _make_request
    self._validate_conn(conn)
    │    │              └ <urllib3.connection.HTTPSConnection object at 0x7f6749b60e80>
    │    └ <function HTTPSConnectionPool._validate_conn at 0x7f674962ac10>
    └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f6749b0c5e0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1010, in _validate_conn
    conn.connect()
    │    └ <function HTTPSConnection.connect at 0x7f6749655310>
    └ <urllib3.connection.HTTPSConnection object at 0x7f6749b60e80>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connection.py", line 411, in connect
    self.sock = ssl_wrap_socket(
    │    │      └ <function ssl_wrap_socket at 0x7f6749649040>
    │    └ None
    └ <urllib3.connection.HTTPSConnection object at 0x7f6749b60e80>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 428, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               └ <function _ssl_wrap_socket_impl at 0x7f67496491f0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 472, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           │           │           │                     └ 'www.nlv.ru'
           │           │           └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
           │           └ <function SSLContext.wrap_socket at 0x7f6749ed2700>
           └ <ssl.SSLContext object at 0x7f6740310b40>
  File "/usr/lib/python3.8/ssl.py", line 500, in wrap_socket
    return self.sslsocket_class._create(
           │    │               └ <classmethod object at 0x7f6749ed0eb0>
           │    └ <class 'ssl.SSLSocket'>
           └ <ssl.SSLContext object at 0x7f6740310b40>
  File "/usr/lib/python3.8/ssl.py", line 1040, in _create
    self.do_handshake()
    │    └ <function SSLSocket.do_handshake at 0x7f6749ed65e0>
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
  File "/usr/lib/python3.8/ssl.py", line 1309, in do_handshake
    self._sslobj.do_handshake()
    │    └ None
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>

ssl.SSLError: [SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 439, in send
    resp = conn.urlopen(
           │    └ <function HTTPConnectionPool.urlopen at 0x7f674962a940>
           └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f6749b0c5e0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 755, in urlopen
    retries = retries.increment(
              │       └ <function Retry.increment at 0x7f67496174c0>
              └ Retry(total=0, connect=None, read=False, redirect=None, status=None)
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/retry.py", line 574, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
          │             │      │    │        │             └ 'unknown'
          │             │      │    │        └ <class 'urllib3.exceptions.ResponseError'>
          │             │      │    └ SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)'))
          │             │      └ '/laser-correction/lasik-operatsiya'
          │             └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f6749b0c5e0>
          └ <class 'urllib3.exceptions.MaxRetryError'>

urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f6736eb1c40>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f6736eb1c40>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-30, started 140080240891648)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f6736eb1c40>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f674a566af0>
    └ <Thread(Thread-30, started 140080240891648)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f674a566820>
    └ <Thread(Thread-30, started 140080240891648)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-30, started 140080240891648)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекц...
    │    │        └ <Thread(Thread-30, started 140080240891648)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f674950d400>>
    └ <Thread(Thread-30, started 140080240891648)>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 344, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекци...
    └ <function Site at 0x7f67407f5940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 172, in __init__
    self.get_html()
    │    └ <function Site.get_html at 0x7f67407f5ca0>
    └ <__main__.Site object at 0x7f6736e46520>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 236, in get_html
    r = requests.get(self.url, headers=HEADERS, verify=False, timeout=15).content
        │        │   │    │            └ {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/...
        │        │   │    └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
        │        │   └ <__main__.Site object at 0x7f6736e46520>
        │        └ <function get at 0x7f67482daee0>
        └ <module 'requests' from '/home/wenfort/env/lib/python3.8/site-packages/requests/__init__.py'>

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 76, in get
    return request('get', url, params=params, **kwargs)
           │              │           │         └ {'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147...
           │              │           └ None
           │              └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           └ <function request at 0x7f67482c3d30>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
           │       │              │           │      └ {'params': None, 'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) ...
           │       │              │           └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           │       │              └ 'get'
           │       └ <function Session.request at 0x7f67482da670>
           └ <requests.sessions.Session object at 0x7f6749b173a0>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
           │    │    │       └ {'timeout': 15, 'allow_redirects': True, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
           │    │    └ <PreparedRequest [GET]>
           │    └ <function Session.send at 0x7f67482daaf0>
           └ <requests.sessions.Session object at 0x7f6749b173a0>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
        │       │    │          └ {'timeout': 15, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
        │       │    └ <PreparedRequest [GET]>
        │       └ <function HTTPAdapter.send at 0x7f67482c9f70>
        └ <requests.adapters.HTTPAdapter object at 0x7f6749b17370>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 514, in send
    raise SSLError(e, request=request)
          │                   └ <PreparedRequest [GET]>
          └ <class 'requests.exceptions.SSLError'>

requests.exceptions.SSLError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))
11:54:50 An error has been caught in function 'make_site_object', process 'Process-1' (4985), thread 'Thread-30' (140055108638464):
Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 699, in urlopen
    httplib_response = self._make_request(
                       │    └ <function HTTPConnectionPool._make_request at 0x7f617fc825e0>
                       └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f616d5df970>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 382, in _make_request
    self._validate_conn(conn)
    │    │              └ <urllib3.connection.HTTPSConnection object at 0x7f616ef26d00>
    │    └ <function HTTPSConnectionPool._validate_conn at 0x7f617fc82af0>
    └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f616d5df970>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1010, in _validate_conn
    conn.connect()
    │    └ <function HTTPSConnection.connect at 0x7f617fdec1f0>
    └ <urllib3.connection.HTTPSConnection object at 0x7f616ef26d00>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connection.py", line 411, in connect
    self.sock = ssl_wrap_socket(
    │    │      └ <function ssl_wrap_socket at 0x7f617fddaee0>
    │    └ None
    └ <urllib3.connection.HTTPSConnection object at 0x7f616ef26d00>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 428, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               └ <function _ssl_wrap_socket_impl at 0x7f617fde20d0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 472, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           │           │           │                     └ 'www.nlv.ru'
           │           │           └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
           │           └ <function SSLContext.wrap_socket at 0x7f618061c700>
           └ <ssl.SSLContext object at 0x7f616d7024c0>
  File "/usr/lib/python3.8/ssl.py", line 500, in wrap_socket
    return self.sslsocket_class._create(
           │    │               └ <classmethod object at 0x7f618061beb0>
           │    └ <class 'ssl.SSLSocket'>
           └ <ssl.SSLContext object at 0x7f616d7024c0>
  File "/usr/lib/python3.8/ssl.py", line 1040, in _create
    self.do_handshake()
    │    └ <function SSLSocket.do_handshake at 0x7f61806215e0>
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
  File "/usr/lib/python3.8/ssl.py", line 1309, in do_handshake
    self._sslobj.do_handshake()
    │    └ None
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>

ssl.SSLError: [SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 439, in send
    resp = conn.urlopen(
           │    └ <function HTTPConnectionPool.urlopen at 0x7f617fc82820>
           └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f616d5df970>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 755, in urlopen
    retries = retries.increment(
              │       └ <function Retry.increment at 0x7f617fc6e3a0>
              └ Retry(total=0, connect=None, read=False, redirect=None, status=None)
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/retry.py", line 574, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
          │             │      │    │        │             └ 'unknown'
          │             │      │    │        └ <class 'urllib3.exceptions.ResponseError'>
          │             │      │    └ SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)'))
          │             │      └ '/laser-correction/lasik-operatsiya'
          │             └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f616d5df970>
          └ <class 'urllib3.exceptions.MaxRetryError'>

urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f616d67f670>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f616d67f670>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-30, started 140055108638464)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f616d67f670>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f6180a7aaf0>
    └ <Thread(Thread-30, started 140055108638464)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f6180a7a820>
    └ <Thread(Thread-30, started 140055108638464)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-30, started 140055108638464)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекц...
    │    │        └ <Thread(Thread-30, started 140055108638464)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f617fcae640>>
    └ <Thread(Thread-30, started 140055108638464)>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 344, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекци...
    └ <function Site at 0x7f617c023820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 172, in __init__
    self.get_html()
    │    └ <function Site.get_html at 0x7f617c023b80>
    └ <__main__.Site object at 0x7f616d6297f0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 236, in get_html
    r = requests.get(self.url, headers=HEADERS, verify=False, timeout=15).content
        │        │   │    │            └ {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/...
        │        │   │    └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
        │        │   └ <__main__.Site object at 0x7f616d6297f0>
        │        └ <function get at 0x7f617e2b1dc0>
        └ <module 'requests' from '/home/wenfort/env/lib/python3.8/site-packages/requests/__init__.py'>

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 76, in get
    return request('get', url, params=params, **kwargs)
           │              │           │         └ {'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147...
           │              │           └ None
           │              └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           └ <function request at 0x7f617e29fc10>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
           │       │              │           │      └ {'params': None, 'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) ...
           │       │              │           └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           │       │              └ 'get'
           │       └ <function Session.request at 0x7f617e2b1550>
           └ <requests.sessions.Session object at 0x7f616d5df640>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
           │    │    │       └ {'timeout': 15, 'allow_redirects': True, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
           │    │    └ <PreparedRequest [GET]>
           │    └ <function Session.send at 0x7f617e2b19d0>
           └ <requests.sessions.Session object at 0x7f616d5df640>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
        │       │    │          └ {'timeout': 15, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
        │       │    └ <PreparedRequest [GET]>
        │       └ <function HTTPAdapter.send at 0x7f617e2a9e50>
        └ <requests.adapters.HTTPAdapter object at 0x7f616d5df670>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 514, in send
    raise SSLError(e, request=request)
          │                   └ <PreparedRequest [GET]>
          └ <class 'requests.exceptions.SSLError'>

requests.exceptions.SSLError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))
11:56:48 An error has been caught in function 'make_concurency_object', process 'Process-1' (4985), thread 'MainThread' (140056757757760):
Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2131, in <module>
    main()
    └ <function main at 0x7f617fe334c0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2122, in main
    globals = debugger.run(setup['file'], None, None, is_module)
              │        │   │                          └ False
              │        │   └ {'port': 37117, 'vm_type': None, 'client': '127.0.0.1', 'server': False, 'DEBUG_RECORD_SOCKET_READS': False, 'multiproc': Tru...
              │        └ <function PyDB.run at 0x7f617fe344c0>
              └ <__main__.PyDB object at 0x7f6180637ee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1431, in run
    return self._exec(is_module, entry_point_fn, module_name, file, globals, locals)
           │    │     │          │               │            │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
           │    │     │          │               └ None
           │    │     │          └ ''
           │    │     └ False
           │    └ <function PyDB._exec at 0x7f617fe34550>
           └ <__main__.PyDB object at 0x7f6180637ee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1438, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
    │             │        │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
    │             └ <function execfile at 0x7f6180cee280>
    └ <module '_pydev_bundle.pydev_imports' from '/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/...

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
                 │              │              │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              │              └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
                 └ 'from microservices.conc_settings import *\nfrom multiprocessing import Process, Queue\nfrom threading import Thread\nfrom lo...

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 885, in <module>
    Manager()
    └ <function Manager at 0x7f617fc9e1f0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 52, in __init__
    self.run_processes()
    │    └ <function Manager.run_processes at 0x7f617c023040>
    └ <__main__.Manager object at 0x7f617c085550>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 89, in run_processes
    self.start_processes()
    │    └ <function Manager.start_processes at 0x7f617c023160>
    └ <__main__.Manager object at 0x7f617c085550>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 97, in start_processes
    process.start()
    │       └ <function BaseProcess.start at 0x7f617fcb4160>
    └ <Process name='Process-1' parent=4979 started>

  File "/usr/lib/python3.8/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
    │    │        │    │      └ <Process name='Process-1' parent=4979 started>
    │    │        │    └ <staticmethod object at 0x7f617fca6880>
    │    │        └ <Process name='Process-1' parent=4979 started>
    │    └ None
    └ <Process name='Process-1' parent=4979 started>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
           │                │                            └ <Process name='Process-1' parent=4979 started>
           │                └ <function DefaultContext.get_context at 0x7f617fcbeb80>
           └ <multiprocessing.context.DefaultContext object at 0x7f617fcaeca0>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
           │     └ <Process name='Process-1' parent=4979 started>
           └ <class 'multiprocessing.popen_fork.Popen'>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
    │    │       └ <Process name='Process-1' parent=4979 started>
    │    └ <function Popen._launch at 0x7f616eef19d0>
    └ <multiprocessing.popen_fork.Popen object at 0x7f616eef5160>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 75, in _launch
    code = process_obj._bootstrap(parent_sentinel=child_r)
           │           │                          └ 9
           │           └ <function BaseProcess._bootstrap at 0x7f617fcb4a60>
           └ <Process name='Process-1' parent=4979 started>
  File "/usr/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7f617fcb40d0>
    └ <Process name='Process-1' parent=4979 started>
  File "/usr/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Process name='Process-1' parent=4979 started>
    │    │        │    └ (RequestDataSet(id=44, text='lasik', xml='<?xml version="1.0" encoding="UTF-8" ?>\n<yandexsearch version="1.0">\n  <response ...
    │    │        └ <Process name='Process-1' parent=4979 started>
    │    └ <function Yandex at 0x7f617c023f70>
    └ <Process name='Process-1' parent=4979 started>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 273, in __init__
    self.make_concurency_object()
    │    └ <function Yandex.make_concurency_object at 0x7f617c01a820>
    └ <__main__.Yandex object at 0x7f617fcae640>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 364, in make_concurency_object
    self.concurency_object = Concurency(self.site_list, self.stemmed_request)
    │    │                   │          │    │          │    └ ['lasik']
    │    │                   │          │    │          └ <__main__.Yandex object at 0x7f617fcae640>
    │    │                   │          │    └ [SiteDataSet(html=<doc><url>https://ru.wikipedia.org/wiki/LASIK</url><title>LASIK — Википедия</title><breadcrumbs></breadcrum...
    │    │                   │          └ <__main__.Yandex object at 0x7f617fcae640>
    │    │                   └ <function Concurency at 0x7f617c01cf70>
    │    └ <object object at 0x7f616eef73c0>
    └ <__main__.Yandex object at 0x7f617fcae640>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 627, in __init__
    self.calculate_site_stem_concurency()
    │    └ <function Concurency.calculate_site_stem_concurency at 0x7f617c021430>
    └ <__main__.Concurency object at 0x7f616c421100>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 738, in calculate_site_stem_concurency
    matched_stem_items_amount = self.count_matched_stem_items(site_dataset.stemmed_title)
                                │    │                        └ SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекци...
                                │    └ <function Concurency.count_matched_stem_items at 0x7f617c0214c0>
                                └ <__main__.Concurency object at 0x7f616c421100>

AttributeError: 'SiteDataSet' object has no attribute 'stemmed_title'
11:58:21 An error has been caught in function 'make_site_object', process 'Process-1' (5441), thread 'Thread-30' (140588397602560):
Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 699, in urlopen
    httplib_response = self._make_request(
                       │    └ <function HTTPConnectionPool._make_request at 0x7fdd9db465e0>
                       └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fdd8735d100>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 382, in _make_request
    self._validate_conn(conn)
    │    │              └ <urllib3.connection.HTTPSConnection object at 0x7fdd872e4910>
    │    └ <function HTTPSConnectionPool._validate_conn at 0x7fdd9db46af0>
    └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fdd8735d100>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1010, in _validate_conn
    conn.connect()
    │    └ <function HTTPSConnection.connect at 0x7fdd9db701f0>
    └ <urllib3.connection.HTTPSConnection object at 0x7fdd872e4910>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connection.py", line 411, in connect
    self.sock = ssl_wrap_socket(
    │    │      └ <function ssl_wrap_socket at 0x7fdd9db5fee0>
    │    └ None
    └ <urllib3.connection.HTTPSConnection object at 0x7fdd872e4910>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 428, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               └ <function _ssl_wrap_socket_impl at 0x7fdd9db670d0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 472, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           │           │           │                     └ 'www.nlv.ru'
           │           │           └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
           │           └ <function SSLContext.wrap_socket at 0x7fdd9e3a2700>
           └ <ssl.SSLContext object at 0x7fdd872f6540>
  File "/usr/lib/python3.8/ssl.py", line 500, in wrap_socket
    return self.sslsocket_class._create(
           │    │               └ <classmethod object at 0x7fdd9e3a0eb0>
           │    └ <class 'ssl.SSLSocket'>
           └ <ssl.SSLContext object at 0x7fdd872f6540>
  File "/usr/lib/python3.8/ssl.py", line 1040, in _create
    self.do_handshake()
    │    └ <function SSLSocket.do_handshake at 0x7fdd9e3a65e0>
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
  File "/usr/lib/python3.8/ssl.py", line 1309, in do_handshake
    self._sslobj.do_handshake()
    │    └ None
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>

ssl.SSLError: [SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 439, in send
    resp = conn.urlopen(
           │    └ <function HTTPConnectionPool.urlopen at 0x7fdd9db46820>
           └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fdd8735d100>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 755, in urlopen
    retries = retries.increment(
              │       └ <function Retry.increment at 0x7fdd9db373a0>
              └ Retry(total=0, connect=None, read=False, redirect=None, status=None)
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/retry.py", line 574, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
          │             │      │    │        │             └ 'unknown'
          │             │      │    │        └ <class 'urllib3.exceptions.ResponseError'>
          │             │      │    └ SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)'))
          │             │      └ '/laser-correction/lasik-operatsiya'
          │             └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fdd8735d100>
          └ <class 'urllib3.exceptions.MaxRetryError'>

urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fdd87366fd0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fdd87366fd0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-30, started 140588397602560)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fdd87366fd0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fdd9ea36af0>
    └ <Thread(Thread-30, started 140588397602560)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fdd9ea36820>
    └ <Thread(Thread-30, started 140588397602560)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-30, started 140588397602560)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекц...
    │    │        └ <Thread(Thread-30, started 140588397602560)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fdd9da33640>>
    └ <Thread(Thread-30, started 140588397602560)>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 344, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекци...
    └ <function Site at 0x7fdd8cccc820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 172, in __init__
    self.get_html()
    │    └ <function Site.get_html at 0x7fdd8ccccb80>
    └ <__main__.Site object at 0x7fdd8737d460>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 236, in get_html
    r = requests.get(self.url, headers=HEADERS, verify=False, timeout=15).content
        │        │   │    │            └ {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/...
        │        │   │    └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
        │        │   └ <__main__.Site object at 0x7fdd8737d460>
        │        └ <function get at 0x7fdd9c035dc0>
        └ <module 'requests' from '/home/wenfort/env/lib/python3.8/site-packages/requests/__init__.py'>

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 76, in get
    return request('get', url, params=params, **kwargs)
           │              │           │         └ {'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147...
           │              │           └ None
           │              └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           └ <function request at 0x7fdd9c023c10>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
           │       │              │           │      └ {'params': None, 'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) ...
           │       │              │           └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           │       │              └ 'get'
           │       └ <function Session.request at 0x7fdd9c035550>
           └ <requests.sessions.Session object at 0x7fdd87354d90>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
           │    │    │       └ {'timeout': 15, 'allow_redirects': True, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
           │    │    └ <PreparedRequest [GET]>
           │    └ <function Session.send at 0x7fdd9c0359d0>
           └ <requests.sessions.Session object at 0x7fdd87354d90>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
        │       │    │          └ {'timeout': 15, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
        │       │    └ <PreparedRequest [GET]>
        │       └ <function HTTPAdapter.send at 0x7fdd9c02de50>
        └ <requests.adapters.HTTPAdapter object at 0x7fdd87354dc0>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 514, in send
    raise SSLError(e, request=request)
          │                   └ <PreparedRequest [GET]>
          └ <class 'requests.exceptions.SSLError'>

requests.exceptions.SSLError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))
12:01:34 An error has been caught in function 'make_site_object', process 'Process-1' (5635), thread 'Thread-30' (140233584645888):
Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 699, in urlopen
    httplib_response = self._make_request(
                       │    └ <function HTTPConnectionPool._make_request at 0x7f8afd7cf5e0>
                       └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f8acc43b430>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 382, in _make_request
    self._validate_conn(conn)
    │    │              └ <urllib3.connection.HTTPSConnection object at 0x7f8acc4b2fd0>
    │    └ <function HTTPSConnectionPool._validate_conn at 0x7f8afd7cfaf0>
    └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f8acc43b430>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1010, in _validate_conn
    conn.connect()
    │    └ <function HTTPSConnection.connect at 0x7f8afd7fb1f0>
    └ <urllib3.connection.HTTPSConnection object at 0x7f8acc4b2fd0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connection.py", line 411, in connect
    self.sock = ssl_wrap_socket(
    │    │      └ <function ssl_wrap_socket at 0x7f8afd7f0ee0>
    │    └ None
    └ <urllib3.connection.HTTPSConnection object at 0x7f8acc4b2fd0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 428, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               └ <function _ssl_wrap_socket_impl at 0x7f8afd7f10d0>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 472, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           │           │           │                     └ 'www.nlv.ru'
           │           │           └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
           │           └ <function SSLContext.wrap_socket at 0x7f8afe02a700>
           └ <ssl.SSLContext object at 0x7f8ae94c2940>
  File "/usr/lib/python3.8/ssl.py", line 500, in wrap_socket
    return self.sslsocket_class._create(
           │    │               └ <classmethod object at 0x7f8afe029eb0>
           │    └ <class 'ssl.SSLSocket'>
           └ <ssl.SSLContext object at 0x7f8ae94c2940>
  File "/usr/lib/python3.8/ssl.py", line 1040, in _create
    self.do_handshake()
    │    └ <function SSLSocket.do_handshake at 0x7f8afe02f5e0>
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
  File "/usr/lib/python3.8/ssl.py", line 1309, in do_handshake
    self._sslobj.do_handshake()
    │    └ None
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>

ssl.SSLError: [SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 439, in send
    resp = conn.urlopen(
           │    └ <function HTTPConnectionPool.urlopen at 0x7f8afd7cf820>
           └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f8acc43b430>
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/connectionpool.py", line 755, in urlopen
    retries = retries.increment(
              │       └ <function Retry.increment at 0x7f8afd7bf3a0>
              └ Retry(total=0, connect=None, read=False, redirect=None, status=None)
  File "/home/wenfort/env/lib/python3.8/site-packages/urllib3/util/retry.py", line 574, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
          │             │      │    │        │             └ 'unknown'
          │             │      │    │        └ <class 'urllib3.exceptions.ResponseError'>
          │             │      │    └ SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)'))
          │             │      └ '/laser-correction/lasik-operatsiya'
          │             └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7f8acc43b430>
          └ <class 'urllib3.exceptions.MaxRetryError'>

urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f8aeb02a2b0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f8aeb02a2b0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-30, started 140233584645888)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f8aeb02a2b0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f8afe6bfaf0>
    └ <Thread(Thread-30, started 140233584645888)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f8afe6bf820>
    └ <Thread(Thread-30, started 140233584645888)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-30, started 140233584645888)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекц...
    │    │        └ <Thread(Thread-30, started 140233584645888)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f8afd6bd6a0>>
    └ <Thread(Thread-30, started 140233584645888)>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 344, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекци...
    └ <function Site at 0x7f8af493f820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 172, in __init__
    self.get_html()
    │    └ <function Site.get_html at 0x7f8af493fb80>
    └ <__main__.Site object at 0x7f8aeafd1880>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 236, in get_html
    r = requests.get(self.url, headers=HEADERS, verify=False, timeout=15).content
        │        │   │    │            └ {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/...
        │        │   │    └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
        │        │   └ <__main__.Site object at 0x7f8aeafd1880>
        │        └ <function get at 0x7f8afc4c1dc0>
        └ <module 'requests' from '/home/wenfort/env/lib/python3.8/site-packages/requests/__init__.py'>

  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 76, in get
    return request('get', url, params=params, **kwargs)
           │              │           │         └ {'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147...
           │              │           └ None
           │              └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           └ <function request at 0x7f8afc4acc10>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
           │       │              │           │      └ {'params': None, 'headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) ...
           │       │              │           └ 'https://www.nlv.ru/laser-correction/lasik-operatsiya'
           │       │              └ 'get'
           │       └ <function Session.request at 0x7f8afc4c1550>
           └ <requests.sessions.Session object at 0x7f8acc2469a0>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
           │    │    │       └ {'timeout': 15, 'allow_redirects': True, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
           │    │    └ <PreparedRequest [GET]>
           │    └ <function Session.send at 0x7f8afc4c19d0>
           └ <requests.sessions.Session object at 0x7f8acc2469a0>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
        │       │    │          └ {'timeout': 15, 'verify': False, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
        │       │    └ <PreparedRequest [GET]>
        │       └ <function HTTPAdapter.send at 0x7f8afc4b9e50>
        └ <requests.adapters.HTTPAdapter object at 0x7f8acc4456a0>
  File "/home/wenfort/env/lib/python3.8/site-packages/requests/adapters.py", line 514, in send
    raise SSLError(e, request=request)
          │                   └ <PreparedRequest [GET]>
          └ <class 'requests.exceptions.SSLError'>

requests.exceptions.SSLError: HTTPSConnectionPool(host='www.nlv.ru', port=443): Max retries exceeded with url: /laser-correction/lasik-operatsiya (Caused by SSLError(SSLError(1, '[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:1123)')))
12:41:09 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8331), thread 'Thread-18' (139850686646016):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7f31976fcaf0>
    └ <__main__.Content object at 0x7f3195dce220>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7f3195dce220>
    │    └ ''
    └ <__main__.Content object at 0x7f3195dce220>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40820>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40820>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-18, started 139850686646016)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40820>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f31a9479af0>
    └ <Thread(Thread-18, started 139850686646016)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f31a9479820>
    └ <Thread(Thread-18, started 139850686646016)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-18, started 139850686646016)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://elitplus-clinic.ru/stati/lazernaya-korrekcziya-zreniya-lasik.html</url><title>Лазерная ко...
    │    │        └ <Thread(Thread-18, started 139850686646016)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f31a8478670>>
    └ <Thread(Thread-18, started 139850686646016)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://elitplus-clinic.ru/stati/lazernaya-korrekcziya-zreniya-lasik.html</url><title>Лазерная кор...
    └ <function Site at 0x7f31976fe820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7f31976feca0>
    └ <__main__.Site object at 0x7f3195e40490>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://elitplus-clinic.ru/stati/lazernaya-korrekcziya-zreniya-lasik.html</url><title>Лазерная кор...
    │       │    │     └ <__main__.Site object at 0x7f3195e40490>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7f3195e40490>
    └ <function Content at 0x7f31976fc940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7f31a8495670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:09 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8331), thread 'Thread-25' (139850082666240):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7f31976fcaf0>
    └ <__main__.Content object at 0x7f3195dce640>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7f3195dce640>
    │    └ ''
    └ <__main__.Content object at 0x7f3195dce640>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e5c3d0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e5c3d0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-25, started 139850082666240)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e5c3d0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f31a9479af0>
    └ <Thread(Thread-25, started 139850082666240)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f31a9479820>
    └ <Thread(Thread-25, started 139850082666240)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-25, started 139850082666240)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://realeyes.ru/metod/lasik/</url><title>Лазерная коррекция зрения LASIK : цена, отзывы, как....
    │    │        └ <Thread(Thread-25, started 139850082666240)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f31a8478670>>
    └ <Thread(Thread-25, started 139850082666240)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://realeyes.ru/metod/lasik/</url><title>Лазерная коррекция зрения LASIK : цена, отзывы, как.....
    └ <function Site at 0x7f31976fe820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7f31976feca0>
    └ <__main__.Site object at 0x7f3195e5cb50>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://realeyes.ru/metod/lasik/</url><title>Лазерная коррекция зрения LASIK : цена, отзывы, как.....
    │       │    │     └ <__main__.Site object at 0x7f3195e5cb50>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7f3195e5cb50>
    └ <function Content at 0x7f31976fc940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7f31a8495670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:10 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8331), thread 'Thread-22' (139850107844352):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7f31976fcaf0>
    └ <__main__.Content object at 0x7f3195fc8f70>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7f3195fc8f70>
    │    └ ''
    └ <__main__.Content object at 0x7f3195fc8f70>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e5c040>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e5c040>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-22, started 139850107844352)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e5c040>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f31a9479af0>
    └ <Thread(Thread-22, started 139850107844352)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f31a9479820>
    └ <Thread(Thread-22, started 139850107844352)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-22, started 139850107844352)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://eyesurgerycenter.ru/lazernaya-korrekciya-zreniya/lasik.html</url><title>Операция Ласик (С...
    │    │        └ <Thread(Thread-22, started 139850107844352)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f31a8478670>>
    └ <Thread(Thread-22, started 139850107844352)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://eyesurgerycenter.ru/lazernaya-korrekciya-zreniya/lasik.html</url><title>Операция Ласик (Су...
    └ <function Site at 0x7f31976fe820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7f31976feca0>
    └ <__main__.Site object at 0x7f3195e5c850>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://eyesurgerycenter.ru/lazernaya-korrekciya-zreniya/lasik.html</url><title>Операция Ласик (Су...
    │       │    │     └ <__main__.Site object at 0x7f3195e5c850>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7f3195e5c850>
    └ <function Content at 0x7f31976fc940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7f31a8495670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:09 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8331), thread 'Thread-20' (139850669860608):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7f31976fcaf0>
    └ <__main__.Content object at 0x7f3195dce6d0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7f3195dce6d0>
    │    └ ''
    └ <__main__.Content object at 0x7f3195dce6d0>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40580>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40580>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-20, started 139850669860608)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40580>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f31a9479af0>
    └ <Thread(Thread-20, started 139850669860608)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f31a9479820>
    └ <Thread(Thread-20, started 139850669860608)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-20, started 139850669860608)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://fedorovmedcenter.ru/stati/oft-lazernaya-korrektsiya-zreniya/lazernaya-korrektsii-zreniya-...
    │    │        └ <Thread(Thread-20, started 139850669860608)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f31a8478670>>
    └ <Thread(Thread-20, started 139850669860608)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://fedorovmedcenter.ru/stati/oft-lazernaya-korrektsiya-zreniya/lazernaya-korrektsii-zreniya-l...
    └ <function Site at 0x7f31976fe820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7f31976feca0>
    └ <__main__.Site object at 0x7f3195e40f10>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://fedorovmedcenter.ru/stati/oft-lazernaya-korrektsiya-zreniya/lazernaya-korrektsii-zreniya-l...
    │       │    │     └ <__main__.Site object at 0x7f3195e40f10>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7f3195e40f10>
    └ <function Content at 0x7f31976fc940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7f31a8495670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:09 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8331), thread 'Thread-24' (139850091058944):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7f31976fcaf0>
    └ <__main__.Content object at 0x7f3195de1e20>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7f3195de1e20>
    │    └ ''
    └ <__main__.Content object at 0x7f3195de1e20>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40f70>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40f70>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-24, started 139850091058944)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40f70>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f31a9479af0>
    └ <Thread(Thread-24, started 139850091058944)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f31a9479820>
    └ <Thread(Thread-24, started 139850091058944)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-24, started 139850091058944)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://ophthalmocenter.ru/lazernaya-korrekciya-zreniya/lazernaya-korrekciya-zreniya-lasic.html</...
    │    │        └ <Thread(Thread-24, started 139850091058944)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f31a8478670>>
    └ <Thread(Thread-24, started 139850091058944)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://ophthalmocenter.ru/lazernaya-korrekciya-zreniya/lazernaya-korrekciya-zreniya-lasic.html</u...
    └ <function Site at 0x7f31976fe820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7f31976feca0>
    └ <__main__.Site object at 0x7f3195e5cd30>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://ophthalmocenter.ru/lazernaya-korrekciya-zreniya/lazernaya-korrekciya-zreniya-lasic.html</u...
    │       │    │     └ <__main__.Site object at 0x7f3195e5cd30>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7f3195e5cd30>
    └ <function Content at 0x7f31976fc940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7f31a8495670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:10 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8331), thread 'Thread-16' (139850703431424):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7f31976fcaf0>
    └ <__main__.Content object at 0x7f3195dce8e0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7f3195dce8e0>
    │    └ ''
    └ <__main__.Content object at 0x7f3195dce8e0>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40310>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40310>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-16, started 139850703431424)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40310>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f31a9479af0>
    └ <Thread(Thread-16, started 139850703431424)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f31a9479820>
    └ <Thread(Thread-16, started 139850703431424)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-16, started 139850703431424)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.vseozrenii.ru/lazernaya-korrekciya-zreniya/lasik/</url><title>ЛАСИК ( LASIK ) метод л...
    │    │        └ <Thread(Thread-16, started 139850703431424)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f31a8478670>>
    └ <Thread(Thread-16, started 139850703431424)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.vseozrenii.ru/lazernaya-korrekciya-zreniya/lasik/</url><title>ЛАСИК ( LASIK ) метод ла...
    └ <function Site at 0x7f31976fe820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7f31976feca0>
    └ <__main__.Site object at 0x7f3195e40b20>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://www.vseozrenii.ru/lazernaya-korrekciya-zreniya/lasik/</url><title>ЛАСИК ( LASIK ) метод ла...
    │       │    │     └ <__main__.Site object at 0x7f3195e40b20>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7f3195e40b20>
    └ <function Content at 0x7f31976fc940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7f31a8495670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:09 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8331), thread 'Thread-28' (139850057488128):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7f31976fcaf0>
    └ <__main__.Content object at 0x7f3195dceb20>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7f3195dceb20>
    │    └ ''
    └ <__main__.Content object at 0x7f3195dceb20>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e5cc40>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e5cc40>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-28, started 139850057488128)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e5cc40>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f31a9479af0>
    └ <Thread(Thread-28, started 139850057488128)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f31a9479820>
    └ <Thread(Thread-28, started 139850057488128)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-28, started 139850057488128)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.cvz.ru/laser-correction/metody/lasik/</url><title>ЛАСИК ( LASIK ) — методика лазерной...
    │    │        └ <Thread(Thread-28, started 139850057488128)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f31a8478670>>
    └ <Thread(Thread-28, started 139850057488128)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.cvz.ru/laser-correction/metody/lasik/</url><title>ЛАСИК ( LASIK ) — методика лазерной ...
    └ <function Site at 0x7f31976fe820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7f31976feca0>
    └ <__main__.Site object at 0x7f3195df6730>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://www.cvz.ru/laser-correction/metody/lasik/</url><title>ЛАСИК ( LASIK ) — методика лазерной ...
    │       │    │     └ <__main__.Site object at 0x7f3195df6730>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7f3195df6730>
    └ <function Content at 0x7f31976fc940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7f31a8495670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:10 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8331), thread 'Thread-21' (139850661467904):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7f31976fcaf0>
    └ <__main__.Content object at 0x7f31a8521e20>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7f31a8521e20>
    │    └ ''
    └ <__main__.Content object at 0x7f31a8521e20>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40dc0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40dc0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-21, started 139850661467904)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40dc0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f31a9479af0>
    └ <Thread(Thread-21, started 139850661467904)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f31a9479820>
    └ <Thread(Thread-21, started 139850661467904)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-21, started 139850661467904)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://100med.ru/directions/oftalmologiya/lazernaya-korrektsiya-zreniya-pri-pomoshchi-lasik-lasi...
    │    │        └ <Thread(Thread-21, started 139850661467904)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f31a8478670>>
    └ <Thread(Thread-21, started 139850661467904)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://100med.ru/directions/oftalmologiya/lazernaya-korrektsiya-zreniya-pri-pomoshchi-lasik-lasik...
    └ <function Site at 0x7f31976fe820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7f31976feca0>
    └ <__main__.Site object at 0x7f3195e5c610>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://100med.ru/directions/oftalmologiya/lazernaya-korrektsiya-zreniya-pri-pomoshchi-lasik-lasik...
    │       │    │     └ <__main__.Site object at 0x7f3195e5c610>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7f3195e5c610>
    └ <function Content at 0x7f31976fc940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7f31a8495670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:10 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8331), thread 'Thread-27' (139850065880832):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7f31976fcaf0>
    └ <__main__.Content object at 0x7f31976e0eb0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7f31976e0eb0>
    │    └ ''
    └ <__main__.Content object at 0x7f31976e0eb0>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e5c700>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e5c700>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-27, started 139850065880832)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e5c700>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f31a9479af0>
    └ <Thread(Thread-27, started 139850065880832)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f31a9479820>
    └ <Thread(Thread-27, started 139850065880832)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-27, started 139850065880832)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://prozrenie-tat.ru/_o_lazernoy_korrekcii_zreniya_LASIK_</url><title>О лазерной коррекции зр...
    │    │        └ <Thread(Thread-27, started 139850065880832)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f31a8478670>>
    └ <Thread(Thread-27, started 139850065880832)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://prozrenie-tat.ru/_o_lazernoy_korrekcii_zreniya_LASIK_</url><title>О лазерной коррекции зре...
    └ <function Site at 0x7f31976fe820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7f31976feca0>
    └ <__main__.Site object at 0x7f3195df6430>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://prozrenie-tat.ru/_o_lazernoy_korrekcii_zreniya_LASIK_</url><title>О лазерной коррекции зре...
    │       │    │     └ <__main__.Site object at 0x7f3195df6430>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7f3195df6430>
    └ <function Content at 0x7f31976fc940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7f31a8495670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:09 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8331), thread 'Thread-13' (139850935158528):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7f31976fcaf0>
    └ <__main__.Content object at 0x7f3195de1070>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7f3195de1070>
    │    └ ''
    └ <__main__.Content object at 0x7f3195de1070>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e37d30>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e37d30>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-13, started 139850935158528)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e37d30>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f31a9479af0>
    └ <Thread(Thread-13, started 139850935158528)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f31a9479820>
    └ <Thread(Thread-13, started 139850935158528)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-13, started 139850935158528)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.ochkov.net/wiki/lazernaya-korrekciya-zreniya-kak-prohodit-operaciya-lasik.htm</url><t...
    │    │        └ <Thread(Thread-13, started 139850935158528)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f31a8478670>>
    └ <Thread(Thread-13, started 139850935158528)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.ochkov.net/wiki/lazernaya-korrekciya-zreniya-kak-prohodit-operaciya-lasik.htm</url><ti...
    └ <function Site at 0x7f31976fe820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7f31976feca0>
    └ <__main__.Site object at 0x7f3195e402e0>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://www.ochkov.net/wiki/lazernaya-korrekciya-zreniya-kak-prohodit-operaciya-lasik.htm</url><ti...
    │       │    │     └ <__main__.Site object at 0x7f3195e402e0>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7f3195e402e0>
    └ <function Content at 0x7f31976fc940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7f31a8495670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:10 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8331), thread 'Thread-19' (139850678253312):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7f31976fcaf0>
    └ <__main__.Content object at 0x7f31960811c0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7f31960811c0>
    │    └ ''
    └ <__main__.Content object at 0x7f31960811c0>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40ac0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40ac0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-19, started 139850678253312)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40ac0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f31a9479af0>
    └ <Thread(Thread-19, started 139850678253312)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f31a9479820>
    └ <Thread(Thread-19, started 139850678253312)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-19, started 139850678253312)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://excimerclinic.ru/laser-correction/lasik/</url><title>Лазерная коррекция зрения с помощью ...
    │    │        └ <Thread(Thread-19, started 139850678253312)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f31a8478670>>
    └ <Thread(Thread-19, started 139850678253312)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://excimerclinic.ru/laser-correction/lasik/</url><title>Лазерная коррекция зрения с помощью о...
    └ <function Site at 0x7f31976fe820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7f31976feca0>
    └ <__main__.Site object at 0x7f3195e40fd0>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://excimerclinic.ru/laser-correction/lasik/</url><title>Лазерная коррекция зрения с помощью о...
    │       │    │     └ <__main__.Site object at 0x7f3195e40fd0>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7f3195e40fd0>
    └ <function Content at 0x7f31976fc940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7f31a8495670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:09 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8331), thread 'Thread-26' (139850074273536):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7f31976fcaf0>
    └ <__main__.Content object at 0x7f3195de1820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7f3195de1820>
    │    └ ''
    └ <__main__.Content object at 0x7f3195de1820>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e5caf0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e5caf0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-26, started 139850074273536)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e5caf0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f31a9479af0>
    └ <Thread(Thread-26, started 139850074273536)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f31a9479820>
    └ <Thread(Thread-26, started 139850074273536)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-26, started 139850074273536)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://mgkl.ru/uslugi/metodika-lasik</url><title>Лазерная коррекция зрения по методике ЛАСИК ( L...
    │    │        └ <Thread(Thread-26, started 139850074273536)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f31a8478670>>
    └ <Thread(Thread-26, started 139850074273536)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://mgkl.ru/uslugi/metodika-lasik</url><title>Лазерная коррекция зрения по методике ЛАСИК ( LA...
    └ <function Site at 0x7f31976fe820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7f31976feca0>
    └ <__main__.Site object at 0x7f3195e5cd90>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://mgkl.ru/uslugi/metodika-lasik</url><title>Лазерная коррекция зрения по методике ЛАСИК ( LA...
    │       │    │     └ <__main__.Site object at 0x7f3195e5cd90>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7f3195e5cd90>
    └ <function Content at 0x7f31976fc940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7f31a8495670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:09 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8331), thread 'Thread-29' (139849570973440):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7f31976fcaf0>
    └ <__main__.Content object at 0x7f3195dbec40>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7f3195dbec40>
    │    └ ''
    └ <__main__.Content object at 0x7f3195dbec40>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e5cfd0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e5cfd0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-29, started 139849570973440)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e5cfd0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f31a9479af0>
    └ <Thread(Thread-29, started 139849570973440)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f31a9479820>
    └ <Thread(Thread-29, started 139849570973440)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-29, started 139849570973440)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://smileeyes.ru/operacija-lasik/</url><title>Лазерная коррекция ЛАСИК - популярный метод...<...
    │    │        └ <Thread(Thread-29, started 139849570973440)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f31a8478670>>
    └ <Thread(Thread-29, started 139849570973440)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://smileeyes.ru/operacija-lasik/</url><title>Лазерная коррекция ЛАСИК - популярный метод...</...
    └ <function Site at 0x7f31976fe820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7f31976feca0>
    └ <__main__.Site object at 0x7f3195df6a00>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://smileeyes.ru/operacija-lasik/</url><title>Лазерная коррекция ЛАСИК - популярный метод...</...
    │       │    │     └ <__main__.Site object at 0x7f3195df6a00>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7f3195df6a00>
    └ <function Content at 0x7f31976fc940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7f31a8495670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:09 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8331), thread 'Thread-31' (139849554188032):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7f31976fcaf0>
    └ <__main__.Content object at 0x7f3195e6a040>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7f3195e6a040>
    │    └ ''
    └ <__main__.Content object at 0x7f3195e6a040>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195df61f0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195df61f0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-31, started 139849554188032)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195df61f0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f31a9479af0>
    └ <Thread(Thread-31, started 139849554188032)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f31a9479820>
    └ <Thread(Thread-31, started 139849554188032)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-31, started 139849554188032)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://doctor-shilova.ru/lasik/</url><title>Лазерная коррекция зрения LASIK в Москве - операция ...
    │    │        └ <Thread(Thread-31, started 139849554188032)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f31a8478670>>
    └ <Thread(Thread-31, started 139849554188032)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://doctor-shilova.ru/lasik/</url><title>Лазерная коррекция зрения LASIK в Москве - операция п...
    └ <function Site at 0x7f31976fe820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7f31976feca0>
    └ <__main__.Site object at 0x7f3195df6850>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://doctor-shilova.ru/lasik/</url><title>Лазерная коррекция зрения LASIK в Москве - операция п...
    │       │    │     └ <__main__.Site object at 0x7f3195df6850>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7f3195df6850>
    └ <function Content at 0x7f31976fc940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7f31a8495670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:09 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8331), thread 'Thread-17' (139850695038720):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7f31976fcaf0>
    └ <__main__.Content object at 0x7f3195de1a60>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7f3195de1a60>
    │    └ ''
    └ <__main__.Content object at 0x7f3195de1a60>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e37ee0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e37ee0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-17, started 139850695038720)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e37ee0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f31a9479af0>
    └ <Thread(Thread-17, started 139850695038720)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f31a9479820>
    └ <Thread(Thread-17, started 139850695038720)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-17, started 139850695038720)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://lasik.ru/services/lazernaya-korrektsiya-zreniya/korrektsiya-zreniya-lasik/</url><title>Ла...
    │    │        └ <Thread(Thread-17, started 139850695038720)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f31a8478670>>
    └ <Thread(Thread-17, started 139850695038720)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://lasik.ru/services/lazernaya-korrektsiya-zreniya/korrektsiya-zreniya-lasik/</url><title>Лаз...
    └ <function Site at 0x7f31976fe820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7f31976feca0>
    └ <__main__.Site object at 0x7f3195e40d30>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://lasik.ru/services/lazernaya-korrektsiya-zreniya/korrektsiya-zreniya-lasik/</url><title>Лаз...
    │       │    │     └ <__main__.Site object at 0x7f3195e40d30>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7f3195e40d30>
    └ <function Content at 0x7f31976fc940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7f31a8495670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:10 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8331), thread 'Thread-14' (139850926765824):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7f31976fcaf0>
    └ <__main__.Content object at 0x7f31a85215b0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7f31a85215b0>
    │    └ ''
    └ <__main__.Content object at 0x7f31a85215b0>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f31976e0280>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f31976e0280>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-14, started 139850926765824)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f31976e0280>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f31a9479af0>
    └ <Thread(Thread-14, started 139850926765824)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f31a9479820>
    └ <Thread(Thread-14, started 139850926765824)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-14, started 139850926765824)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.kp.ru/guide/lasik.html</url><title>Lasik ( Ласик ) — что такое, виды процедур, стоимо...
    │    │        └ <Thread(Thread-14, started 139850926765824)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f31a8478670>>
    └ <Thread(Thread-14, started 139850926765824)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.kp.ru/guide/lasik.html</url><title>Lasik ( Ласик ) — что такое, виды процедур, стоимос...
    └ <function Site at 0x7f31976fe820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7f31976feca0>
    └ <__main__.Site object at 0x7f3195e409a0>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://www.kp.ru/guide/lasik.html</url><title>Lasik ( Ласик ) — что такое, виды процедур, стоимос...
    │       │    │     └ <__main__.Site object at 0x7f3195e409a0>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7f3195e409a0>
    └ <function Content at 0x7f31976fc940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7f31a8495670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:09 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8331), thread 'Thread-12' (139850957993728):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7f31976fcaf0>
    └ <__main__.Content object at 0x7f31976be2e0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7f31976be2e0>
    │    └ ''
    └ <__main__.Content object at 0x7f31976be2e0>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195ea1c70>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195ea1c70>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-12, started 139850957993728)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195ea1c70>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f31a9479af0>
    └ <Thread(Thread-12, started 139850957993728)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f31a9479820>
    └ <Thread(Thread-12, started 139850957993728)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-12, started 139850957993728)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://ru.wikipedia.org/wiki/LASIK</url><title>LASIK — Википедия</title><breadcrumbs></breadcrum...
    │    │        └ <Thread(Thread-12, started 139850957993728)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f31a8478670>>
    └ <Thread(Thread-12, started 139850957993728)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://ru.wikipedia.org/wiki/LASIK</url><title>LASIK — Википедия</title><breadcrumbs></breadcrumb...
    └ <function Site at 0x7f31976fe820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7f31976feca0>
    └ <__main__.Site object at 0x7f3195e40910>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://ru.wikipedia.org/wiki/LASIK</url><title>LASIK — Википедия</title><breadcrumbs></breadcrumb...
    │       │    │     └ <__main__.Site object at 0x7f3195e40910>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7f3195e40910>
    └ <function Content at 0x7f31976fc940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7f31a8495670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:10 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8331), thread 'Thread-15' (139850711824128):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7f31976fcaf0>
    └ <__main__.Content object at 0x7f31a8478550>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7f31a8478550>
    │    └ ''
    └ <__main__.Content object at 0x7f31a8478550>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40070>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40070>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-15, started 139850711824128)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40070>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f31a9479af0>
    └ <Thread(Thread-15, started 139850711824128)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f31a9479820>
    └ <Thread(Thread-15, started 139850711824128)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-15, started 139850711824128)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://Korrektsiya-zreniya.ru/blog/lasik/</url><title>LASIK | Лазерная коррекция зрения методом ...
    │    │        └ <Thread(Thread-15, started 139850711824128)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f31a8478670>>
    └ <Thread(Thread-15, started 139850711824128)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://Korrektsiya-zreniya.ru/blog/lasik/</url><title>LASIK | Лазерная коррекция зрения методом Л...
    └ <function Site at 0x7f31976fe820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7f31976feca0>
    └ <__main__.Site object at 0x7f3195e408e0>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://Korrektsiya-zreniya.ru/blog/lasik/</url><title>LASIK | Лазерная коррекция зрения методом Л...
    │       │    │     └ <__main__.Site object at 0x7f3195e408e0>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7f3195e408e0>
    └ <function Content at 0x7f31976fc940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7f31a8495670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:09 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8331), thread 'Thread-23' (139850099451648):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7f31976fcaf0>
    └ <__main__.Content object at 0x7f3195de15e0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7f3195de15e0>
    │    └ ''
    └ <__main__.Content object at 0x7f3195de15e0>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40df0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40df0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-23, started 139850099451648)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f3195e40df0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f31a9479af0>
    └ <Thread(Thread-23, started 139850099451648)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f31a9479820>
    └ <Thread(Thread-23, started 139850099451648)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-23, started 139850099451648)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://eurooptic.ru/articles/vsye-o-lazernoy-korrektsii-zreniya-metodom-lasik/</url><title>Всё о...
    │    │        └ <Thread(Thread-23, started 139850099451648)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f31a8478670>>
    └ <Thread(Thread-23, started 139850099451648)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://eurooptic.ru/articles/vsye-o-lazernoy-korrektsii-zreniya-metodom-lasik/</url><title>Всё о ...
    └ <function Site at 0x7f31976fe820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7f31976feca0>
    └ <__main__.Site object at 0x7f3195e5ca90>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://eurooptic.ru/articles/vsye-o-lazernoy-korrektsii-zreniya-metodom-lasik/</url><title>Всё о ...
    │       │    │     └ <__main__.Site object at 0x7f3195e5ca90>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7f3195e5ca90>
    └ <function Content at 0x7f31976fc940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7f31a8495670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:23 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8392), thread 'Thread-20' (140555539437312):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7fd5c0ccbaf0>
    └ <__main__.Content object at 0x7fd5c0c8bbb0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7fd5c0c8bbb0>
    │    └ ''
    └ <__main__.Content object at 0x7fd5c0c8bbb0>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3fb940>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3fb940>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-20, started 140555539437312)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3fb940>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd5d2a49af0>
    └ <Thread(Thread-20, started 140555539437312)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fd5d2a49820>
    └ <Thread(Thread-20, started 140555539437312)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-20, started 140555539437312)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://fedorovmedcenter.ru/stati/oft-lazernaya-korrektsiya-zreniya/lazernaya-korrektsii-zreniya-...
    │    │        └ <Thread(Thread-20, started 140555539437312)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fd5d1a48610>>
    └ <Thread(Thread-20, started 140555539437312)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://fedorovmedcenter.ru/stati/oft-lazernaya-korrektsiya-zreniya/lazernaya-korrektsii-zreniya-l...
    └ <function Site at 0x7fd5c0ccc820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7fd5c0cccca0>
    └ <__main__.Site object at 0x7fd5bb3fbee0>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://fedorovmedcenter.ru/stati/oft-lazernaya-korrektsiya-zreniya/lazernaya-korrektsii-zreniya-l...
    │       │    │     └ <__main__.Site object at 0x7fd5bb3fbee0>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7fd5bb3fbee0>
    └ <function Content at 0x7fd5c0ccb940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7fd5d1a65670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:23 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8392), thread 'Thread-15' (140555919779584):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7fd5c0ccbaf0>
    └ <__main__.Content object at 0x7fd5bb352df0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7fd5bb352df0>
    │    └ ''
    └ <__main__.Content object at 0x7fd5bb352df0>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3f0eb0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3f0eb0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-15, started 140555919779584)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3f0eb0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd5d2a49af0>
    └ <Thread(Thread-15, started 140555919779584)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fd5d2a49820>
    └ <Thread(Thread-15, started 140555919779584)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-15, started 140555919779584)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://Korrektsiya-zreniya.ru/blog/lasik/</url><title>LASIK | Лазерная коррекция зрения методом ...
    │    │        └ <Thread(Thread-15, started 140555919779584)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fd5d1a48610>>
    └ <Thread(Thread-15, started 140555919779584)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://Korrektsiya-zreniya.ru/blog/lasik/</url><title>LASIK | Лазерная коррекция зрения методом Л...
    └ <function Site at 0x7fd5c0ccc820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7fd5c0cccca0>
    └ <__main__.Site object at 0x7fd5bb3fbdf0>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://Korrektsiya-zreniya.ru/blog/lasik/</url><title>LASIK | Лазерная коррекция зрения методом Л...
    │       │    │     └ <__main__.Site object at 0x7fd5bb3fbdf0>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7fd5bb3fbdf0>
    └ <function Content at 0x7fd5c0ccb940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7fd5d1a65670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:23 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8392), thread 'Thread-23' (140555514259200):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7fd5c0ccbaf0>
    └ <__main__.Content object at 0x7fd5bb3e0190>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7fd5bb3e0190>
    │    └ ''
    └ <__main__.Content object at 0x7fd5bb3e0190>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3fb7f0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3fb7f0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-23, started 140555514259200)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3fb7f0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd5d2a49af0>
    └ <Thread(Thread-23, started 140555514259200)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fd5d2a49820>
    └ <Thread(Thread-23, started 140555514259200)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-23, started 140555514259200)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://eurooptic.ru/articles/vsye-o-lazernoy-korrektsii-zreniya-metodom-lasik/</url><title>Всё о...
    │    │        └ <Thread(Thread-23, started 140555514259200)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fd5d1a48610>>
    └ <Thread(Thread-23, started 140555514259200)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://eurooptic.ru/articles/vsye-o-lazernoy-korrektsii-zreniya-metodom-lasik/</url><title>Всё о ...
    └ <function Site at 0x7fd5c0ccc820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7fd5c0cccca0>
    └ <__main__.Site object at 0x7fd5bb41b820>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://eurooptic.ru/articles/vsye-o-lazernoy-korrektsii-zreniya-metodom-lasik/</url><title>Всё о ...
    │       │    │     └ <__main__.Site object at 0x7fd5bb41b820>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7fd5bb41b820>
    └ <function Content at 0x7fd5c0ccb940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7fd5d1a65670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:23 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8392), thread 'Thread-12' (140555958875904):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7fd5c0ccbaf0>
    └ <__main__.Content object at 0x7fd5bb38ba90>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7fd5bb38ba90>
    │    └ ''
    └ <__main__.Content object at 0x7fd5bb38ba90>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb45ba30>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb45ba30>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-12, started 140555958875904)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb45ba30>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd5d2a49af0>
    └ <Thread(Thread-12, started 140555958875904)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fd5d2a49820>
    └ <Thread(Thread-12, started 140555958875904)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-12, started 140555958875904)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://ru.wikipedia.org/wiki/LASIK</url><title>LASIK — Википедия</title><breadcrumbs></breadcrum...
    │    │        └ <Thread(Thread-12, started 140555958875904)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fd5d1a48610>>
    └ <Thread(Thread-12, started 140555958875904)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://ru.wikipedia.org/wiki/LASIK</url><title>LASIK — Википедия</title><breadcrumbs></breadcrumb...
    └ <function Site at 0x7fd5c0ccc820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7fd5c0cccca0>
    └ <__main__.Site object at 0x7fd5bb3fbb80>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://ru.wikipedia.org/wiki/LASIK</url><title>LASIK — Википедия</title><breadcrumbs></breadcrumb...
    │       │    │     └ <__main__.Site object at 0x7fd5bb3fbb80>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7fd5bb3fbb80>
    └ <function Content at 0x7fd5c0ccb940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7fd5d1a65670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:23 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8392), thread 'Thread-13' (140555936564992):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7fd5c0ccbaf0>
    └ <__main__.Content object at 0x7fd5c0cf77f0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7fd5c0cf77f0>
    │    └ ''
    └ <__main__.Content object at 0x7fd5c0cf77f0>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5c0c8b3a0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5c0c8b3a0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-13, started 140555936564992)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5c0c8b3a0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd5d2a49af0>
    └ <Thread(Thread-13, started 140555936564992)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fd5d2a49820>
    └ <Thread(Thread-13, started 140555936564992)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-13, started 140555936564992)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.ochkov.net/wiki/lazernaya-korrekciya-zreniya-kak-prohodit-operaciya-lasik.htm</url><t...
    │    │        └ <Thread(Thread-13, started 140555936564992)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fd5d1a48610>>
    └ <Thread(Thread-13, started 140555936564992)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.ochkov.net/wiki/lazernaya-korrekciya-zreniya-kak-prohodit-operaciya-lasik.htm</url><ti...
    └ <function Site at 0x7fd5c0ccc820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7fd5c0cccca0>
    └ <__main__.Site object at 0x7fd5bb3fbd00>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://www.ochkov.net/wiki/lazernaya-korrekciya-zreniya-kak-prohodit-operaciya-lasik.htm</url><ti...
    │       │    │     └ <__main__.Site object at 0x7fd5bb3fbd00>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7fd5bb3fbd00>
    └ <function Content at 0x7fd5c0ccb940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7fd5d1a65670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:23 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8392), thread 'Thread-26' (140554943850240):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7fd5c0ccbaf0>
    └ <__main__.Content object at 0x7fd5d1a48430>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7fd5d1a48430>
    │    └ ''
    └ <__main__.Content object at 0x7fd5d1a48430>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3fbe50>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3fbe50>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-26, started 140554943850240)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3fbe50>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd5d2a49af0>
    └ <Thread(Thread-26, started 140554943850240)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fd5d2a49820>
    └ <Thread(Thread-26, started 140554943850240)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-26, started 140554943850240)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://mgkl.ru/uslugi/metodika-lasik</url><title>Лазерная коррекция зрения по методике ЛАСИК ( L...
    │    │        └ <Thread(Thread-26, started 140554943850240)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fd5d1a48610>>
    └ <Thread(Thread-26, started 140554943850240)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://mgkl.ru/uslugi/metodika-lasik</url><title>Лазерная коррекция зрения по методике ЛАСИК ( LA...
    └ <function Site at 0x7fd5c0ccc820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7fd5c0cccca0>
    └ <__main__.Site object at 0x7fd5bb36c8e0>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://mgkl.ru/uslugi/metodika-lasik</url><title>Лазерная коррекция зрения по методике ЛАСИК ( LA...
    │       │    │     └ <__main__.Site object at 0x7fd5bb36c8e0>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7fd5bb36c8e0>
    └ <function Content at 0x7fd5c0ccb940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7fd5d1a65670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:23 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8392), thread 'Thread-16' (140555911386880):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7fd5c0ccbaf0>
    └ <__main__.Content object at 0x7fd5c0ca0ee0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7fd5c0ca0ee0>
    │    └ ''
    └ <__main__.Content object at 0x7fd5c0ca0ee0>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3f0e80>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3f0e80>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-16, started 140555911386880)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3f0e80>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd5d2a49af0>
    └ <Thread(Thread-16, started 140555911386880)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fd5d2a49820>
    └ <Thread(Thread-16, started 140555911386880)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-16, started 140555911386880)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.vseozrenii.ru/lazernaya-korrekciya-zreniya/lasik/</url><title>ЛАСИК ( LASIK ) метод л...
    │    │        └ <Thread(Thread-16, started 140555911386880)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fd5d1a48610>>
    └ <Thread(Thread-16, started 140555911386880)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.vseozrenii.ru/lazernaya-korrekciya-zreniya/lasik/</url><title>ЛАСИК ( LASIK ) метод ла...
    └ <function Site at 0x7fd5c0ccc820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7fd5c0cccca0>
    └ <__main__.Site object at 0x7fd5bb3fbd30>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://www.vseozrenii.ru/lazernaya-korrekciya-zreniya/lasik/</url><title>ЛАСИК ( LASIK ) метод ла...
    │       │    │     └ <__main__.Site object at 0x7fd5bb3fbd30>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7fd5bb3fbd30>
    └ <function Content at 0x7fd5c0ccb940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7fd5d1a65670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:23 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8392), thread 'Thread-21' (140555531044608):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7fd5c0ccbaf0>
    └ <__main__.Content object at 0x7fd5c0ca0340>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7fd5c0ca0340>
    │    └ ''
    └ <__main__.Content object at 0x7fd5c0ca0340>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3fb190>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3fb190>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-21, started 140555531044608)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3fb190>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd5d2a49af0>
    └ <Thread(Thread-21, started 140555531044608)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fd5d2a49820>
    └ <Thread(Thread-21, started 140555531044608)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-21, started 140555531044608)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://100med.ru/directions/oftalmologiya/lazernaya-korrektsiya-zreniya-pri-pomoshchi-lasik-lasi...
    │    │        └ <Thread(Thread-21, started 140555531044608)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fd5d1a48610>>
    └ <Thread(Thread-21, started 140555531044608)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://100med.ru/directions/oftalmologiya/lazernaya-korrektsiya-zreniya-pri-pomoshchi-lasik-lasik...
    └ <function Site at 0x7fd5c0ccc820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7fd5c0cccca0>
    └ <__main__.Site object at 0x7fd5bb3fbc10>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://100med.ru/directions/oftalmologiya/lazernaya-korrektsiya-zreniya-pri-pomoshchi-lasik-lasik...
    │       │    │     └ <__main__.Site object at 0x7fd5bb3fbc10>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7fd5bb3fbc10>
    └ <function Content at 0x7fd5c0ccb940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7fd5d1a65670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:23 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8392), thread 'Thread-29' (140554918672128):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7fd5c0ccbaf0>
    └ <__main__.Content object at 0x7fd5bb38b7c0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7fd5bb38b7c0>
    │    └ ''
    └ <__main__.Content object at 0x7fd5bb38b7c0>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb36cdf0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb36cdf0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-29, started 140554918672128)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb36cdf0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd5d2a49af0>
    └ <Thread(Thread-29, started 140554918672128)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fd5d2a49820>
    └ <Thread(Thread-29, started 140554918672128)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-29, started 140554918672128)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://smileeyes.ru/operacija-lasik/</url><title>Лазерная коррекция ЛАСИК - популярный метод...<...
    │    │        └ <Thread(Thread-29, started 140554918672128)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fd5d1a48610>>
    └ <Thread(Thread-29, started 140554918672128)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://smileeyes.ru/operacija-lasik/</url><title>Лазерная коррекция ЛАСИК - популярный метод...</...
    └ <function Site at 0x7fd5c0ccc820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7fd5c0cccca0>
    └ <__main__.Site object at 0x7fd5bb373f40>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://smileeyes.ru/operacija-lasik/</url><title>Лазерная коррекция ЛАСИК - популярный метод...</...
    │       │    │     └ <__main__.Site object at 0x7fd5bb373f40>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7fd5bb373f40>
    └ <function Content at 0x7fd5c0ccb940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7fd5d1a65670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:23 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8392), thread 'Thread-19' (140555547830016):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7fd5c0ccbaf0>
    └ <__main__.Content object at 0x7fd5bb38bcd0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7fd5bb38bcd0>
    │    └ ''
    └ <__main__.Content object at 0x7fd5bb38bcd0>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3f0df0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3f0df0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-19, started 140555547830016)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3f0df0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd5d2a49af0>
    └ <Thread(Thread-19, started 140555547830016)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fd5d2a49820>
    └ <Thread(Thread-19, started 140555547830016)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-19, started 140555547830016)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://excimerclinic.ru/laser-correction/lasik/</url><title>Лазерная коррекция зрения с помощью ...
    │    │        └ <Thread(Thread-19, started 140555547830016)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fd5d1a48610>>
    └ <Thread(Thread-19, started 140555547830016)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://excimerclinic.ru/laser-correction/lasik/</url><title>Лазерная коррекция зрения с помощью о...
    └ <function Site at 0x7fd5c0ccc820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7fd5c0cccca0>
    └ <__main__.Site object at 0x7fd5bb3fbf10>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://excimerclinic.ru/laser-correction/lasik/</url><title>Лазерная коррекция зрения с помощью о...
    │       │    │     └ <__main__.Site object at 0x7fd5bb3fbf10>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7fd5bb3fbf10>
    └ <function Content at 0x7fd5c0ccb940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7fd5d1a65670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:23 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8392), thread 'Thread-14' (140555928172288):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7fd5c0ccbaf0>
    └ <__main__.Content object at 0x7fd5bb41bee0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7fd5bb41bee0>
    │    └ ''
    └ <__main__.Content object at 0x7fd5bb41bee0>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3f0af0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3f0af0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-14, started 140555928172288)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3f0af0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd5d2a49af0>
    └ <Thread(Thread-14, started 140555928172288)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fd5d2a49820>
    └ <Thread(Thread-14, started 140555928172288)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-14, started 140555928172288)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.kp.ru/guide/lasik.html</url><title>Lasik ( Ласик ) — что такое, виды процедур, стоимо...
    │    │        └ <Thread(Thread-14, started 140555928172288)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fd5d1a48610>>
    └ <Thread(Thread-14, started 140555928172288)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.kp.ru/guide/lasik.html</url><title>Lasik ( Ласик ) — что такое, виды процедур, стоимос...
    └ <function Site at 0x7fd5c0ccc820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7fd5c0cccca0>
    └ <__main__.Site object at 0x7fd5bb3fb520>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://www.kp.ru/guide/lasik.html</url><title>Lasik ( Ласик ) — что такое, виды процедур, стоимос...
    │       │    │     └ <__main__.Site object at 0x7fd5bb3fb520>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7fd5bb3fb520>
    └ <function Content at 0x7fd5c0ccb940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7fd5d1a65670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:23 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8392), thread 'Thread-24' (140555505866496):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7fd5c0ccbaf0>
    └ <__main__.Content object at 0x7fd5bb38b940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7fd5bb38b940>
    │    └ ''
    └ <__main__.Content object at 0x7fd5bb38b940>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3fb430>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3fb430>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-24, started 140555505866496)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3fb430>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd5d2a49af0>
    └ <Thread(Thread-24, started 140555505866496)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fd5d2a49820>
    └ <Thread(Thread-24, started 140555505866496)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-24, started 140555505866496)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://ophthalmocenter.ru/lazernaya-korrekciya-zreniya/lazernaya-korrekciya-zreniya-lasic.html</...
    │    │        └ <Thread(Thread-24, started 140555505866496)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fd5d1a48610>>
    └ <Thread(Thread-24, started 140555505866496)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://ophthalmocenter.ru/lazernaya-korrekciya-zreniya/lazernaya-korrekciya-zreniya-lasic.html</u...
    └ <function Site at 0x7fd5c0ccc820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7fd5c0cccca0>
    └ <__main__.Site object at 0x7fd5bb3c3520>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://ophthalmocenter.ru/lazernaya-korrekciya-zreniya/lazernaya-korrekciya-zreniya-lasic.html</u...
    │       │    │     └ <__main__.Site object at 0x7fd5bb3c3520>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7fd5bb3c3520>
    └ <function Content at 0x7fd5c0ccb940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7fd5d1a65670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:23 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8392), thread 'Thread-27' (140554935457536):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7fd5c0ccbaf0>
    └ <__main__.Content object at 0x7fd5d1a48400>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7fd5d1a48400>
    │    └ ''
    └ <__main__.Content object at 0x7fd5d1a48400>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3c3f40>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3c3f40>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-27, started 140554935457536)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3c3f40>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd5d2a49af0>
    └ <Thread(Thread-27, started 140554935457536)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fd5d2a49820>
    └ <Thread(Thread-27, started 140554935457536)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-27, started 140554935457536)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://prozrenie-tat.ru/_o_lazernoy_korrekcii_zreniya_LASIK_</url><title>О лазерной коррекции зр...
    │    │        └ <Thread(Thread-27, started 140554935457536)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fd5d1a48610>>
    └ <Thread(Thread-27, started 140554935457536)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://prozrenie-tat.ru/_o_lazernoy_korrekcii_zreniya_LASIK_</url><title>О лазерной коррекции зре...
    └ <function Site at 0x7fd5c0ccc820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7fd5c0cccca0>
    └ <__main__.Site object at 0x7fd5bb36cf70>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://prozrenie-tat.ru/_o_lazernoy_korrekcii_zreniya_LASIK_</url><title>О лазерной коррекции зре...
    │       │    │     └ <__main__.Site object at 0x7fd5bb36cf70>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7fd5bb36cf70>
    └ <function Content at 0x7fd5c0ccb940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7fd5d1a65670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:23 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8392), thread 'Thread-28' (140554927064832):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7fd5c0ccbaf0>
    └ <__main__.Content object at 0x7fd5bb41b9d0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7fd5bb41b9d0>
    │    └ ''
    └ <__main__.Content object at 0x7fd5bb41b9d0>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb36cdc0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb36cdc0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-28, started 140554927064832)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb36cdc0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd5d2a49af0>
    └ <Thread(Thread-28, started 140554927064832)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fd5d2a49820>
    └ <Thread(Thread-28, started 140554927064832)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-28, started 140554927064832)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.cvz.ru/laser-correction/metody/lasik/</url><title>ЛАСИК ( LASIK ) — методика лазерной...
    │    │        └ <Thread(Thread-28, started 140554927064832)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fd5d1a48610>>
    └ <Thread(Thread-28, started 140554927064832)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.cvz.ru/laser-correction/metody/lasik/</url><title>ЛАСИК ( LASIK ) — методика лазерной ...
    └ <function Site at 0x7fd5c0ccc820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7fd5c0cccca0>
    └ <__main__.Site object at 0x7fd5bb373ac0>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://www.cvz.ru/laser-correction/metody/lasik/</url><title>ЛАСИК ( LASIK ) — методика лазерной ...
    │       │    │     └ <__main__.Site object at 0x7fd5bb373ac0>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7fd5bb373ac0>
    └ <function Content at 0x7fd5c0ccb940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7fd5d1a65670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:23 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8392), thread 'Thread-22' (140555522651904):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7fd5c0ccbaf0>
    └ <__main__.Content object at 0x7fd5bb38b820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7fd5bb38b820>
    │    └ ''
    └ <__main__.Content object at 0x7fd5bb38b820>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3fb9d0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3fb9d0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-22, started 140555522651904)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3fb9d0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd5d2a49af0>
    └ <Thread(Thread-22, started 140555522651904)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fd5d2a49820>
    └ <Thread(Thread-22, started 140555522651904)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-22, started 140555522651904)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://eyesurgerycenter.ru/lazernaya-korrekciya-zreniya/lasik.html</url><title>Операция Ласик (С...
    │    │        └ <Thread(Thread-22, started 140555522651904)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fd5d1a48610>>
    └ <Thread(Thread-22, started 140555522651904)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://eyesurgerycenter.ru/lazernaya-korrekciya-zreniya/lasik.html</url><title>Операция Ласик (Су...
    └ <function Site at 0x7fd5c0ccc820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7fd5c0cccca0>
    └ <__main__.Site object at 0x7fd5bb41b640>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://eyesurgerycenter.ru/lazernaya-korrekciya-zreniya/lasik.html</url><title>Операция Ласик (Су...
    │       │    │     └ <__main__.Site object at 0x7fd5bb41b640>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7fd5bb41b640>
    └ <function Content at 0x7fd5c0ccb940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7fd5d1a65670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:23 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8392), thread 'Thread-25' (140554952242944):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7fd5c0ccbaf0>
    └ <__main__.Content object at 0x7fd5bb3d7d30>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7fd5bb3d7d30>
    │    └ ''
    └ <__main__.Content object at 0x7fd5bb3d7d30>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb41b6a0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb41b6a0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-25, started 140554952242944)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb41b6a0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd5d2a49af0>
    └ <Thread(Thread-25, started 140554952242944)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fd5d2a49820>
    └ <Thread(Thread-25, started 140554952242944)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-25, started 140554952242944)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://realeyes.ru/metod/lasik/</url><title>Лазерная коррекция зрения LASIK : цена, отзывы, как....
    │    │        └ <Thread(Thread-25, started 140554952242944)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fd5d1a48610>>
    └ <Thread(Thread-25, started 140554952242944)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://realeyes.ru/metod/lasik/</url><title>Лазерная коррекция зрения LASIK : цена, отзывы, как.....
    └ <function Site at 0x7fd5c0ccc820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7fd5c0cccca0>
    └ <__main__.Site object at 0x7fd5bb3e0f70>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://realeyes.ru/metod/lasik/</url><title>Лазерная коррекция зрения LASIK : цена, отзывы, как.....
    │       │    │     └ <__main__.Site object at 0x7fd5bb3e0f70>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7fd5bb3e0f70>
    └ <function Content at 0x7fd5c0ccb940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7fd5d1a65670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:23 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8392), thread 'Thread-17' (140555902994176):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7fd5c0ccbaf0>
    └ <__main__.Content object at 0x7fd5bb7d7d60>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7fd5bb7d7d60>
    │    └ ''
    └ <__main__.Content object at 0x7fd5bb7d7d60>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3fb550>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3fb550>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-17, started 140555902994176)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3fb550>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd5d2a49af0>
    └ <Thread(Thread-17, started 140555902994176)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fd5d2a49820>
    └ <Thread(Thread-17, started 140555902994176)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-17, started 140555902994176)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://lasik.ru/services/lazernaya-korrektsiya-zreniya/korrektsiya-zreniya-lasik/</url><title>Ла...
    │    │        └ <Thread(Thread-17, started 140555902994176)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fd5d1a48610>>
    └ <Thread(Thread-17, started 140555902994176)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://lasik.ru/services/lazernaya-korrektsiya-zreniya/korrektsiya-zreniya-lasik/</url><title>Лаз...
    └ <function Site at 0x7fd5c0ccc820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7fd5c0cccca0>
    └ <__main__.Site object at 0x7fd5bb3f0dc0>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://lasik.ru/services/lazernaya-korrektsiya-zreniya/korrektsiya-zreniya-lasik/</url><title>Лаз...
    │       │    │     └ <__main__.Site object at 0x7fd5bb3f0dc0>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7fd5bb3f0dc0>
    └ <function Content at 0x7fd5c0ccb940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7fd5d1a65670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:23 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8392), thread 'Thread-18' (140555556222720):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7fd5c0ccbaf0>
    └ <__main__.Content object at 0x7fd5bb38b880>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7fd5bb38b880>
    │    └ ''
    └ <__main__.Content object at 0x7fd5bb38b880>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3f0fa0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3f0fa0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-18, started 140555556222720)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb3f0fa0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd5d2a49af0>
    └ <Thread(Thread-18, started 140555556222720)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fd5d2a49820>
    └ <Thread(Thread-18, started 140555556222720)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-18, started 140555556222720)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://elitplus-clinic.ru/stati/lazernaya-korrekcziya-zreniya-lasik.html</url><title>Лазерная ко...
    │    │        └ <Thread(Thread-18, started 140555556222720)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fd5d1a48610>>
    └ <Thread(Thread-18, started 140555556222720)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://elitplus-clinic.ru/stati/lazernaya-korrekcziya-zreniya-lasik.html</url><title>Лазерная кор...
    └ <function Site at 0x7fd5c0ccc820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7fd5c0cccca0>
    └ <__main__.Site object at 0x7fd5bb3fbc40>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://elitplus-clinic.ru/stati/lazernaya-korrekcziya-zreniya-lasik.html</url><title>Лазерная кор...
    │       │    │     └ <__main__.Site object at 0x7fd5bb3fbc40>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7fd5bb3fbc40>
    └ <function Content at 0x7fd5c0ccb940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7fd5d1a65670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:31 An error has been caught in function 'add_content_data_to_dataset', process 'Process-1' (8392), thread 'Thread-30' (140554910279424):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 571, in __init__
    self.get_text()
    │    └ <function Content.get_text at 0x7fd5c0ccbaf0>
    └ <__main__.Content object at 0x7fd5bb41b070>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 590, in get_text
    self.text = self.html.text.replace('\n', '')
    │    │      │    └ ''
    │    │      └ <__main__.Content object at 0x7fd5bb41b070>
    │    └ ''
    └ <__main__.Content object at 0x7fd5bb41b070>

AttributeError: 'str' object has no attribute 'text'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb36cd60>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb36cd60>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-30, started 140554910279424)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7fd5bb36cd60>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fd5d2a49af0>
    └ <Thread(Thread-30, started 140554910279424)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fd5d2a49820>
    └ <Thread(Thread-30, started 140554910279424)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-30, started 140554910279424)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекц...
    │    │        └ <Thread(Thread-30, started 140554910279424)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7fd5d1a48610>>
    └ <Thread(Thread-30, started 140554910279424)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекци...
    └ <function Site at 0x7fd5c0ccc820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 174, in __init__
    self.add_content_data_to_dataset()
    │    └ <function Site.add_content_data_to_dataset at 0x7fd5c0cccca0>
    └ <__main__.Site object at 0x7fd5bb382b50>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 251, in add_content_data_to_dataset
    Content(self.html, self.site_dataset)
    │       │    │     │    └ SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекци...
    │       │    │     └ <__main__.Site object at 0x7fd5bb382b50>
    │       │    └ ''
    │       └ <__main__.Site object at 0x7fd5bb382b50>
    └ <function Content at 0x7fd5c0ccb940>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 576, in __init__
    logger.critical(f"Проблема с валидностью контента {self.domain}. ")
    │      └ <function Logger.critical at 0x7fd5d1a65670>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Content' object has no attribute 'domain'
12:41:31 An error has been caught in function 'make_concurency_object', process 'Process-1' (8392), thread 'MainThread' (140556347172672):
Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2131, in <module>
    main()
    └ <function main at 0x7fd5d1bd04c0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2122, in main
    globals = debugger.run(setup['file'], None, None, is_module)
              │        │   │                          └ False
              │        │   └ {'port': 37635, 'vm_type': None, 'client': '127.0.0.1', 'server': False, 'DEBUG_RECORD_SOCKET_READS': False, 'multiproc': Tru...
              │        └ <function PyDB.run at 0x7fd5d1bcc4c0>
              └ <__main__.PyDB object at 0x7fd5d23d0ee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1431, in run
    return self._exec(is_module, entry_point_fn, module_name, file, globals, locals)
           │    │     │          │               │            │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
           │    │     │          │               └ None
           │    │     │          └ ''
           │    │     └ False
           │    └ <function PyDB._exec at 0x7fd5d1bcc550>
           └ <__main__.PyDB object at 0x7fd5d23d0ee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1438, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
    │             │        │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
    │             └ <function execfile at 0x7fd5d2a86280>
    └ <module '_pydev_bundle.pydev_imports' from '/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/...

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
                 │              │              │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              │              └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
                 └ 'from microservices.conc_settings import *\nfrom multiprocessing import Process, Queue\nfrom threading import Thread\nfrom lo...

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 891, in <module>
    Manager()
    └ <function Manager at 0x7fd5d1a321f0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 52, in __init__
    self.run_processes()
    │    └ <function Manager.run_processes at 0x7fd5c0ccc040>
    └ <__main__.Manager object at 0x7fd5c0da9f40>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 89, in run_processes
    self.start_processes()
    │    └ <function Manager.start_processes at 0x7fd5c0ccc160>
    └ <__main__.Manager object at 0x7fd5c0da9f40>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 97, in start_processes
    process.start()
    │       └ <function BaseProcess.start at 0x7fd5d1a4c160>
    └ <Process name='Process-1' parent=8387 started>

  File "/usr/lib/python3.8/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
    │    │        │    │      └ <Process name='Process-1' parent=8387 started>
    │    │        │    └ <staticmethod object at 0x7fd5d1a40850>
    │    │        └ <Process name='Process-1' parent=8387 started>
    │    └ None
    └ <Process name='Process-1' parent=8387 started>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
           │                │                            └ <Process name='Process-1' parent=8387 started>
           │                └ <function DefaultContext.get_context at 0x7fd5d1a58b80>
           └ <multiprocessing.context.DefaultContext object at 0x7fd5d1a48c70>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
           │     └ <Process name='Process-1' parent=8387 started>
           └ <class 'multiprocessing.popen_fork.Popen'>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
    │    │       └ <Process name='Process-1' parent=8387 started>
    │    └ <function Popen._launch at 0x7fd5c0c7b9d0>
    └ <multiprocessing.popen_fork.Popen object at 0x7fd5c0cf7430>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 75, in _launch
    code = process_obj._bootstrap(parent_sentinel=child_r)
           │           │                          └ 9
           │           └ <function BaseProcess._bootstrap at 0x7fd5d1a4ca60>
           └ <Process name='Process-1' parent=8387 started>
  File "/usr/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7fd5d1a4c0d0>
    └ <Process name='Process-1' parent=8387 started>
  File "/usr/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Process name='Process-1' parent=8387 started>
    │    │        │    └ (RequestDataSet(id=44, text='lasik', xml='<?xml version="1.0" encoding="UTF-8" ?>\n<yandexsearch version="1.0">\n  <response ...
    │    │        └ <Process name='Process-1' parent=8387 started>
    │    └ <function Yandex at 0x7fd5c0cccf70>
    └ <Process name='Process-1' parent=8387 started>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 279, in __init__
    self.make_concurency_object()
    │    └ <function Yandex.make_concurency_object at 0x7fd5c0cc8820>
    └ <__main__.Yandex object at 0x7fd5d1a48610>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 370, in make_concurency_object
    self.concurency_object = Concurency(self.site_list, self.stemmed_request)
    │    │                   │          │    │          │    └ ['lasik']
    │    │                   │          │    │          └ <__main__.Yandex object at 0x7fd5d1a48610>
    │    │                   │          │    └ [SiteDataSet(html=<doc><url>https://ru.wikipedia.org/wiki/LASIK</url><title>LASIK — Википедия</title><breadcrumbs></breadcrum...
    │    │                   │          └ <__main__.Yandex object at 0x7fd5d1a48610>
    │    │                   └ <function Concurency at 0x7fd5c0ccbf70>
    │    └ <object object at 0x7fd5c0c813c0>
    └ <__main__.Yandex object at 0x7fd5d1a48610>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 633, in __init__
    self.calculate_site_stem_concurency()
    │    └ <function Concurency.calculate_site_stem_concurency at 0x7fd5c0cce430>
    └ <__main__.Concurency object at 0x7fd5bb38baf0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 744, in calculate_site_stem_concurency
    matched_stem_items_amount = self.count_matched_stem_items(site_dataset.stemmed_title)
                                │    │                        └ SiteDataSet(html=<doc><url>https://ru.wikipedia.org/wiki/LASIK</url><title>LASIK — Википедия</title><breadcrumbs></breadcrumb...
                                │    └ <function Concurency.count_matched_stem_items at 0x7fd5c0cce4c0>
                                └ <__main__.Concurency object at 0x7fd5bb38baf0>

AttributeError: 'SiteDataSet' object has no attribute 'stemmed_title'
12:41:31 An error has been caught in function 'run', process 'Process-1' (8392), thread 'MainThread' (140556347172672):
Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2131, in <module>
    main()
    └ <function main at 0x7fd5d1bd04c0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2122, in main
    globals = debugger.run(setup['file'], None, None, is_module)
              │        │   │                          └ False
              │        │   └ {'port': 37635, 'vm_type': None, 'client': '127.0.0.1', 'server': False, 'DEBUG_RECORD_SOCKET_READS': False, 'multiproc': Tru...
              │        └ <function PyDB.run at 0x7fd5d1bcc4c0>
              └ <__main__.PyDB object at 0x7fd5d23d0ee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1431, in run
    return self._exec(is_module, entry_point_fn, module_name, file, globals, locals)
           │    │     │          │               │            │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
           │    │     │          │               └ None
           │    │     │          └ ''
           │    │     └ False
           │    └ <function PyDB._exec at 0x7fd5d1bcc550>
           └ <__main__.PyDB object at 0x7fd5d23d0ee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1438, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
    │             │        │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
    │             └ <function execfile at 0x7fd5d2a86280>
    └ <module '_pydev_bundle.pydev_imports' from '/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/...

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
                 │              │              │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              │              └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
                 └ 'from microservices.conc_settings import *\nfrom multiprocessing import Process, Queue\nfrom threading import Thread\nfrom lo...

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 891, in <module>
    Manager()
    └ <function Manager at 0x7fd5d1a321f0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 52, in __init__
    self.run_processes()
    │    └ <function Manager.run_processes at 0x7fd5c0ccc040>
    └ <__main__.Manager object at 0x7fd5c0da9f40>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 89, in run_processes
    self.start_processes()
    │    └ <function Manager.start_processes at 0x7fd5c0ccc160>
    └ <__main__.Manager object at 0x7fd5c0da9f40>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 97, in start_processes
    process.start()
    │       └ <function BaseProcess.start at 0x7fd5d1a4c160>
    └ <Process name='Process-1' parent=8387 started>

  File "/usr/lib/python3.8/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
    │    │        │    │      └ <Process name='Process-1' parent=8387 started>
    │    │        │    └ <staticmethod object at 0x7fd5d1a40850>
    │    │        └ <Process name='Process-1' parent=8387 started>
    │    └ None
    └ <Process name='Process-1' parent=8387 started>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
           │                │                            └ <Process name='Process-1' parent=8387 started>
           │                └ <function DefaultContext.get_context at 0x7fd5d1a58b80>
           └ <multiprocessing.context.DefaultContext object at 0x7fd5d1a48c70>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
           │     └ <Process name='Process-1' parent=8387 started>
           └ <class 'multiprocessing.popen_fork.Popen'>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
    │    │       └ <Process name='Process-1' parent=8387 started>
    │    └ <function Popen._launch at 0x7fd5c0c7b9d0>
    └ <multiprocessing.popen_fork.Popen object at 0x7fd5c0cf7430>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 75, in _launch
    code = process_obj._bootstrap(parent_sentinel=child_r)
           │           │                          └ 9
           │           └ <function BaseProcess._bootstrap at 0x7fd5d1a4ca60>
           └ <Process name='Process-1' parent=8387 started>
  File "/usr/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7fd5d1a4c0d0>
    └ <Process name='Process-1' parent=8387 started>
> File "/usr/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Process name='Process-1' parent=8387 started>
    │    │        │    └ (RequestDataSet(id=44, text='lasik', xml='<?xml version="1.0" encoding="UTF-8" ?>\n<yandexsearch version="1.0">\n  <response ...
    │    │        └ <Process name='Process-1' parent=8387 started>
    │    └ <function Yandex at 0x7fd5c0cccf70>
    └ <Process name='Process-1' parent=8387 started>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 280, in __init__
    self.prepare_result()
    │    └ <function Yandex.prepare_result at 0x7fd5c0cc88b0>
    └ <__main__.Yandex object at 0x7fd5d1a48610>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 374, in prepare_result
    'Запрос': self.request,
              └ <__main__.Yandex object at 0x7fd5d1a48610>

AttributeError: 'Yandex' object has no attribute 'request'
12:43:40 Проблема с валидностью контента nlv.ru. 
12:43:52 Проблема с валидностью контента Korrektsiya-zreniya.ru. 
12:43:53 Проблема с валидностью контента vseozrenii.ru. 
12:43:53 Проблема с валидностью контента ophthalmocenter.ru. 
12:43:53 Проблема с валидностью контента elitplus-clinic.ru. 
12:43:53 Проблема с валидностью контента prozrenie-tat.ru. 
12:43:54 Проблема с валидностью контента eyesurgerycenter.ru. 
12:43:54 Проблема с валидностью контента fedorovmedcenter.ru. 
12:43:54 Проблема с валидностью контента mgkl.ru. 
12:43:56 Проблема с валидностью контента eurooptic.ru. 
12:54:13 An error has been caught in function 'make_concurency_object', process 'Process-1' (9446), thread 'MainThread' (140309268023104):
Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2131, in <module>
    main()
    └ <function main at 0x7f9c4aac54c0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2122, in main
    globals = debugger.run(setup['file'], None, None, is_module)
              │        │   │                          └ False
              │        │   └ {'port': 33707, 'vm_type': None, 'client': '127.0.0.1', 'server': False, 'DEBUG_RECORD_SOCKET_READS': False, 'multiproc': Tru...
              │        └ <function PyDB.run at 0x7f9c4aac44c0>
              └ <__main__.PyDB object at 0x7f9c4b2c6ee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1431, in run
    return self._exec(is_module, entry_point_fn, module_name, file, globals, locals)
           │    │     │          │               │            │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
           │    │     │          │               └ None
           │    │     │          └ ''
           │    │     └ False
           │    └ <function PyDB._exec at 0x7f9c4aac4550>
           └ <__main__.PyDB object at 0x7f9c4b2c6ee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1438, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
    │             │        │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
    │             └ <function execfile at 0x7f9c4b97c280>
    └ <module '_pydev_bundle.pydev_imports' from '/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/...

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
                 │              │              │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              │              └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
                 └ 'from microservices.conc_settings import *\nfrom multiprocessing import Process, Queue\nfrom threading import Thread\nfrom lo...

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 891, in <module>
    Manager()
    └ <function Manager at 0x7f9c4a92a160>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 52, in __init__
    self.run_processes()
    │    └ <function Manager.run_processes at 0x7f9c48099f70>
    └ <__main__.Manager object at 0x7f9c4810da30>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 89, in run_processes
    self.start_processes()
    │    └ <function Manager.start_processes at 0x7f9c480310d0>
    └ <__main__.Manager object at 0x7f9c4810da30>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 97, in start_processes
    process.start()
    │       └ <function BaseProcess.start at 0x7f9c4a9450d0>
    └ <Process name='Process-1' parent=9441 started>

  File "/usr/lib/python3.8/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
    │    │        │    │      └ <Process name='Process-1' parent=9441 started>
    │    │        │    └ <staticmethod object at 0x7f9c4a939850>
    │    │        └ <Process name='Process-1' parent=9441 started>
    │    └ None
    └ <Process name='Process-1' parent=9441 started>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
           │                │                            └ <Process name='Process-1' parent=9441 started>
           │                └ <function DefaultContext.get_context at 0x7f9c4a951af0>
           └ <multiprocessing.context.DefaultContext object at 0x7f9c4a941c70>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
           │     └ <Process name='Process-1' parent=9441 started>
           └ <class 'multiprocessing.popen_fork.Popen'>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
    │    │       └ <Process name='Process-1' parent=9441 started>
    │    └ <function Popen._launch at 0x7f9c39b73940>
    └ <multiprocessing.popen_fork.Popen object at 0x7f9c48050e80>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 75, in _launch
    code = process_obj._bootstrap(parent_sentinel=child_r)
           │           │                          └ 9
           │           └ <function BaseProcess._bootstrap at 0x7f9c4a9459d0>
           └ <Process name='Process-1' parent=9441 started>
  File "/usr/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7f9c4a945040>
    └ <Process name='Process-1' parent=9441 started>
  File "/usr/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Process name='Process-1' parent=9441 started>
    │    │        │    └ (RequestDataSet(id=44, text='lasik', xml='<?xml version="1.0" encoding="UTF-8" ?>\n<yandexsearch version="1.0">\n  <response ...
    │    │        └ <Process name='Process-1' parent=9441 started>
    │    └ <function Yandex at 0x7f9c48031ee0>
    └ <Process name='Process-1' parent=9441 started>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 279, in __init__
    self.make_concurency_object()
    │    └ <function Yandex.make_concurency_object at 0x7f9c48029790>
    └ <__main__.Yandex object at 0x7f9c4a941610>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 370, in make_concurency_object
    self.concurency_object = Concurency(self.site_list, self.stemmed_request)
    │    │                   │          │    │          │    └ ['lasik']
    │    │                   │          │    │          └ <__main__.Yandex object at 0x7f9c4a941610>
    │    │                   │          │    └ [SiteDataSet(html=<doc><url>https://ru.wikipedia.org/wiki/LASIK</url><title>LASIK — Википедия</title><breadcrumbs></breadcrum...
    │    │                   │          └ <__main__.Yandex object at 0x7f9c4a941610>
    │    │                   └ <function Concurency at 0x7f9c48028ee0>
    │    └ <object object at 0x7f9c39b793c0>
    └ <__main__.Yandex object at 0x7f9c4a941610>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 633, in __init__
    self.calculate_site_stem_concurency()
    │    └ <function Concurency.calculate_site_stem_concurency at 0x7f9c4802e3a0>
    └ <__main__.Concurency object at 0x7f9c38311910>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 744, in calculate_site_stem_concurency
    matched_stem_items_amount = self.count_matched_stem_items(site_dataset.stemmed_title)
                                │    │                        └ SiteDataSet(html=<doc><url>https://ru.wikipedia.org/wiki/LASIK</url><title>LASIK — Википедия</title><breadcrumbs></breadcrumb...
                                │    └ <function Concurency.count_matched_stem_items at 0x7f9c4802e430>
                                └ <__main__.Concurency object at 0x7f9c38311910>

AttributeError: 'SiteDataSet' object has no attribute 'stemmed_title'
12:54:13 An error has been caught in function 'run', process 'Process-1' (9446), thread 'MainThread' (140309268023104):
Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2131, in <module>
    main()
    └ <function main at 0x7f9c4aac54c0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2122, in main
    globals = debugger.run(setup['file'], None, None, is_module)
              │        │   │                          └ False
              │        │   └ {'port': 33707, 'vm_type': None, 'client': '127.0.0.1', 'server': False, 'DEBUG_RECORD_SOCKET_READS': False, 'multiproc': Tru...
              │        └ <function PyDB.run at 0x7f9c4aac44c0>
              └ <__main__.PyDB object at 0x7f9c4b2c6ee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1431, in run
    return self._exec(is_module, entry_point_fn, module_name, file, globals, locals)
           │    │     │          │               │            │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
           │    │     │          │               └ None
           │    │     │          └ ''
           │    │     └ False
           │    └ <function PyDB._exec at 0x7f9c4aac4550>
           └ <__main__.PyDB object at 0x7f9c4b2c6ee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1438, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
    │             │        │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
    │             └ <function execfile at 0x7f9c4b97c280>
    └ <module '_pydev_bundle.pydev_imports' from '/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/...

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
                 │              │              │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              │              └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
                 └ 'from microservices.conc_settings import *\nfrom multiprocessing import Process, Queue\nfrom threading import Thread\nfrom lo...

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 891, in <module>
    Manager()
    └ <function Manager at 0x7f9c4a92a160>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 52, in __init__
    self.run_processes()
    │    └ <function Manager.run_processes at 0x7f9c48099f70>
    └ <__main__.Manager object at 0x7f9c4810da30>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 89, in run_processes
    self.start_processes()
    │    └ <function Manager.start_processes at 0x7f9c480310d0>
    └ <__main__.Manager object at 0x7f9c4810da30>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 97, in start_processes
    process.start()
    │       └ <function BaseProcess.start at 0x7f9c4a9450d0>
    └ <Process name='Process-1' parent=9441 started>

  File "/usr/lib/python3.8/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
    │    │        │    │      └ <Process name='Process-1' parent=9441 started>
    │    │        │    └ <staticmethod object at 0x7f9c4a939850>
    │    │        └ <Process name='Process-1' parent=9441 started>
    │    └ None
    └ <Process name='Process-1' parent=9441 started>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
           │                │                            └ <Process name='Process-1' parent=9441 started>
           │                └ <function DefaultContext.get_context at 0x7f9c4a951af0>
           └ <multiprocessing.context.DefaultContext object at 0x7f9c4a941c70>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
           │     └ <Process name='Process-1' parent=9441 started>
           └ <class 'multiprocessing.popen_fork.Popen'>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
    │    │       └ <Process name='Process-1' parent=9441 started>
    │    └ <function Popen._launch at 0x7f9c39b73940>
    └ <multiprocessing.popen_fork.Popen object at 0x7f9c48050e80>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 75, in _launch
    code = process_obj._bootstrap(parent_sentinel=child_r)
           │           │                          └ 9
           │           └ <function BaseProcess._bootstrap at 0x7f9c4a9459d0>
           └ <Process name='Process-1' parent=9441 started>
  File "/usr/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7f9c4a945040>
    └ <Process name='Process-1' parent=9441 started>
> File "/usr/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Process name='Process-1' parent=9441 started>
    │    │        │    └ (RequestDataSet(id=44, text='lasik', xml='<?xml version="1.0" encoding="UTF-8" ?>\n<yandexsearch version="1.0">\n  <response ...
    │    │        └ <Process name='Process-1' parent=9441 started>
    │    └ <function Yandex at 0x7f9c48031ee0>
    └ <Process name='Process-1' parent=9441 started>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 280, in __init__
    self.prepare_result()
    │    └ <function Yandex.prepare_result at 0x7f9c48029820>
    └ <__main__.Yandex object at 0x7f9c4a941610>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 374, in prepare_result
    'Запрос': self.request,
              └ <__main__.Yandex object at 0x7f9c4a941610>

AttributeError: 'Yandex' object has no attribute 'request'
12:55:26 An error has been caught in function 'make_concurency_object', process 'Process-1' (9516), thread 'MainThread' (140229665990464):
Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2131, in <module>
    main()
    └ <function main at 0x7f89c20584c0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2122, in main
    globals = debugger.run(setup['file'], None, None, is_module)
              │        │   │                          └ False
              │        │   └ {'port': 45853, 'vm_type': None, 'client': '127.0.0.1', 'server': False, 'DEBUG_RECORD_SOCKET_READS': False, 'multiproc': Tru...
              │        └ <function PyDB.run at 0x7f89c205b4c0>
              └ <__main__.PyDB object at 0x7f89c285cee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1431, in run
    return self._exec(is_module, entry_point_fn, module_name, file, globals, locals)
           │    │     │          │               │            │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
           │    │     │          │               └ None
           │    │     │          └ ''
           │    │     └ False
           │    └ <function PyDB._exec at 0x7f89c205b550>
           └ <__main__.PyDB object at 0x7f89c285cee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1438, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
    │             │        │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
    │             └ <function execfile at 0x7f89c2f12280>
    └ <module '_pydev_bundle.pydev_imports' from '/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/...

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
                 │              │              │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              │              └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
                 └ 'from microservices.conc_settings import *\nfrom multiprocessing import Process, Queue\nfrom threading import Thread\nfrom lo...

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 891, in <module>
    Manager()
    └ <function Manager at 0x7f89c1ec1160>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 52, in __init__
    self.run_processes()
    │    └ <function Manager.run_processes at 0x7f89b11a8f70>
    └ <__main__.Manager object at 0x7f89b11a35b0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 89, in run_processes
    self.start_processes()
    │    └ <function Manager.start_processes at 0x7f89b11400d0>
    └ <__main__.Manager object at 0x7f89b11a35b0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 97, in start_processes
    process.start()
    │       └ <function BaseProcess.start at 0x7f89c1eda0d0>
    └ <Process name='Process-1' parent=9509 started>

  File "/usr/lib/python3.8/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
    │    │        │    │      └ <Process name='Process-1' parent=9509 started>
    │    │        │    └ <staticmethod object at 0x7f89c1ece850>
    │    │        └ <Process name='Process-1' parent=9509 started>
    │    └ None
    └ <Process name='Process-1' parent=9509 started>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
           │                │                            └ <Process name='Process-1' parent=9509 started>
           │                └ <function DefaultContext.get_context at 0x7f89c1ee6af0>
           └ <multiprocessing.context.DefaultContext object at 0x7f89c1ed6c70>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
           │     └ <Process name='Process-1' parent=9509 started>
           └ <class 'multiprocessing.popen_fork.Popen'>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
    │    │       └ <Process name='Process-1' parent=9509 started>
    │    └ <function Popen._launch at 0x7f89b10eb940>
    └ <multiprocessing.popen_fork.Popen object at 0x7f89b10ee1c0>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 75, in _launch
    code = process_obj._bootstrap(parent_sentinel=child_r)
           │           │                          └ 9
           │           └ <function BaseProcess._bootstrap at 0x7f89c1eda9d0>
           └ <Process name='Process-1' parent=9509 started>
  File "/usr/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7f89c1eda040>
    └ <Process name='Process-1' parent=9509 started>
  File "/usr/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Process name='Process-1' parent=9509 started>
    │    │        │    └ (RequestDataSet(id=44, text='lasik', xml='<?xml version="1.0" encoding="UTF-8" ?>\n<yandexsearch version="1.0">\n  <response ...
    │    │        └ <Process name='Process-1' parent=9509 started>
    │    └ <function Yandex at 0x7f89b1140ee0>
    └ <Process name='Process-1' parent=9509 started>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 279, in __init__
    self.make_concurency_object()
    │    └ <function Yandex.make_concurency_object at 0x7f89b1137790>
    └ <__main__.Yandex object at 0x7f89c1ed6610>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 370, in make_concurency_object
    self.concurency_object = Concurency(self.site_list, self.stemmed_request)
    │    │                   │          │    │          │    └ ['lasik']
    │    │                   │          │    │          └ <__main__.Yandex object at 0x7f89c1ed6610>
    │    │                   │          │    └ [SiteDataSet(html=<doc><url>https://ru.wikipedia.org/wiki/LASIK</url><title>LASIK — Википедия</title><breadcrumbs></breadcrum...
    │    │                   │          └ <__main__.Yandex object at 0x7f89c1ed6610>
    │    │                   └ <function Concurency at 0x7f89b1138ee0>
    │    └ <object object at 0x7f89b10f13c0>
    └ <__main__.Yandex object at 0x7f89c1ed6610>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 633, in __init__
    self.calculate_site_stem_concurency()
    │    └ <function Concurency.calculate_site_stem_concurency at 0x7f89b113e3a0>
    └ <__main__.Concurency object at 0x7f89b0076ca0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 744, in calculate_site_stem_concurency
    matched_stem_items_amount = self.count_matched_stem_items(site_dataset.stemmed_title)
                                │    │                        └ SiteDataSet(html=<doc><url>https://ru.wikipedia.org/wiki/LASIK</url><title>LASIK — Википедия</title><breadcrumbs></breadcrumb...
                                │    └ <function Concurency.count_matched_stem_items at 0x7f89b113e430>
                                └ <__main__.Concurency object at 0x7f89b0076ca0>

AttributeError: 'SiteDataSet' object has no attribute 'stemmed_title'
12:55:26 An error has been caught in function 'run', process 'Process-1' (9516), thread 'MainThread' (140229665990464):
Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2131, in <module>
    main()
    └ <function main at 0x7f89c20584c0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2122, in main
    globals = debugger.run(setup['file'], None, None, is_module)
              │        │   │                          └ False
              │        │   └ {'port': 45853, 'vm_type': None, 'client': '127.0.0.1', 'server': False, 'DEBUG_RECORD_SOCKET_READS': False, 'multiproc': Tru...
              │        └ <function PyDB.run at 0x7f89c205b4c0>
              └ <__main__.PyDB object at 0x7f89c285cee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1431, in run
    return self._exec(is_module, entry_point_fn, module_name, file, globals, locals)
           │    │     │          │               │            │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
           │    │     │          │               └ None
           │    │     │          └ ''
           │    │     └ False
           │    └ <function PyDB._exec at 0x7f89c205b550>
           └ <__main__.PyDB object at 0x7f89c285cee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1438, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
    │             │        │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
    │             └ <function execfile at 0x7f89c2f12280>
    └ <module '_pydev_bundle.pydev_imports' from '/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/...

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
                 │              │              │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              │              └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
                 └ 'from microservices.conc_settings import *\nfrom multiprocessing import Process, Queue\nfrom threading import Thread\nfrom lo...

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 891, in <module>
    Manager()
    └ <function Manager at 0x7f89c1ec1160>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 52, in __init__
    self.run_processes()
    │    └ <function Manager.run_processes at 0x7f89b11a8f70>
    └ <__main__.Manager object at 0x7f89b11a35b0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 89, in run_processes
    self.start_processes()
    │    └ <function Manager.start_processes at 0x7f89b11400d0>
    └ <__main__.Manager object at 0x7f89b11a35b0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 97, in start_processes
    process.start()
    │       └ <function BaseProcess.start at 0x7f89c1eda0d0>
    └ <Process name='Process-1' parent=9509 started>

  File "/usr/lib/python3.8/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
    │    │        │    │      └ <Process name='Process-1' parent=9509 started>
    │    │        │    └ <staticmethod object at 0x7f89c1ece850>
    │    │        └ <Process name='Process-1' parent=9509 started>
    │    └ None
    └ <Process name='Process-1' parent=9509 started>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
           │                │                            └ <Process name='Process-1' parent=9509 started>
           │                └ <function DefaultContext.get_context at 0x7f89c1ee6af0>
           └ <multiprocessing.context.DefaultContext object at 0x7f89c1ed6c70>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
           │     └ <Process name='Process-1' parent=9509 started>
           └ <class 'multiprocessing.popen_fork.Popen'>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
    │    │       └ <Process name='Process-1' parent=9509 started>
    │    └ <function Popen._launch at 0x7f89b10eb940>
    └ <multiprocessing.popen_fork.Popen object at 0x7f89b10ee1c0>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 75, in _launch
    code = process_obj._bootstrap(parent_sentinel=child_r)
           │           │                          └ 9
           │           └ <function BaseProcess._bootstrap at 0x7f89c1eda9d0>
           └ <Process name='Process-1' parent=9509 started>
  File "/usr/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7f89c1eda040>
    └ <Process name='Process-1' parent=9509 started>
> File "/usr/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Process name='Process-1' parent=9509 started>
    │    │        │    └ (RequestDataSet(id=44, text='lasik', xml='<?xml version="1.0" encoding="UTF-8" ?>\n<yandexsearch version="1.0">\n  <response ...
    │    │        └ <Process name='Process-1' parent=9509 started>
    │    └ <function Yandex at 0x7f89b1140ee0>
    └ <Process name='Process-1' parent=9509 started>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 280, in __init__
    self.prepare_result()
    │    └ <function Yandex.prepare_result at 0x7f89b1137820>
    └ <__main__.Yandex object at 0x7f89c1ed6610>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 374, in prepare_result
    'Запрос': self.request,
              └ <__main__.Yandex object at 0x7f89c1ed6610>

AttributeError: 'Yandex' object has no attribute 'request'
13:22:20 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-1' (3582), thread 'Thread-30' (139865903572736):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 466, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f3554f8a160>
    └ <__main__.Domain object at 0x7f354f66cb80>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 473, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f3554f8a310>
    └ <__main__.Domain object at 0x7f354f66cb80>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 502, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('nlv.ru',...
    │  └ <function custom_request_to_database_without_return at 0x7f35640468b0>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('nlv.ru',...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f354f653220; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(nlv.ru) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f64eb50>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f64eb50>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-30, started 139865903572736)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f64eb50>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f3566ceeaf0>
    └ <Thread(Thread-30, started 139865903572736)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f3566cee820>
    └ <Thread(Thread-30, started 139865903572736)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-30, started 139865903572736)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекц...
    │    │        └ <Thread(Thread-30, started 139865903572736)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f3565ced670>>
    └ <Thread(Thread-30, started 139865903572736)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекци...
    └ <function Site at 0x7f3554f87790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 173, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f3554f87b80>
    └ <__main__.Site object at 0x7f354f66cb50>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 248, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://www.nlv.ru/laser-correction/lasik-operatsiya</url><title>ЛАСИК ( LASIK ) лазерная коррекци...
    │      └ <__main__.Site object at 0x7f354f66cb50>
    └ <function Domain at 0x7f3554f8a040>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 468, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f3565dd25e0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
13:22:20 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-1' (3582), thread 'Thread-25' (139865945536256):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 466, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f3554f8a160>
    └ <__main__.Domain object at 0x7f354f5ff820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 473, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f3554f8a310>
    └ <__main__.Domain object at 0x7f354f5ff820>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 502, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('realeyes...
    │  └ <function custom_request_to_database_without_return at 0x7f35640468b0>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('realeyes...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f354f653b80; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(realeyes.ru) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f6acdc0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f6acdc0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-25, started 139865945536256)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f6acdc0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f3566ceeaf0>
    └ <Thread(Thread-25, started 139865945536256)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f3566cee820>
    └ <Thread(Thread-25, started 139865945536256)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-25, started 139865945536256)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://realeyes.ru/metod/lasik/</url><title>Лазерная коррекция зрения LASIK : цена, отзывы, как....
    │    │        └ <Thread(Thread-25, started 139865945536256)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f3565ced670>>
    └ <Thread(Thread-25, started 139865945536256)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://realeyes.ru/metod/lasik/</url><title>Лазерная коррекция зрения LASIK : цена, отзывы, как.....
    └ <function Site at 0x7f3554f87790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 173, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f3554f87b80>
    └ <__main__.Site object at 0x7f354f6ac0d0>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 248, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://realeyes.ru/metod/lasik/</url><title>Лазерная коррекция зрения LASIK : цена, отзывы, как.....
    │      └ <__main__.Site object at 0x7f354f6ac0d0>
    └ <function Domain at 0x7f3554f8a040>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 468, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f3565dd25e0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
13:22:20 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-1' (3582), thread 'Thread-23' (139866507552512):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 466, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f3554f8a160>
    └ <__main__.Domain object at 0x7f3554f6ac70>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 473, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f3554f8a310>
    └ <__main__.Domain object at 0x7f3554f6ac70>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 502, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('euroopti...
    │  └ <function custom_request_to_database_without_return at 0x7f35640468b0>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('euroopti...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f354f653a90; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(eurooptic.ru) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f6ac1f0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f6ac1f0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-23, started 139866507552512)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f6ac1f0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f3566ceeaf0>
    └ <Thread(Thread-23, started 139866507552512)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f3566cee820>
    └ <Thread(Thread-23, started 139866507552512)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-23, started 139866507552512)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://eurooptic.ru/articles/vsye-o-lazernoy-korrektsii-zreniya-metodom-lasik/</url><title>Всё о...
    │    │        └ <Thread(Thread-23, started 139866507552512)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f3565ced670>>
    └ <Thread(Thread-23, started 139866507552512)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://eurooptic.ru/articles/vsye-o-lazernoy-korrektsii-zreniya-metodom-lasik/</url><title>Всё о ...
    └ <function Site at 0x7f3554f87790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 173, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f3554f87b80>
    └ <__main__.Site object at 0x7f354f6acd90>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 248, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://eurooptic.ru/articles/vsye-o-lazernoy-korrektsii-zreniya-metodom-lasik/</url><title>Всё о ...
    │      └ <__main__.Site object at 0x7f354f6acd90>
    └ <function Domain at 0x7f3554f8a040>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 468, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f3565dd25e0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
13:22:22 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-1' (3582), thread 'Thread-16' (139866907424512):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 466, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f3554f8a160>
    └ <__main__.Domain object at 0x7f3554f6a9d0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 473, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f3554f8a310>
    └ <__main__.Domain object at 0x7f3554f6a9d0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 502, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('vseozren...
    │  └ <function custom_request_to_database_without_return at 0x7f35640468b0>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('vseozren...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f354eab3a90; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(vseozrenii.ru) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f6902b0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f6902b0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-16, started 139866907424512)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f6902b0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f3566ceeaf0>
    └ <Thread(Thread-16, started 139866907424512)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f3566cee820>
    └ <Thread(Thread-16, started 139866907424512)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-16, started 139866907424512)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.vseozrenii.ru/lazernaya-korrekciya-zreniya/lasik/</url><title>ЛАСИК ( LASIK ) метод л...
    │    │        └ <Thread(Thread-16, started 139866907424512)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f3565ced670>>
    └ <Thread(Thread-16, started 139866907424512)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.vseozrenii.ru/lazernaya-korrekciya-zreniya/lasik/</url><title>ЛАСИК ( LASIK ) метод ла...
    └ <function Site at 0x7f3554f87790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 173, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f3554f87b80>
    └ <__main__.Site object at 0x7f354f690970>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 248, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://www.vseozrenii.ru/lazernaya-korrekciya-zreniya/lasik/</url><title>ЛАСИК ( LASIK ) метод ла...
    │      └ <__main__.Site object at 0x7f354f690970>
    └ <function Domain at 0x7f3554f8a040>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 468, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f3565dd25e0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
13:22:23 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-1' (3582), thread 'Thread-20' (139866532730624):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 466, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f3554f8a160>
    └ <__main__.Domain object at 0x7f354f639190>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 473, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f3554f8a310>
    └ <__main__.Domain object at 0x7f354f639190>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 502, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('fedorovm...
    │  └ <function custom_request_to_database_without_return at 0x7f35640468b0>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('fedorovm...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f354f6446d0; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(fedorovmedcenter.ru) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f690fa0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f690fa0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-20, started 139866532730624)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f690fa0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f3566ceeaf0>
    └ <Thread(Thread-20, started 139866532730624)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f3566cee820>
    └ <Thread(Thread-20, started 139866532730624)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-20, started 139866532730624)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://fedorovmedcenter.ru/stati/oft-lazernaya-korrektsiya-zreniya/lazernaya-korrektsii-zreniya-...
    │    │        └ <Thread(Thread-20, started 139866532730624)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f3565ced670>>
    └ <Thread(Thread-20, started 139866532730624)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://fedorovmedcenter.ru/stati/oft-lazernaya-korrektsiya-zreniya/lazernaya-korrektsii-zreniya-l...
    └ <function Site at 0x7f3554f87790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 173, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f3554f87b80>
    └ <__main__.Site object at 0x7f354f6ac760>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 248, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://fedorovmedcenter.ru/stati/oft-lazernaya-korrektsiya-zreniya/lazernaya-korrektsii-zreniya-l...
    │      └ <__main__.Site object at 0x7f354f6ac760>
    └ <function Domain at 0x7f3554f8a040>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 468, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f3565dd25e0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
13:22:23 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-1' (3582), thread 'Thread-18' (139866549516032):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 466, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f3554f8a160>
    └ <__main__.Domain object at 0x7f355417c7f0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 473, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f3554f8a310>
    └ <__main__.Domain object at 0x7f355417c7f0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 502, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('elitplus...
    │  └ <function custom_request_to_database_without_return at 0x7f35640468b0>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('elitplus...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f354e6e3e50; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(elitplus-clinic.ru) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f690b20>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f690b20>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-18, started 139866549516032)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f690b20>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f3566ceeaf0>
    └ <Thread(Thread-18, started 139866549516032)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f3566cee820>
    └ <Thread(Thread-18, started 139866549516032)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-18, started 139866549516032)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://elitplus-clinic.ru/stati/lazernaya-korrekcziya-zreniya-lasik.html</url><title>Лазерная ко...
    │    │        └ <Thread(Thread-18, started 139866549516032)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f3565ced670>>
    └ <Thread(Thread-18, started 139866549516032)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://elitplus-clinic.ru/stati/lazernaya-korrekcziya-zreniya-lasik.html</url><title>Лазерная кор...
    └ <function Site at 0x7f3554f87790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 173, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f3554f87b80>
    └ <__main__.Site object at 0x7f354f690610>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 248, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://elitplus-clinic.ru/stati/lazernaya-korrekcziya-zreniya-lasik.html</url><title>Лазерная кор...
    │      └ <__main__.Site object at 0x7f354f690610>
    └ <function Domain at 0x7f3554f8a040>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 468, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f3565dd25e0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
13:22:24 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-1' (3582), thread 'Thread-21' (139866524337920):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 466, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f3554f8a160>
    └ <__main__.Domain object at 0x7f3554303370>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 473, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f3554f8a310>
    └ <__main__.Domain object at 0x7f3554303370>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 502, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('100med.r...
    │  └ <function custom_request_to_database_without_return at 0x7f35640468b0>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('100med.r...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f354c957310; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(100med.ru) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f690940>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f690940>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-21, started 139866524337920)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f690940>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f3566ceeaf0>
    └ <Thread(Thread-21, started 139866524337920)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f3566cee820>
    └ <Thread(Thread-21, started 139866524337920)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-21, started 139866524337920)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://100med.ru/directions/oftalmologiya/lazernaya-korrektsiya-zreniya-pri-pomoshchi-lasik-lasi...
    │    │        └ <Thread(Thread-21, started 139866524337920)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f3565ced670>>
    └ <Thread(Thread-21, started 139866524337920)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://100med.ru/directions/oftalmologiya/lazernaya-korrektsiya-zreniya-pri-pomoshchi-lasik-lasik...
    └ <function Site at 0x7f3554f87790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 173, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f3554f87b80>
    └ <__main__.Site object at 0x7f354f6aca00>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 248, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://100med.ru/directions/oftalmologiya/lazernaya-korrektsiya-zreniya-pri-pomoshchi-lasik-lasik...
    │      └ <__main__.Site object at 0x7f354f6aca00>
    └ <function Domain at 0x7f3554f8a040>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 468, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f3565dd25e0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
13:22:24 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-1' (3582), thread 'Thread-29' (139865911965440):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 466, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f3554f8a160>
    └ <__main__.Domain object at 0x7f354f4013d0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 473, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f3554f8a310>
    └ <__main__.Domain object at 0x7f354f4013d0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 502, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('smileeye...
    │  └ <function custom_request_to_database_without_return at 0x7f35640468b0>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('smileeye...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f354c9574f0; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(smileeyes.ru) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f6acc10>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f6acc10>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-29, started 139865911965440)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f6acc10>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f3566ceeaf0>
    └ <Thread(Thread-29, started 139865911965440)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f3566cee820>
    └ <Thread(Thread-29, started 139865911965440)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-29, started 139865911965440)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://smileeyes.ru/operacija-lasik/</url><title>Лазерная коррекция ЛАСИК - популярный метод...<...
    │    │        └ <Thread(Thread-29, started 139865911965440)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f3565ced670>>
    └ <Thread(Thread-29, started 139865911965440)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://smileeyes.ru/operacija-lasik/</url><title>Лазерная коррекция ЛАСИК - популярный метод...</...
    └ <function Site at 0x7f3554f87790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 173, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f3554f87b80>
    └ <__main__.Site object at 0x7f354f64ed90>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 248, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://smileeyes.ru/operacija-lasik/</url><title>Лазерная коррекция ЛАСИК - популярный метод...</...
    │      └ <__main__.Site object at 0x7f354f64ed90>
    └ <function Domain at 0x7f3554f8a040>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 468, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f3565dd25e0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
13:22:25 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-1' (3582), thread 'Thread-22' (139866515945216):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 466, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f3554f8a160>
    └ <__main__.Domain object at 0x7f354f61b4c0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 473, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f3554f8a310>
    └ <__main__.Domain object at 0x7f354f61b4c0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 502, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('eyesurge...
    │  └ <function custom_request_to_database_without_return at 0x7f35640468b0>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('eyesurge...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f35102b28b0; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(eyesurgerycenter.ru) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f690e80>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f690e80>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-22, started 139866515945216)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f690e80>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f3566ceeaf0>
    └ <Thread(Thread-22, started 139866515945216)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f3566cee820>
    └ <Thread(Thread-22, started 139866515945216)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-22, started 139866515945216)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://eyesurgerycenter.ru/lazernaya-korrekciya-zreniya/lasik.html</url><title>Операция Ласик (С...
    │    │        └ <Thread(Thread-22, started 139866515945216)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f3565ced670>>
    └ <Thread(Thread-22, started 139866515945216)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://eyesurgerycenter.ru/lazernaya-korrekciya-zreniya/lasik.html</url><title>Операция Ласик (Су...
    └ <function Site at 0x7f3554f87790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 173, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f3554f87b80>
    └ <__main__.Site object at 0x7f354f6acbe0>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 248, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://eyesurgerycenter.ru/lazernaya-korrekciya-zreniya/lasik.html</url><title>Операция Ласик (Су...
    │      └ <__main__.Site object at 0x7f354f6acbe0>
    └ <function Domain at 0x7f3554f8a040>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 468, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f3565dd25e0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
13:22:25 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-1' (3582), thread 'Thread-15' (139866915817216):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 466, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f3554f8a160>
    └ <__main__.Domain object at 0x7f3565d9a220>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 473, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f3554f8a310>
    └ <__main__.Domain object at 0x7f3565d9a220>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 502, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('Korrekts...
    │  └ <function custom_request_to_database_without_return at 0x7f35640468b0>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('Korrekts...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f35102b2a90; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(Korrektsiya-zreniya.ru) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f690580>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f690580>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-15, started 139866915817216)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f690580>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f3566ceeaf0>
    └ <Thread(Thread-15, started 139866915817216)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f3566cee820>
    └ <Thread(Thread-15, started 139866915817216)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-15, started 139866915817216)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://Korrektsiya-zreniya.ru/blog/lasik/</url><title>LASIK | Лазерная коррекция зрения методом ...
    │    │        └ <Thread(Thread-15, started 139866915817216)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f3565ced670>>
    └ <Thread(Thread-15, started 139866915817216)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://Korrektsiya-zreniya.ru/blog/lasik/</url><title>LASIK | Лазерная коррекция зрения методом Л...
    └ <function Site at 0x7f3554f87790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 173, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f3554f87b80>
    └ <__main__.Site object at 0x7f354f690d00>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 248, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://Korrektsiya-zreniya.ru/blog/lasik/</url><title>LASIK | Лазерная коррекция зрения методом Л...
    │      └ <__main__.Site object at 0x7f354f690d00>
    └ <function Domain at 0x7f3554f8a040>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 468, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f3565dd25e0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
13:22:25 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-1' (3582), thread 'Thread-24' (139866499159808):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 466, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f3554f8a160>
    └ <__main__.Domain object at 0x7f354f607850>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 473, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f3554f8a310>
    └ <__main__.Domain object at 0x7f354f607850>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 502, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('ophthalm...
    │  └ <function custom_request_to_database_without_return at 0x7f35640468b0>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('ophthalm...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f35102b28b0; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(ophthalmocenter.ru) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f6aca60>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f6aca60>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-24, started 139866499159808)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f6aca60>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f3566ceeaf0>
    └ <Thread(Thread-24, started 139866499159808)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f3566cee820>
    └ <Thread(Thread-24, started 139866499159808)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-24, started 139866499159808)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://ophthalmocenter.ru/lazernaya-korrekciya-zreniya/lazernaya-korrekciya-zreniya-lasic.html</...
    │    │        └ <Thread(Thread-24, started 139866499159808)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f3565ced670>>
    └ <Thread(Thread-24, started 139866499159808)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://ophthalmocenter.ru/lazernaya-korrekciya-zreniya/lazernaya-korrekciya-zreniya-lasic.html</u...
    └ <function Site at 0x7f3554f87790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 173, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f3554f87b80>
    └ <__main__.Site object at 0x7f354f6ac220>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 248, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://ophthalmocenter.ru/lazernaya-korrekciya-zreniya/lazernaya-korrekciya-zreniya-lasic.html</u...
    │      └ <__main__.Site object at 0x7f354f6ac220>
    └ <function Domain at 0x7f3554f8a040>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 468, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f3565dd25e0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
13:22:25 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-1' (3582), thread 'Thread-19' (139866541123328):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 466, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f3554f8a160>
    └ <__main__.Domain object at 0x7f3554f6abe0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 473, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f3554f8a310>
    └ <__main__.Domain object at 0x7f3554f6abe0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 502, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('excimerc...
    │  └ <function custom_request_to_database_without_return at 0x7f35640468b0>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('excimerc...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f354fc03c70; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(excimerclinic.ru) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f690fd0>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f690fd0>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-19, started 139866541123328)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f690fd0>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f3566ceeaf0>
    └ <Thread(Thread-19, started 139866541123328)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f3566cee820>
    └ <Thread(Thread-19, started 139866541123328)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-19, started 139866541123328)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://excimerclinic.ru/laser-correction/lasik/</url><title>Лазерная коррекция зрения с помощью ...
    │    │        └ <Thread(Thread-19, started 139866541123328)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f3565ced670>>
    └ <Thread(Thread-19, started 139866541123328)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://excimerclinic.ru/laser-correction/lasik/</url><title>Лазерная коррекция зрения с помощью о...
    └ <function Site at 0x7f3554f87790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 173, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f3554f87b80>
    └ <__main__.Site object at 0x7f354f6ac580>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 248, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://excimerclinic.ru/laser-correction/lasik/</url><title>Лазерная коррекция зрения с помощью о...
    │      └ <__main__.Site object at 0x7f354f6ac580>
    └ <function Domain at 0x7f3554f8a040>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 468, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f3565dd25e0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
13:22:25 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-1' (3582), thread 'Thread-31' (139865895180032):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 466, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f3554f8a160>
    └ <__main__.Domain object at 0x7f35543054f0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 473, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f3554f8a310>
    └ <__main__.Domain object at 0x7f35543054f0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 502, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('doctor-s...
    │  └ <function custom_request_to_database_without_return at 0x7f35640468b0>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('doctor-s...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f35102b2a90; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(doctor-shilova.ru) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/pydev_monkey.py", line 770, in __call__
    ret = self.original_func(*self.args, **self.kwargs)
          │    │              │    │       │    └ {}
          │    │              │    │       └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f64ed30>
          │    │              │    └ ()
          │    │              └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f64ed30>
          │    └ <bound method Thread._bootstrap of <Thread(Thread-31, started 139865895180032)>>
          └ <_pydev_bundle.pydev_monkey._NewThreadStartupWithTrace object at 0x7f354f64ed30>

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f3566ceeaf0>
    └ <Thread(Thread-31, started 139865895180032)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f3566cee820>
    └ <Thread(Thread-31, started 139865895180032)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-31, started 139865895180032)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://doctor-shilova.ru/lasik/</url><title>Лазерная коррекция зрения LASIK в Москве - операция ...
    │    │        └ <Thread(Thread-31, started 139865895180032)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f3565ced670>>
    └ <Thread(Thread-31, started 139865895180032)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 350, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://doctor-shilova.ru/lasik/</url><title>Лазерная коррекция зрения LASIK в Москве - операция п...
    └ <function Site at 0x7f3554f87790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 173, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f3554f87b80>
    └ <__main__.Site object at 0x7f354f6ac790>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 248, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://doctor-shilova.ru/lasik/</url><title>Лазерная коррекция зрения LASIK в Москве - операция п...
    │      └ <__main__.Site object at 0x7f354f6ac790>
    └ <function Domain at 0x7f3554f8a040>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 468, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f3565dd25e0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
13:27:15 An error has been caught in function 'make_concurency_object', process 'Process-1' (3756), thread 'MainThread' (140215833560896):
Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2131, in <module>
    main()
    └ <function main at 0x7f86898b84c0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2122, in main
    globals = debugger.run(setup['file'], None, None, is_module)
              │        │   │                          └ False
              │        │   └ {'port': 33747, 'vm_type': None, 'client': '127.0.0.1', 'server': False, 'DEBUG_RECORD_SOCKET_READS': False, 'multiproc': Tru...
              │        └ <function PyDB.run at 0x7f86898ba4c0>
              └ <__main__.PyDB object at 0x7f868a0baee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1431, in run
    return self._exec(is_module, entry_point_fn, module_name, file, globals, locals)
           │    │     │          │               │            │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
           │    │     │          │               └ None
           │    │     │          └ ''
           │    │     └ False
           │    └ <function PyDB._exec at 0x7f86898ba550>
           └ <__main__.PyDB object at 0x7f868a0baee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1438, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
    │             │        │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
    │             └ <function execfile at 0x7f868a770280>
    └ <module '_pydev_bundle.pydev_imports' from '/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/...

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
                 │              │              │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              │              └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
                 └ 'from microservices.conc_settings import *\nfrom multiprocessing import Process, Queue\nfrom threading import Thread\nfrom lo...

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 891, in <module>
    Manager()
    └ <function Manager at 0x7f868971a160>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 52, in __init__
    self.run_processes()
    │    └ <function Manager.run_processes at 0x7f8680a26f70>
    └ <__main__.Manager object at 0x7f8688045e80>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 89, in run_processes
    self.start_processes()
    │    └ <function Manager.start_processes at 0x7f86809bf0d0>
    └ <__main__.Manager object at 0x7f8688045e80>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 97, in start_processes
    process.start()
    │       └ <function BaseProcess.start at 0x7f86897370d0>
    └ <Process name='Process-1' parent=3744 started>

  File "/usr/lib/python3.8/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
    │    │        │    │      └ <Process name='Process-1' parent=3744 started>
    │    │        │    └ <staticmethod object at 0x7f868972a850>
    │    │        └ <Process name='Process-1' parent=3744 started>
    │    └ None
    └ <Process name='Process-1' parent=3744 started>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
           │                │                            └ <Process name='Process-1' parent=3744 started>
           │                └ <function DefaultContext.get_context at 0x7f8689742af0>
           └ <multiprocessing.context.DefaultContext object at 0x7f8689732c70>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
           │     └ <Process name='Process-1' parent=3744 started>
           └ <class 'multiprocessing.popen_fork.Popen'>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
    │    │       └ <Process name='Process-1' parent=3744 started>
    │    └ <function Popen._launch at 0x7f868096a940>
    └ <multiprocessing.popen_fork.Popen object at 0x7f86809e7310>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 75, in _launch
    code = process_obj._bootstrap(parent_sentinel=child_r)
           │           │                          └ 9
           │           └ <function BaseProcess._bootstrap at 0x7f86897379d0>
           └ <Process name='Process-1' parent=3744 started>
  File "/usr/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7f8689737040>
    └ <Process name='Process-1' parent=3744 started>
  File "/usr/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Process name='Process-1' parent=3744 started>
    │    │        │    └ (RequestDataSet(id=44, text='lasik', xml='<?xml version="1.0" encoding="UTF-8" ?>\n<yandexsearch version="1.0">\n  <response ...
    │    │        └ <Process name='Process-1' parent=3744 started>
    │    └ <function Yandex at 0x7f86809bfee0>
    └ <Process name='Process-1' parent=3744 started>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 279, in __init__
    self.make_concurency_object()
    │    └ <function Yandex.make_concurency_object at 0x7f86809b6790>
    └ <__main__.Yandex object at 0x7f8689732610>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 370, in make_concurency_object
    self.concurency_object = Concurency(self.site_list, self.stemmed_request)
    │    │                   │          │    │          │    └ ['lasik']
    │    │                   │          │    │          └ <__main__.Yandex object at 0x7f8689732610>
    │    │                   │          │    └ [SiteDataSet(html=<doc><url>https://ru.wikipedia.org/wiki/LASIK</url><title>LASIK — Википедия</title><breadcrumbs></breadcrum...
    │    │                   │          └ <__main__.Yandex object at 0x7f8689732610>
    │    │                   └ <function Concurency at 0x7f86809b9ee0>
    │    └ <object object at 0x7f868096f3c0>
    └ <__main__.Yandex object at 0x7f8689732610>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 640, in __init__
    self.calculate_statistics()
    │    └ <function Concurency.calculate_statistics at 0x7f86809bd550>
    └ <__main__.Concurency object at 0x7f867422f490>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 797, in calculate_statistics
    self.average_site_age = int(domain_age_total_count / self.organic_sites_count)
    │    │                      │                        └ <__main__.Concurency object at 0x7f867422f490>
    │    │                      └ 267
    │    └ 0
    └ <__main__.Concurency object at 0x7f867422f490>

AttributeError: 'Concurency' object has no attribute 'organic_sites_count'
13:48:21 An error has been caught in function 'run', process 'Process-1' (5321), thread 'MainThread' (140048196986688):
Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2131, in <module>
    main()
    └ <function main at 0x7f5f81a034c0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2122, in main
    globals = debugger.run(setup['file'], None, None, is_module)
              │        │   │                          └ False
              │        │   └ {'port': 45223, 'vm_type': None, 'client': '127.0.0.1', 'server': False, 'DEBUG_RECORD_SOCKET_READS': False, 'multiproc': Tru...
              │        └ <function PyDB.run at 0x7f5f81a044c0>
              └ <__main__.PyDB object at 0x7f5f82207ee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1431, in run
    return self._exec(is_module, entry_point_fn, module_name, file, globals, locals)
           │    │     │          │               │            │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
           │    │     │          │               └ None
           │    │     │          └ ''
           │    │     └ False
           │    └ <function PyDB._exec at 0x7f5f81a04550>
           └ <__main__.PyDB object at 0x7f5f82207ee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1438, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
    │             │        │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
    │             └ <function execfile at 0x7f5f828be280>
    └ <module '_pydev_bundle.pydev_imports' from '/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/...

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
                 │              │              │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              │              └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
                 └ 'from microservices.conc_settings import *\nfrom multiprocessing import Process, Queue\nfrom threading import Thread\nfrom lo...

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 871, in <module>
    Manager()
    └ <function Manager at 0x7f5f818a70d0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 52, in __init__
    self.run_processes()
    │    └ <function Manager.run_processes at 0x7f5f70b77ee0>
    └ <__main__.Manager object at 0x7f5f70beab80>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 89, in run_processes
    self.start_processes()
    │    └ <function Manager.start_processes at 0x7f5f70b0b040>
    └ <__main__.Manager object at 0x7f5f70beab80>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 97, in start_processes
    process.start()
    │       └ <function BaseProcess.start at 0x7f5f818be040>
    └ <Process name='Process-1' parent=5313 started>

  File "/usr/lib/python3.8/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
    │    │        │    │      └ <Process name='Process-1' parent=5313 started>
    │    │        │    └ <staticmethod object at 0x7f5f818b38e0>
    │    │        └ <Process name='Process-1' parent=5313 started>
    │    └ None
    └ <Process name='Process-1' parent=5313 started>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
           │                │                            └ <Process name='Process-1' parent=5313 started>
           │                └ <function DefaultContext.get_context at 0x7f5f818caa60>
           └ <multiprocessing.context.DefaultContext object at 0x7f5f818b7d00>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
           │     └ <Process name='Process-1' parent=5313 started>
           └ <class 'multiprocessing.popen_fork.Popen'>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
    │    │       └ <Process name='Process-1' parent=5313 started>
    │    └ <function Popen._launch at 0x7f5f70b388b0>
    └ <multiprocessing.popen_fork.Popen object at 0x7f5f70b2efa0>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 75, in _launch
    code = process_obj._bootstrap(parent_sentinel=child_r)
           │           │                          └ 9
           │           └ <function BaseProcess._bootstrap at 0x7f5f818be940>
           └ <Process name='Process-1' parent=5313 started>
  File "/usr/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7f5f818a7f70>
    └ <Process name='Process-1' parent=5313 started>
> File "/usr/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Process name='Process-1' parent=5313 started>
    │    │        │    └ (RequestDataSet(id=44, text='lasik', xml='<?xml version="1.0" encoding="UTF-8" ?>\n<yandexsearch version="1.0">\n  <response ...
    │    │        └ <Process name='Process-1' parent=5313 started>
    │    └ <function Yandex at 0x7f5f70b0be50>
    └ <Process name='Process-1' parent=5313 started>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 281, in __init__
    self.add_result_to_database()
    │    └ <function Yandex.add_result_to_database at 0x7f5f70b0e820>
    └ <__main__.Yandex object at 0x7f5f818b76d0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 381, in add_result_to_database
    pm.custom_request_to_database_without_return(
    │  └ <function custom_request_to_database_without_return at 0x7f5f70bde820>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "UPDATE concurent_site.main_request SET site_age_concurency = 89, site_stem_concurency = 95, site_volume_concurency = 97, sit...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f5f69ad8040; closed: 0>

psycopg2.errors.UndefinedColumn: column "request_id" does not exist
LINE 1: ...backlinks = 0, average_unique_backlinks = 0 WHERE request_id...
                                                             ^

13:48:45 An error has been caught in function 'run', process 'Process-1' (5403), thread 'MainThread' (139695196505920):
Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2131, in <module>
    main()
    └ <function main at 0x7f0d512884c0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2122, in main
    globals = debugger.run(setup['file'], None, None, is_module)
              │        │   │                          └ False
              │        │   └ {'port': 41089, 'vm_type': None, 'client': '127.0.0.1', 'server': False, 'DEBUG_RECORD_SOCKET_READS': False, 'multiproc': Tru...
              │        └ <function PyDB.run at 0x7f0d5128a4c0>
              └ <__main__.PyDB object at 0x7f0d51a8aee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1431, in run
    return self._exec(is_module, entry_point_fn, module_name, file, globals, locals)
           │    │     │          │               │            │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
           │    │     │          │               └ None
           │    │     │          └ ''
           │    │     └ False
           │    └ <function PyDB._exec at 0x7f0d5128a550>
           └ <__main__.PyDB object at 0x7f0d51a8aee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1438, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
    │             │        │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
    │             └ <function execfile at 0x7f0d52140280>
    └ <module '_pydev_bundle.pydev_imports' from '/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/...

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
                 │              │              │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              │              └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
                 └ 'from microservices.conc_settings import *\nfrom multiprocessing import Process, Queue\nfrom threading import Thread\nfrom lo...

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 871, in <module>
    Manager()
    └ <function Manager at 0x7f0d5112a0d0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 52, in __init__
    self.run_processes()
    │    └ <function Manager.run_processes at 0x7f0d483f5ee0>
    └ <__main__.Manager object at 0x7f0d48466e80>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 89, in run_processes
    self.start_processes()
    │    └ <function Manager.start_processes at 0x7f0d4838f040>
    └ <__main__.Manager object at 0x7f0d48466e80>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 97, in start_processes
    process.start()
    │       └ <function BaseProcess.start at 0x7f0d51141040>
    └ <Process name='Process-1' parent=5397 started>

  File "/usr/lib/python3.8/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
    │    │        │    │      └ <Process name='Process-1' parent=5397 started>
    │    │        │    └ <staticmethod object at 0x7f0d511358b0>
    │    │        └ <Process name='Process-1' parent=5397 started>
    │    └ None
    └ <Process name='Process-1' parent=5397 started>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
           │                │                            └ <Process name='Process-1' parent=5397 started>
           │                └ <function DefaultContext.get_context at 0x7f0d5114ca60>
           └ <multiprocessing.context.DefaultContext object at 0x7f0d5113bcd0>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
           │     └ <Process name='Process-1' parent=5397 started>
           └ <class 'multiprocessing.popen_fork.Popen'>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
    │    │       └ <Process name='Process-1' parent=5397 started>
    │    └ <function Popen._launch at 0x7f0d483398b0>
    └ <multiprocessing.popen_fork.Popen object at 0x7f0d483b7310>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 75, in _launch
    code = process_obj._bootstrap(parent_sentinel=child_r)
           │           │                          └ 9
           │           └ <function BaseProcess._bootstrap at 0x7f0d51141940>
           └ <Process name='Process-1' parent=5397 started>
  File "/usr/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7f0d5112af70>
    └ <Process name='Process-1' parent=5397 started>
> File "/usr/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Process name='Process-1' parent=5397 started>
    │    │        │    └ (RequestDataSet(id=44, text='lasik', xml='<?xml version="1.0" encoding="UTF-8" ?>\n<yandexsearch version="1.0">\n  <response ...
    │    │        └ <Process name='Process-1' parent=5397 started>
    │    └ <function Yandex at 0x7f0d4838fe50>
    └ <Process name='Process-1' parent=5397 started>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 281, in __init__
    self.add_result_to_database()
    │    └ <function Yandex.add_result_to_database at 0x7f0d4838c820>
    └ <__main__.Yandex object at 0x7f0d5113b670>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 381, in add_result_to_database
    pm.custom_request_to_database_without_return(
    │  └ <function custom_request_to_database_without_return at 0x7f0d4845c820>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "UPDATE concurent_site.main_request SET site_age_concurency = 89, site_stem_concurency = 95, site_volume_concurency = 97, sit...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f0d3d1ca6d0; closed: 0>

psycopg2.errors.UndefinedColumn: column "request_id" does not exist
LINE 1: ...backlinks = 0, average_unique_backlinks = 0 WHERE request_id...
                                                             ^

13:49:32 An error has been caught in function 'run', process 'Process-1' (5490), thread 'MainThread' (140082815452992):
Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2131, in <module>
    main()
    └ <function main at 0x7f67910c14c0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2122, in main
    globals = debugger.run(setup['file'], None, None, is_module)
              │        │   │                          └ False
              │        │   └ {'port': 43773, 'vm_type': None, 'client': '127.0.0.1', 'server': False, 'DEBUG_RECORD_SOCKET_READS': False, 'multiproc': Tru...
              │        └ <function PyDB.run at 0x7f67910c24c0>
              └ <__main__.PyDB object at 0x7f67918c5ee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1431, in run
    return self._exec(is_module, entry_point_fn, module_name, file, globals, locals)
           │    │     │          │               │            │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
           │    │     │          │               └ None
           │    │     │          └ ''
           │    │     └ False
           │    └ <function PyDB._exec at 0x7f67910c2550>
           └ <__main__.PyDB object at 0x7f67918c5ee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1438, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
    │             │        │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
    │             └ <function execfile at 0x7f6791f7c280>
    └ <module '_pydev_bundle.pydev_imports' from '/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/...

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
                 │              │              │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              │              └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
                 └ 'from microservices.conc_settings import *\nfrom multiprocessing import Process, Queue\nfrom threading import Thread\nfrom lo...

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 871, in <module>
    Manager()
    └ <function Manager at 0x7f6790f660d0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 52, in __init__
    self.run_processes()
    │    └ <function Manager.run_processes at 0x7f6788225ee0>
    └ <__main__.Manager object at 0x7f67882204f0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 89, in run_processes
    self.start_processes()
    │    └ <function Manager.start_processes at 0x7f67881b8040>
    └ <__main__.Manager object at 0x7f67882204f0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 97, in start_processes
    process.start()
    │       └ <function BaseProcess.start at 0x7f6790f7d040>
    └ <Process name='Process-1' parent=5484 started>

  File "/usr/lib/python3.8/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
    │    │        │    │      └ <Process name='Process-1' parent=5484 started>
    │    │        │    └ <staticmethod object at 0x7f6790f718e0>
    │    │        └ <Process name='Process-1' parent=5484 started>
    │    └ None
    └ <Process name='Process-1' parent=5484 started>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
           │                │                            └ <Process name='Process-1' parent=5484 started>
           │                └ <function DefaultContext.get_context at 0x7f6790f8aa60>
           └ <multiprocessing.context.DefaultContext object at 0x7f6790f77d30>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
           │     └ <Process name='Process-1' parent=5484 started>
           └ <class 'multiprocessing.popen_fork.Popen'>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
    │    │       └ <Process name='Process-1' parent=5484 started>
    │    └ <function Popen._launch at 0x7f67881e68b0>
    └ <multiprocessing.popen_fork.Popen object at 0x7f678816a0a0>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 75, in _launch
    code = process_obj._bootstrap(parent_sentinel=child_r)
           │           │                          └ 9
           │           └ <function BaseProcess._bootstrap at 0x7f6790f7d940>
           └ <Process name='Process-1' parent=5484 started>
  File "/usr/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7f6790f66f70>
    └ <Process name='Process-1' parent=5484 started>
> File "/usr/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Process name='Process-1' parent=5484 started>
    │    │        │    └ (RequestDataSet(id=44, text='lasik', xml='<?xml version="1.0" encoding="UTF-8" ?>\n<yandexsearch version="1.0">\n  <response ...
    │    │        └ <Process name='Process-1' parent=5484 started>
    │    └ <function Yandex at 0x7f67881b8e50>
    └ <Process name='Process-1' parent=5484 started>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 281, in __init__
    self.add_result_to_database()
    │    └ <function Yandex.add_result_to_database at 0x7f67881bb820>
    └ <__main__.Yandex object at 0x7f6790f77670>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 381, in add_result_to_database
    pm.custom_request_to_database_without_return(
    │  └ <function custom_request_to_database_without_return at 0x7f6790047820>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "UPDATE concurent_site.main_request SET site_age_concurency = 89, site_stem_concurency = 95, site_volume_concurency = 97, sit...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f6781aa3130; closed: 0>

psycopg2.errors.UndefinedColumn: column "site_age_concurency" of relation "main_request" does not exist
LINE 1: UPDATE concurent_site.main_request SET site_age_concurency =...
                                               ^

13:51:11 An error has been caught in function 'run', process 'Process-1' (5594), thread 'MainThread' (140371963127616):
Traceback (most recent call last):

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2131, in <module>
    main()
    └ <function main at 0x7faae397c4c0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 2122, in main
    globals = debugger.run(setup['file'], None, None, is_module)
              │        │   │                          └ False
              │        │   └ {'port': 46307, 'vm_type': None, 'client': '127.0.0.1', 'server': False, 'DEBUG_RECORD_SOCKET_READS': False, 'multiproc': Tru...
              │        └ <function PyDB.run at 0x7faae39794c0>
              └ <__main__.PyDB object at 0x7faae417cee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1431, in run
    return self._exec(is_module, entry_point_fn, module_name, file, globals, locals)
           │    │     │          │               │            │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
           │    │     │          │               │            └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
           │    │     │          │               └ None
           │    │     │          └ ''
           │    │     └ False
           │    └ <function PyDB._exec at 0x7faae3979550>
           └ <__main__.PyDB object at 0x7faae417cee0>

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/pydevd.py", line 1438, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
    │             │        │     │        └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
    │             │        └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
    │             └ <function execfile at 0x7faae4832280>
    └ <module '_pydev_bundle.pydev_imports' from '/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_bundle/...

  File "/home/wenfort/Загрузки/pycharm-2020.1/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
                 │              │              │     └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              │              └ {'__name__': '__main__', '__doc__': None, '__package__': None, '__loader__': <_frozen_importlib_external.SourceFileLoader obj...
                 │              └ '/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py'
                 └ 'from microservices.conc_settings import *\nfrom multiprocessing import Process, Queue\nfrom threading import Thread\nfrom lo...

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 871, in <module>
    Manager()
    └ <function Manager at 0x7faae38590d0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 52, in __init__
    self.run_processes()
    │    └ <function Manager.run_processes at 0x7faae00b9ee0>
    └ <__main__.Manager object at 0x7faae012eaf0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 89, in run_processes
    self.start_processes()
    │    └ <function Manager.start_processes at 0x7faae004f040>
    └ <__main__.Manager object at 0x7faae012eaf0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 97, in start_processes
    process.start()
    │       └ <function BaseProcess.start at 0x7faae386c040>
    └ <Process name='Process-1' parent=5585 started>

  File "/usr/lib/python3.8/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
    │    │        │    │      └ <Process name='Process-1' parent=5585 started>
    │    │        │    └ <staticmethod object at 0x7faae38638e0>
    │    │        └ <Process name='Process-1' parent=5585 started>
    │    └ None
    └ <Process name='Process-1' parent=5585 started>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
           │                │                            └ <Process name='Process-1' parent=5585 started>
           │                └ <function DefaultContext.get_context at 0x7faae387ba60>
           └ <multiprocessing.context.DefaultContext object at 0x7faae3869cd0>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
           │     └ <Process name='Process-1' parent=5585 started>
           └ <class 'multiprocessing.popen_fork.Popen'>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
    │    │       └ <Process name='Process-1' parent=5585 started>
    │    └ <function Popen._launch at 0x7faae007c8b0>
    └ <multiprocessing.popen_fork.Popen object at 0x7faae0073f40>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 75, in _launch
    code = process_obj._bootstrap(parent_sentinel=child_r)
           │           │                          └ 9
           │           └ <function BaseProcess._bootstrap at 0x7faae386c940>
           └ <Process name='Process-1' parent=5585 started>
  File "/usr/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7faae3859f70>
    └ <Process name='Process-1' parent=5585 started>
> File "/usr/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Process name='Process-1' parent=5585 started>
    │    │        │    └ (RequestDataSet(id=44, text='lasik', xml='<?xml version="1.0" encoding="UTF-8" ?>\n<yandexsearch version="1.0">\n  <response ...
    │    │        └ <Process name='Process-1' parent=5585 started>
    │    └ <function Yandex at 0x7faae004fe50>
    └ <Process name='Process-1' parent=5585 started>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 281, in __init__
    self.add_result_to_database()
    │    └ <function Yandex.add_result_to_database at 0x7faae0051820>
    └ <__main__.Yandex object at 0x7faae3869670>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 381, in add_result_to_database
    pm.custom_request_to_database_without_return(
    │  └ <function custom_request_to_database_without_return at 0x7faae0120820>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "UPDATE concurent_site.main_request SET age_concurency = 89, stem_concurency = 95, volume_concurency = 97, backlinks_concuren...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7faad08497c0; closed: 0>

psycopg2.errors.UndefinedColumn: column "request_views" of relation "main_request" does not exist
LINE 1: ...inks', direct_concurency = 4, seo_concurency = 0, request_vi...
                                                             ^

14:36:17 Проблема с валидностью контента wikichi.ru. 
14:36:17 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-2' (8495), thread 'Thread-22' (140158984767232):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 451, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f79a37a08b0>
    └ <__main__.Domain object at 0x7f79a27dafd0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 458, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f79a37a0a60>
    └ <__main__.Domain object at 0x7f79a27dafd0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 486, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('https://...
    │  └ <function custom_request_to_database_without_return at 0x7f79a37f8550>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('https://...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f796c727a90; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(https://monaliza18.ru) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f79a759a1f0>
    └ <Thread(Thread-22, started 140158984767232)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f79a7596ee0>
    └ <Thread(Thread-22, started 140158984767232)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-22, started 140158984767232)>
    │    │        │    └ (SiteDataSet(html=<query><url>monaliza18.ru</url><title>Глазная клиника "Мона Лиза". Лазерная коррекция зрения</title><snippe...
    │    │        └ <Thread(Thread-22, started 140158984767232)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f79a758cdf0>>
    └ <Thread(Thread-22, started 140158984767232)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 355, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<query><url>monaliza18.ru</url><title>Глазная клиника "Мона Лиза". Лазерная коррекция зрения</title><snippet...
    └ <function Site at 0x7f79a378de50>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 161, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f79a379b280>
    └ <__main__.Site object at 0x7f79a3024070>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 236, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<query><url>monaliza18.ru</url><title>Глазная клиника "Мона Лиза". Лазерная коррекция зрения</title><snippet...
    │      └ <__main__.Site object at 0x7f79a3024070>
    └ <function Domain at 0x7f79a37a0790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 453, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f79a6e6edc0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
14:36:17 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-2' (8495), thread 'Thread-6' (140160142403328):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 451, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f79a37a08b0>
    └ <__main__.Domain object at 0x7f79a3034fa0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 458, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f79a37a0a60>
    └ <__main__.Domain object at 0x7f79a3034fa0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 486, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('elitplus...
    │  └ <function custom_request_to_database_without_return at 0x7f79a37f8550>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('elitplus...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f7990457d60; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(elitplus-clinic.ru) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f79a759a1f0>
    └ <Thread(Thread-6, started 140160142403328)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f79a7596ee0>
    └ <Thread(Thread-6, started 140160142403328)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-6, started 140160142403328)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://elitplus-clinic.ru/stati/lazernaya-korrekcziya-zreniya-lasik.html</url><title>Лазерная ко...
    │    │        └ <Thread(Thread-6, started 140160142403328)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f79a758cdf0>>
    └ <Thread(Thread-6, started 140160142403328)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 355, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://elitplus-clinic.ru/stati/lazernaya-korrekcziya-zreniya-lasik.html</url><title>Лазерная кор...
    └ <function Site at 0x7f79a378de50>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 161, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f79a379b280>
    └ <__main__.Site object at 0x7f79a308a4f0>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 236, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://elitplus-clinic.ru/stati/lazernaya-korrekcziya-zreniya-lasik.html</url><title>Лазерная кор...
    │      └ <__main__.Site object at 0x7f79a308a4f0>
    └ <function Domain at 0x7f79a37a0790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 453, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f79a6e6edc0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
14:36:17 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-1' (8494), thread 'Thread-21' (140158993159936):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 451, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f79a37a08b0>
    └ <__main__.Domain object at 0x7f79a331a100>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 458, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f79a37a0a60>
    └ <__main__.Domain object at 0x7f79a331a100>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 486, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('mgkl.ru'...
    │  └ <function custom_request_to_database_without_return at 0x7f79a37f8550>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('mgkl.ru'...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f794c5277c0; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(mgkl.ru) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f79a759a1f0>
    └ <Thread(Thread-21, started 140158993159936)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f79a7596ee0>
    └ <Thread(Thread-21, started 140158993159936)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-21, started 140158993159936)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://mgkl.ru/patient/stati/kak-delayut-lazernuyu-korrektsiyu-zreniya</url><title>Как делают ла...
    │    │        └ <Thread(Thread-21, started 140158993159936)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f79a758cdf0>>
    └ <Thread(Thread-21, started 140158993159936)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 355, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://mgkl.ru/patient/stati/kak-delayut-lazernuyu-korrektsiyu-zreniya</url><title>Как делают лаз...
    └ <function Site at 0x7f79a378de50>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 161, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f79a379b280>
    └ <__main__.Site object at 0x7f79a30210a0>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 236, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://mgkl.ru/patient/stati/kak-delayut-lazernuyu-korrektsiyu-zreniya</url><title>Как делают лаз...
    │      └ <__main__.Site object at 0x7f79a30210a0>
    └ <function Domain at 0x7f79a37a0790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 453, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f79a6e6edc0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
14:36:17 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-2' (8495), thread 'Thread-1' (140160393328384):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 451, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f79a37a08b0>
    └ <__main__.Domain object at 0x7f79a30ecf10>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 458, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f79a37a0a60>
    └ <__main__.Domain object at 0x7f79a30ecf10>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 486, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('wikipedi...
    │  └ <function custom_request_to_database_without_return at 0x7f79a37f8550>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('wikipedi...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f79925398b0; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(wikipedia.org) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f79a759a1f0>
    └ <Thread(Thread-1, started 140160393328384)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f79a7596ee0>
    └ <Thread(Thread-1, started 140160393328384)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-1, started 140160393328384)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://ru.wikipedia.org/wiki/LASIK</url><title>LASIK — Википедия</title><passages><passage>LASIK...
    │    │        └ <Thread(Thread-1, started 140160393328384)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f79a758cdf0>>
    └ <Thread(Thread-1, started 140160393328384)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 355, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://ru.wikipedia.org/wiki/LASIK</url><title>LASIK — Википедия</title><passages><passage>LASIK ...
    └ <function Site at 0x7f79a378de50>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 161, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f79a379b280>
    └ <__main__.Site object at 0x7f79a30eceb0>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 236, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://ru.wikipedia.org/wiki/LASIK</url><title>LASIK — Википедия</title><passages><passage>LASIK ...
    │      └ <__main__.Site object at 0x7f79a30eceb0>
    └ <function Domain at 0x7f79a37a0790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 453, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f79a6e6edc0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
14:36:18 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-1' (8494), thread 'Thread-11' (140160100439808):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 451, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f79a37a08b0>
    └ <__main__.Domain object at 0x7f79a2fb23d0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 458, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f79a37a0a60>
    └ <__main__.Domain object at 0x7f79a2fb23d0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 486, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('excimerc...
    │  └ <function custom_request_to_database_without_return at 0x7f79a37f8550>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('excimerc...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f794c98a310; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(excimerclinic.ru) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f79a759a1f0>
    └ <Thread(Thread-11, started 140160100439808)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f79a7596ee0>
    └ <Thread(Thread-11, started 140160100439808)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-11, started 140160100439808)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://msk.excimerclinic.ru/laser-correction/</url><title>Лазерная коррекция зрения в Москве: це...
    │    │        └ <Thread(Thread-11, started 140160100439808)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f79a758cdf0>>
    └ <Thread(Thread-11, started 140160100439808)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 355, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://msk.excimerclinic.ru/laser-correction/</url><title>Лазерная коррекция зрения в Москве: цен...
    └ <function Site at 0x7f79a378de50>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 161, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f79a379b280>
    └ <__main__.Site object at 0x7f79a3058490>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 236, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://msk.excimerclinic.ru/laser-correction/</url><title>Лазерная коррекция зрения в Москве: цен...
    │      └ <__main__.Site object at 0x7f79a3058490>
    └ <function Domain at 0x7f79a37a0790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 453, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f79a6e6edc0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
14:36:18 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-2' (8495), thread 'Thread-3' (140160376542976):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 451, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f79a37a08b0>
    └ <__main__.Domain object at 0x7f79a308a2e0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 458, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f79a37a0a60>
    └ <__main__.Domain object at 0x7f79a308a2e0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 486, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('Korrekts...
    │  └ <function custom_request_to_database_without_return at 0x7f79a37f8550>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('Korrekts...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f796f5329a0; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(Korrektsiya-zreniya.ru) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f79a759a1f0>
    └ <Thread(Thread-3, started 140160376542976)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f79a7596ee0>
    └ <Thread(Thread-3, started 140160376542976)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-3, started 140160376542976)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://Korrektsiya-zreniya.ru/blog/lasik/</url><title>LASIK | Лазерная коррекция зрения методом ...
    │    │        └ <Thread(Thread-3, started 140160376542976)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f79a758cdf0>>
    └ <Thread(Thread-3, started 140160376542976)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 355, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://Korrektsiya-zreniya.ru/blog/lasik/</url><title>LASIK | Лазерная коррекция зрения методом Л...
    └ <function Site at 0x7f79a378de50>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 161, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f79a379b280>
    └ <__main__.Site object at 0x7f79a30f36d0>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 236, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://Korrektsiya-zreniya.ru/blog/lasik/</url><title>LASIK | Лазерная коррекция зрения методом Л...
    │      └ <__main__.Site object at 0x7f79a30f36d0>
    └ <function Domain at 0x7f79a37a0790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 453, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f79a6e6edc0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
14:36:18 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-2' (8495), thread 'Thread-2' (140160384935680):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 451, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f79a37a08b0>
    └ <__main__.Domain object at 0x7f79a27aafd0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 458, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f79a37a0a60>
    └ <__main__.Domain object at 0x7f79a27aafd0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 486, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('ochkov.n...
    │  └ <function custom_request_to_database_without_return at 0x7f79a37f8550>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('ochkov.n...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f796f4309a0; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(ochkov.net) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f79a759a1f0>
    └ <Thread(Thread-2, started 140160384935680)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f79a7596ee0>
    └ <Thread(Thread-2, started 140160384935680)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-2, started 140160384935680)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.ochkov.net/wiki/lazernaya-korrekciya-zreniya-kak-prohodit-operaciya-lasik.htm</url><t...
    │    │        └ <Thread(Thread-2, started 140160384935680)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f79a758cdf0>>
    └ <Thread(Thread-2, started 140160384935680)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 355, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.ochkov.net/wiki/lazernaya-korrekciya-zreniya-kak-prohodit-operaciya-lasik.htm</url><ti...
    └ <function Site at 0x7f79a378de50>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 161, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f79a379b280>
    └ <__main__.Site object at 0x7f79a30f3730>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 236, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://www.ochkov.net/wiki/lazernaya-korrekciya-zreniya-kak-prohodit-operaciya-lasik.htm</url><ti...
    │      └ <__main__.Site object at 0x7f79a30f3730>
    └ <function Domain at 0x7f79a37a0790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 453, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f79a6e6edc0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
14:36:19 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-1' (8494), thread 'Thread-12' (140159546816256):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 451, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f79a37a08b0>
    └ <__main__.Domain object at 0x7f79a2c1d310>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 458, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f79a37a0a60>
    └ <__main__.Domain object at 0x7f79a2c1d310>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 486, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('cvz.ru',...
    │  └ <function custom_request_to_database_without_return at 0x7f79a37f8550>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('cvz.ru',...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f794c4b65e0; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(cvz.ru) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f79a759a1f0>
    └ <Thread(Thread-12, started 140159546816256)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f79a7596ee0>
    └ <Thread(Thread-12, started 140159546816256)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-12, started 140159546816256)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://www.cvz.ru/articles/laser-correction/kak-prokhodit/</url><title>Лазерная коррекция зрения...
    │    │        └ <Thread(Thread-12, started 140159546816256)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f79a758cdf0>>
    └ <Thread(Thread-12, started 140159546816256)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 355, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://www.cvz.ru/articles/laser-correction/kak-prokhodit/</url><title>Лазерная коррекция зрения ...
    └ <function Site at 0x7f79a378de50>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 161, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f79a379b280>
    └ <__main__.Site object at 0x7f79a3058b80>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 236, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://www.cvz.ru/articles/laser-correction/kak-prokhodit/</url><title>Лазерная коррекция зрения ...
    │      └ <__main__.Site object at 0x7f79a3058b80>
    └ <function Domain at 0x7f79a37a0790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 453, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f79a6e6edc0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
14:36:19 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-1' (8494), thread 'Thread-10' (140160108832512):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 451, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f79a37a08b0>
    └ <__main__.Domain object at 0x7f79a2e1abb0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 458, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f79a37a0a60>
    └ <__main__.Domain object at 0x7f79a2e1abb0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 486, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('fedorovm...
    │  └ <function custom_request_to_database_without_return at 0x7f79a37f8550>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('fedorovm...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f794c4b66d0; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(fedorovmedcenter.ru) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f79a759a1f0>
    └ <Thread(Thread-10, started 140160108832512)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f79a7596ee0>
    └ <Thread(Thread-10, started 140160108832512)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-10, started 140160108832512)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://fedorovmedcenter.ru/stati/oft-lazernaya-korrektsiya-zreniya/operatsiya-lazernoy-korrektsi...
    │    │        └ <Thread(Thread-10, started 140160108832512)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f79a758cdf0>>
    └ <Thread(Thread-10, started 140160108832512)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 355, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://fedorovmedcenter.ru/stati/oft-lazernaya-korrektsiya-zreniya/operatsiya-lazernoy-korrektsii...
    └ <function Site at 0x7f79a378de50>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 161, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f79a379b280>
    └ <__main__.Site object at 0x7f79a304d940>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 236, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://fedorovmedcenter.ru/stati/oft-lazernaya-korrektsiya-zreniya/operatsiya-lazernoy-korrektsii...
    │      └ <__main__.Site object at 0x7f79a304d940>
    └ <function Domain at 0x7f79a37a0790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 453, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f79a6e6edc0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
14:36:19 An error has been caught in function 'add_domain_data_to_dataset', process 'Process-1' (8494), thread 'Thread-4' (140160368150272):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 451, in __init__
    self.get_domain_data()
    │    └ <function Domain.get_domain_data at 0x7f79a37a08b0>
    └ <__main__.Domain object at 0x7f79a3255280>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 458, in get_domain_data
    self.add_domain_backlinks_to_database()
    │    └ <function Domain.add_domain_backlinks_to_database at 0x7f79a37a0a60>
    └ <__main__.Domain object at 0x7f79a3255280>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 486, in add_domain_backlinks_to_database
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('smileeye...
    │  └ <function custom_request_to_database_without_return at 0x7f79a37f8550>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "INSERT INTO concurent_site.main_domain(name, age, unique_backlinks, total_backlinks, status, domain_group) VALUES ('smileeye...
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7f79a15e28b0; closed: 0>

psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "main_domain_pkey"
DETAIL:  Key (name)=(smileeyes.ru) already exists.



During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f79a759a1f0>
    └ <Thread(Thread-4, started 140160368150272)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f79a7596ee0>
    └ <Thread(Thread-4, started 140160368150272)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4, started 140160368150272)>
    │    │        │    └ (SiteDataSet(html=<doc><url>https://smileeyes.ru/stati/kak-prohodit-lazernaya-korrektsiya-zreniya/</url><title>Лазерная корре...
    │    │        └ <Thread(Thread-4, started 140160368150272)>
    │    └ <bound method Yandex.make_site_object of <__main__.Yandex object at 0x7f79a758cdf0>>
    └ <Thread(Thread-4, started 140160368150272)>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 355, in make_site_object
    Site(site_dataset)
    │    └ SiteDataSet(html=<doc><url>https://smileeyes.ru/stati/kak-prohodit-lazernaya-korrektsiya-zreniya/</url><title>Лазерная коррек...
    └ <function Site at 0x7f79a378de50>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 161, in __init__
    self.add_domain_data_to_dataset()
    │    └ <function Site.add_domain_data_to_dataset at 0x7f79a379b280>
    └ <__main__.Site object at 0x7f79a30a52e0>

> File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 236, in add_domain_data_to_dataset
    Domain(self.site_dataset)
    │      │    └ SiteDataSet(html=<doc><url>https://smileeyes.ru/stati/kak-prohodit-lazernaya-korrektsiya-zreniya/</url><title>Лазерная коррек...
    │      └ <__main__.Site object at 0x7f79a30a52e0>
    └ <function Domain at 0x7f79a37a0790>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 453, in __init__
    logger.critical(f'Проблемы с доменом {self.domain}')
    │      └ <function Logger.critical at 0x7f79a6e6edc0>
    └ <loguru.logger handlers=[(id=0, level=10, sink=<stderr>), (id=1, level=50, sink='critical.txt'), (id=2, level=25, sink='impor...

AttributeError: 'Domain' object has no attribute 'domain'
14:59:55 An error has been caught in function 'run', process 'Process-3' (10935), thread 'MainThread' (140499808159552):
Traceback (most recent call last):

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 881, in <module>
    Manager()
    └ <function Manager at 0x7fc8a89c65e0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 52, in __init__
    self.run_processes()
    │    └ <function Manager.run_processes at 0x7fc8a4bc1700>
    └ <__main__.Manager object at 0x7fc8a4c3d460>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 86, in run_processes
    self.start_processes()
    │    └ <function Manager.start_processes at 0x7fc8a4bc1820>
    └ <__main__.Manager object at 0x7fc8a4c3d460>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 94, in start_processes
    process.start()
    │       └ <function BaseProcess.start at 0x7fc8a89ea700>
    └ <Process name='Process-3' parent=10306 started>

  File "/usr/lib/python3.8/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
    │    │        │    │      └ <Process name='Process-3' parent=10306 started>
    │    │        │    └ <staticmethod object at 0x7fc8a8b297c0>
    │    │        └ <Process name='Process-3' parent=10306 started>
    │    └ None
    └ <Process name='Process-3' parent=10306 started>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
           │                │                            └ <Process name='Process-3' parent=10306 started>
           │                └ <function DefaultContext.get_context at 0x7fc8a897c1f0>
           └ <multiprocessing.context.DefaultContext object at 0x7fc8a89e9a30>
  File "/usr/lib/python3.8/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
           │     └ <Process name='Process-3' parent=10306 started>
           └ <class 'multiprocessing.popen_fork.Popen'>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
    │    │       └ <Process name='Process-3' parent=10306 started>
    │    └ <function Popen._launch at 0x7fc8a4b830d0>
    └ <multiprocessing.popen_fork.Popen object at 0x7fc8a4b7beb0>
  File "/usr/lib/python3.8/multiprocessing/popen_fork.py", line 75, in _launch
    code = process_obj._bootstrap(parent_sentinel=child_r)
           │           │                          └ 7
           │           └ <function BaseProcess._bootstrap at 0x7fc8a89ec040>
           └ <Process name='Process-3' parent=10306 started>
  File "/usr/lib/python3.8/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7fc8a89ea670>
    └ <Process name='Process-3' parent=10306 started>
> File "/usr/lib/python3.8/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Process name='Process-3' parent=10306 started>
    │    │        │    └ (RequestDataSet(id=51, text='коррекция зрения', xml='<?xml version="1.0" encoding="UTF-8" ?>\n<yandexsearch version="1.0">\n ...
    │    │        └ <Process name='Process-3' parent=10306 started>
    │    └ <function Yandex at 0x7fc8a4bd05e0>
    └ <Process name='Process-3' parent=10306 started>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 266, in __init__
    self.change_request_status_in_queue()
    │    └ <function Yandex.change_request_status_in_queue at 0x7fc8a4bd0700>
    └ <__main__.Yandex object at 0x7fc8a89bfdf0>

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/new_requests_handler.py", line 285, in change_request_status_in_queue
    pm.custom_request_to_database_without_return(sql)
    │  │                                         └ "UPDATE concurent_site.main_handledxml SET status = 'confirmation' WHERE request_id = 51;"
    │  └ <function custom_request_to_database_without_return at 0x7fc8a4c2c550>
    └ <module 'microservices.postgres_mode' from '/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode....

  File "/home/wenfort/PycharmProjects/concurent_site_release/microservices/postgres_mode.py", line 94, in custom_request_to_database_without_return
    cursor.execute(sql)
    │      │       └ "UPDATE concurent_site.main_handledxml SET status = 'confirmation' WHERE request_id = 51;"
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x7fc8605b5a90; closed: 0>

psycopg2.errors.StringDataRightTruncation: value too long for type character varying(10)

17:01:47 Проблема с валидностью контента yandex.by. 
17:13:58 Проблема с валидностью контента wikichi.ru. 
